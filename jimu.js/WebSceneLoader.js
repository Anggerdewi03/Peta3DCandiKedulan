// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/Deferred dojo/_base/lang dojo/_base/array dojo/_base/html dojo/promise/all esri/kernel esri/WebScene esri/views/SceneView esri/portal/Portal esri/portal/PortalItem esri/core/has ./utils ./portalUtils ./portalUrlUtils".split(" "),function(l,e,n,m,p,q,r,t,u,v,z,w,x,y){return{createMap:function(a,b,c){var d=new l;this._isWebGLAvailable()?d=this._createMap(a,b,c):(d.reject("The browser doesn't support webgl."),(a=e.getObject("webSceneLoader.webglSupportTip",!1,window.jimuNls))||(a="3D web apps aren't supported in your browser."),
m.create("div",{"class":"app-error",innerHTML:a},document.body));return d},_createMap:function(a,b,c){w.getEsriConfig().portalUrl=y.getStandardPortalUrl(b);var d=new l,h=[];u._default=null;var k=new r({portalItem:new v({id:c})}),f=new t({map:k,container:a,constraints:{collision:{enabled:!1},tilt:{max:179.99}}});h.push(f.when());b=x.getPortal(b);h.push(b.getItemById(c));h.push(b.getItemData(c));p(h).then(e.hitch(this,function(g){f.popup&&(f.popup.closeOnViewChangeEnabled=!0);k.id=a;k.itemId=c;k.itemInfo=
{item:g[1],itemData:g[2]};this._handleLocalScene(f);d.resolve(f)}),e.hitch(this,function(g){console.error(g);d.reject(g)}));return d},_handleLocalScene:function(a){try{a.viewingMode&&"local"===a.viewingMode.toLowerCase()&&(e.setObject("constraints.collision.enabled",!1,a),e.setObject("constraints.tilt.max",179.99,a))}catch(b){console.error(b)}},_handleAttribution:function(a){try{if("4.0"!==q.version){var b=a.ui&&a.ui._components;b&&0<b.length&&n.some(b,function(c){return(c=c&&c._widget)&&"esri.widgets.Attribution"===
c.declaredClass?(c.domNode.parentNode.style.width="100%",m.create("span",{innerHTML:"Powered by Esri","class":"esri-attribution-powered-by"},c.domNode),!0):!1})}}catch(c){console.error(c)}},_isWebGLAvailable:function(){try{var a=document.createElement("canvas");return!(!window.WebGLRenderingContext||!a.getContext("webgl")&&!a.getContext("experimental-webgl"))}catch(b){return!1}},_isWebGL2Available:function(){try{var a=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!a.getContext("webgl2"))}catch(b){return!1}}}});