// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(G,r,A,x,m){return A("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var f=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);m.parse(f,{noStart:!this._earlyTemplatedStartup,
template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(x.hitch(this,function(z){this._startupWidgets=z;for(var n=0;n<z.length;n++)this._processTemplateNode(z[n],function(k,F){return k[F]},function(k,F,K){return F in k?k.connect(k,F,K):k.on(F,K,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");
}},_processTemplateNode:function(f,z,n){return z(f,"dojoType")||z(f,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){G.forEach(this._startupWidgets,function(f){f&&!f._started&&f.startup&&f.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(G,
r,A,x,m,f,z,n,k,F,K,N,L,Q,R,T){function O(g){return eval("("+g+")")}function U(g){var h=g._nameCaseMap,t=g.prototype;if(!h||h._extendCnt<M){h=g._nameCaseMap={};for(var u in t)"_"!==u.charAt(0)&&(h[u.toLowerCase()]=u);h._extendCnt=M}return h}function P(g,h){h||(h=G);var t=h._dojoParserCtorMap||(h._dojoParserCtorMap={}),u=g.join();if(!t[u]){for(var q=[],p=0,B=g.length;p<B;p++){var D=g[p];q[q.length]=t[D]=t[D]||A.getObject(D)||~D.indexOf("/")&&h(D)}g=q.shift();t[u]=q.length?g.createSubclass?g.createSubclass(q):
g.extend.apply(g,q):g}return t[u]}new Date("X");var M=0;k.after(A,"extend",function(){M++},!0);L={_clearCache:function(){M++;_ctorMap={}},_functionFromScript:function(g,h){var t="",u="",q=g.getAttribute(h+"args")||g.getAttribute("args");h=g.getAttribute("with");q=(q||"").split(/\s*,\s*/);h&&h.length&&x.forEach(h.split(/\s*,\s*/),function(p){t+="with("+p+"){";u+="}"});return new Function(q,t+g.innerHTML+u)},instantiate:function(g,h,t){h=h||{};t=t||{};var u=(t.scope||r._scopeName)+"Type",q="data-"+
(t.scope||r._scopeName)+"-",p=q+"type",B=q+"mixins",D=[];x.forEach(g,function(a){var b=u in h?h[u]:a.getAttribute(p)||a.getAttribute(u);if(b){var c=a.getAttribute(B);b=c?[b].concat(c.split(/\s*,\s*/)):[b];D.push({node:a,types:b})}});return this._instantiate(D,h,t)},_instantiate:function(g,h,t,u){function q(p){h._started||t.noStart||x.forEach(p,function(B){"function"!==typeof B.startup||B._started||B.startup()});return p}g=x.map(g,function(p){var B=p.ctor||P(p.types,t.contextRequire);if(!B)throw Error("Unable to resolve constructor for: '"+
p.types.join()+"'");return this.construct(B,p.node,h,t,p.scripts,p.inherited)},this);return u?F(g).then(q):q(g)},construct:function(g,h,t,u,q,p){function B(J){v&&A.setObject(v,J);for(e=0;e<y.length;e++)k[y[e].advice||"after"](J,y[e].method,A.hitch(J,y[e].func),!0);for(e=0;e<H.length;e++)H[e].call(J);for(e=0;e<I.length;e++)J.watch(I[e].prop,I[e].func);for(e=0;e<S.length;e++)R(J,S[e].event,S[e].func);return J}var D=g&&g.prototype;u=u||{};var a={};u.defaults&&A.mixin(a,u.defaults);p&&A.mixin(a,p);var b=
h.attributes;var c=u.scope||r._scopeName;p="data-"+c+"-";var d={};"dojo"!==c&&(d[p+"props"]="data-dojo-props",d[p+"type"]="data-dojo-type",d[p+"mixins"]="data-dojo-mixins",d[c+"type"]="dojotype",d[p+"id"]="data-dojo-id");var e=0,l;c=[];for(var v,C;l=b[e++];){var E=l.name,w=E.toLowerCase();l=l.value;switch(d[w]||w){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":C=l;break;case "data-dojo-id":case "jsid":v=l;break;case "data-dojo-attach-point":case "dojoattachpoint":a.dojoAttachPoint=
l;break;case "data-dojo-attach-event":case "dojoattachevent":a.dojoAttachEvent=l;break;case "class":a["class"]=h.className;break;case "style":a.style=h.style&&h.style.cssText;break;default:if(E in D||(E=U(g)[w]||E),E in D)switch(typeof D[E]){case "string":a[E]=l;break;case "number":a[E]=l.length?Number(l):NaN;break;case "boolean":a[E]="false"!=l.toLowerCase();break;case "function":""===l||-1!=l.search(/[^\w\.]+/i)?a[E]=new Function(l):a[E]=A.getObject(l,!1)||new Function(l);c.push(E);break;default:w=
D[E],a[E]=w&&"length"in w?l?l.split(/\s*,\s*/):[]:w instanceof Date?""==l?new Date(""):"now"==l?new Date:K.fromISOString(l):w instanceof n?r.baseUrl+l:O(l)}else a[E]=l}}for(b=0;b<c.length;b++)d=c[b].toLowerCase(),h.removeAttribute(d),h[d]=null;if(C)try{C=O.call(u.propsThis,"{"+C+"}"),A.mixin(a,C)}catch(J){throw Error(J.toString()+" in data-dojo-props\x3d'"+C+"'");}A.mixin(a,t);q||(q=g&&(g._noScript||D._noScript)?[]:Q("\x3e script[type^\x3d'dojo/']",h));var y=[],H=[],I=[],S=[];if(q)for(e=0;e<q.length;e++)d=
q[e],h.removeChild(d),t=d.getAttribute(p+"event")||d.getAttribute("event"),u=d.getAttribute(p+"prop"),C=d.getAttribute(p+"method"),c=d.getAttribute(p+"advice"),b=d.getAttribute("type"),d=this._functionFromScript(d,p),t?"dojo/connect"==b?y.push({method:t,func:d}):"dojo/on"==b?S.push({event:t,func:d}):a[t]=d:"dojo/aspect"==b?y.push({method:C,advice:c,func:d}):"dojo/watch"==b?I.push({prop:u,func:d}):H.push(d);g=(q=g.markupFactory||D.markupFactory)?q(a,h,g):new g(a,h);return g.then?g.then(B):B(g)},scan:function(g,
h){function t(w){if(!w.inherited){w.inherited={};var y=w.node,H=t(w.parent);y={dir:y.getAttribute("dir")||H.dir,lang:y.getAttribute("lang")||H.lang,textDir:y.getAttribute(b)||H.textDir};for(var I in y)y[I]&&(w.inherited[I]=y[I])}return w.inherited}var u=[],q=[],p={},B=(h.scope||r._scopeName)+"Type",D="data-"+(h.scope||r._scopeName)+"-",a=D+"type",b=D+"textdir";D+="mixins";var c=g.firstChild,d=h.inherited;if(!d){d=function I(y,H){return y.getAttribute&&y.getAttribute(H)||y.parentNode&&I(y.parentNode,
H)};d={dir:d(g,"dir"),lang:d(g,"lang"),textDir:d(g,b)};for(var e in d)d[e]||delete d[e]}e={inherited:d};for(var l,v;;)if(c)if(1!=c.nodeType)c=c.nextSibling;else if(l&&"script"==c.nodeName.toLowerCase())(d=c.getAttribute("type"))&&/^dojo\/\w/i.test(d)&&l.push(c),c=c.nextSibling;else if(v)c=c.nextSibling;else if(d=c.getAttribute(a)||c.getAttribute(B),g=c.firstChild,d||g&&(3!=g.nodeType||g.nextSibling)){v=null;if(d){var C=c.getAttribute(D);l=C?[d].concat(C.split(/\s*,\s*/)):[d];try{v=P(l,h.contextRequire)}catch(w){}v||
x.forEach(l,function(w){~w.indexOf("/")&&!p[w]&&(p[w]=!0,q[q.length]=w)});C=v&&!v.prototype._noScript?[]:null;e={types:l,ctor:v,parent:e,node:c,scripts:C};e.inherited=t(e);u.push(e)}else e={node:c,scripts:l,parent:e};l=C;v=c.stopParser||v&&v.prototype.stopParser&&!h.template;c=g}else c=c.nextSibling;else{if(!e||!e.node)break;c=e.node.nextSibling;v=!1;e=e.parent;l=e.scripts}var E=new N;q.length?(h.contextRequire||G)(q,function(){E.resolve(x.filter(u,function(w){if(!w.ctor)try{w.ctor=P(w.types,h.contextRequire)}catch(I){}for(var y=
w.parent;y&&!y.types;)y=y.parent;var H=w.ctor&&w.ctor.prototype;w.instantiateChildren=!(H&&H.stopParser&&!h.template);w.instantiate=!y||y.instantiate&&y.instantiateChildren;return w.instantiate}))}):E.resolve(u);return E.promise},_require:function(g,h){g=O("{"+g.innerHTML+"}");var t=[],u=[],q=new N;h=h&&h.contextRequire||G;for(var p in g)t.push(p),u.push(g[p]);h(u,function(){for(var B=0;B<t.length;B++)A.setObject(t[B],arguments[B]);q.resolve(arguments)});return q.promise},_scanAmd:function(g,h){var t=
new N,u=t.promise;t.resolve(!0);var q=this;Q("script[type\x3d'dojo/require']",g).forEach(function(p){u=u.then(function(){return q._require(p,h)});p.parentNode.removeChild(p)});return u},parse:function(g,h){!g||"string"==typeof g||"nodeType"in g||(h=g,g=h.rootNode);var t=g?f.byId(g):z.body();h=h||{};var u=h.template?{template:!0}:{},q=[],p=this;g=this._scanAmd(t,h).then(function(){return p.scan(t,h)}).then(function(B){return p._instantiate(B,u,h,!0)}).then(function(B){return q=q.concat(B)}).otherwise(function(B){console.error("dojo/parser::parse() error",
B);throw B;});A.mixin(q,g);return q}};r.parser=L;m.parseOnLoad&&T(100,L,"parse");return L})},"dojo/_base/url":function(){define(["./kernel"],function(G){var r=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,A=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,x=function(){for(var m=arguments,f=[m[0]],z=1;z<m.length;z++)if(m[z]){var n=new x(m[z]+"");f=new x(f[0]+"");if(""==n.path&&!n.scheme&&!n.authority&&!n.query)null!=n.fragment&&(f.fragment=n.fragment),n=f;else if(!n.scheme&&
(n.scheme=f.scheme,!n.authority&&(n.authority=f.authority,"/"!=n.path.charAt(0)))){f=(f.path.substring(0,f.path.lastIndexOf("/")+1)+n.path).split("/");for(var k=0;k<f.length;k++)"."==f[k]?k==f.length-1?f[k]="":(f.splice(k,1),k--):0<k&&(1!=k||""!=f[0])&&".."==f[k]&&".."!=f[k-1]&&(k==f.length-1?(f.splice(k,1),f[k-1]=""):(f.splice(k-1,2),k-=2));n.path=f.join("/")}f=[];n.scheme&&f.push(n.scheme,":");n.authority&&f.push("//",n.authority);f.push(n.path);n.query&&f.push("?",n.query);n.fragment&&f.push("#",
n.fragment)}this.uri=f.join("");m=this.uri.match(r);this.scheme=m[2]||(m[1]?"":null);this.authority=m[4]||(m[3]?"":null);this.path=m[5];this.query=m[7]||(m[6]?"":null);this.fragment=m[9]||(m[8]?"":null);null!=this.authority&&(m=this.authority.match(A),this.user=m[3]||null,this.password=m[4]||null,this.host=m[6]||m[7],this.port=m[9]||null)};x.prototype.toString=function(){return this.uri};return G._Url=x})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(G,r){var A=
{};G.setObject("dojo.date.stamp",A);A.fromISOString=function(x,m){A._isoRegExp||(A._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var f=A._isoRegExp.exec(x);x=null;if(f){f.shift();f[1]&&f[1]--;f[6]&&(f[6]*=1E3);m&&(m=new Date(m),r.forEach(r.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(k){return m["get"+k]()}),function(k,F){f[F]=f[F]||k}));x=new Date(f[0]||1970,f[1]||0,f[2]||1,f[3]||0,f[4]||
0,f[5]||0,f[6]||0);100>f[0]&&x.setFullYear(f[0]||1970);var z=0,n=f[7]&&f[7].charAt(0);"Z"!=n&&(z=60*(f[8]||0)+(Number(f[9])||0),"-"!=n&&(z*=-1));n&&(z-=x.getTimezoneOffset());z&&x.setTime(x.getTime()+6E4*z)}return x};A.toISOString=function(x,m){var f=function(F){return 10>F?"0"+F:F};m=m||{};var z=[],n=m.zulu?"getUTC":"get",k="";"time"!=m.selector&&(k=x[n+"FullYear"](),k=["0000".substr((k+"").length)+k,f(x[n+"Month"]()+1),f(x[n+"Date"]())].join("-"));z.push(k);"date"!=m.selector&&(k=[f(x[n+"Hours"]()),
f(x[n+"Minutes"]()),f(x[n+"Seconds"]())].join(":"),n=x[n+"Milliseconds"](),m.milliseconds&&(k+="."+(100>n?"0":"")+f(n)),m.zulu?k+="Z":"time"!=m.selector&&(x=x.getTimezoneOffset(),m=Math.abs(x),k+=(0<x?"-":"+")+f(Math.floor(m/60))+":"+f(m%60)),z.push(k));return z.join("T")};return A})},"dojo/throttle":function(){define([],function(){return function(G,r){var A=!0;return function(){A&&(A=!1,G.apply(this,arguments),setTimeout(function(){A=!0},r))}}})},"widgets/Coordinate/_build-generate_module":function(){define(["dojo/text!./Widget.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Coordinate/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"coordinateBackground"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"coordinateMenuContainer" style\x3d"display:none"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"coordinateMenu"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"coordinateInfoMenu" class\x3d"coordinate-background coordinate-info-menu jimu-float-leading jimu-align-leading"\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading coordinate-locate-container" data-dojo-attach-point\x3d"locateContainer"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"locateButton" class\x3d"coordinate-locate jimu-float-leading"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"coordinateInfo" class\x3d"coordinate-info jimu-float-leading jimu-align-leading"\x3e\r\n        ${nls.loading}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"elevInfo" class\x3d"coordinate-info jimu-float-leading jimu-align-leading"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"eyeInfo" class\x3d"coordinate-info jimu-float-leading jimu-align-leading"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-float-trailing coordinate-foldable-container" data-dojo-attach-point\x3d"foldContainer"\x3e\r\n      \x3cdiv class\x3d"coordinate-foldable jimu-float-trailing" data-dojo-attach-point\x3d"foldableNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Coordinate/css/style.css":".jimu-widget-coordinate .coordinate-background{line-height: 17px; overflow: hidden; font-size: 10px; color: #fff; background-color: rgb(0,0,0); background-color: rgba(0,0,0,0.5);}.jimu-widget-coordinate .display-coordinate-menu{display: block !important; border-bottom: 1px solid rgba(255,255,255,0.4);}.jimu-widget-coordinate .coordinate-locate{width: 17px; height: 17px; background: url(images/locate.png) center no-repeat;}.jimu-widget-coordinate .coordinate-locate-container{width: 18px; height: 17px; border-right: 1px solid rgba(255,255,255,0.4);}.jimu-widget-coordinate .coordinate-locate-container:hover .coordinate-locate{background: url(images/locate-hover.png) center no-repeat !important; cursor: pointer;}.jimu-widget-coordinate .coordinate-locate-container-active .coordinate-locate{background: url(images/locate-active.png) center no-repeat !important; cursor: pointer;}.jimu-widget-coordinate .coordinate-info{margin: 0 4px; font-size: 11px !important; color: #fff !important; max-height: 17px;}.jimu-widget-coordinate .coordinate-info-menu-empty .coordinate-info{margin: 0;}.jimu-widget-coordinate .coordinate-info-menu-empty .coordinate-locate-container {border-style: none !important;}.jimu-widget-coordinate .coordinate-foldable-container {border-left: 1px solid rgba(255,255,255,0.4); height: 17px;}.jimu-widget-coordinate .coordinate-foldable{background: url(images/more.png) center no-repeat; cursor: pointer; width: 17px; height: 15px; margin: 1px 0;}.jimu-widget-coordinate:hover .coordinate-foldable{background-image: url(images/more-hover.png);}.jimu-rtl .jimu-widget-coordinate .coordinate-locate-container{border-right-style: none; border-left: 1px solid rgba(255,255,255,0.4);}.jimu-rtl .jimu-widget-coordinate .coordinate-locate-container:hover .coordinate-locate,.jimu-rtl .jimu-widget-coordinate .coordinate-locate-container-active .coordinate-locate{background-position: right center;}.jimu-rtl .jimu-widget-coordinate .coordinate-foldable-container{border-left-style: none; border-right: 1px solid rgba(255,255,255,0.4);}.claro .jimu-widget-coordinate .dijitMenuTable {background: transparent; border-style: none; width: 100%;}.claro .jimu-widget-coordinate .dijitMenuItem {color: #fff;}.claro .jimu-widget-coordinate .dijitMenu .dijitMenuItem td{border-style: none; text-align: left; padding: 4px 2px; font-size: 10px;}.claro .jimu-widget-coordinate .dijitMenu .dijitMenuItem.selected-item{font-weight: bold; background: #000;}.jimu-rtl .claro .jimu-widget-coordinate .dijitMenu .dijitMenuItem td{text-align: right;}.claro .jimu-widget-coordinate .dijitMenu .dijitMenuItemHover td,.claro .jimu-widget-coordinate .dijitMenu .dijitMenuItemHover {color: #fff; background: #000; border-style: none;}.claro .jimu-widget-coordinate .dijitMenu .dijitMenuItemActive,.claro .jimu-widget-coordinate .dijitMenu .dijitMenuItemActive td,.claro .jimu-widget-coordinate .dijitMenu .dijitMenuItemSelected,.claro .jimu-widget-coordinate .dijitMenu .dijitMenuItemSelected td{background: #000; color: #fff;}",
"*now":function(G){G(['dojo/i18n!*preload*widgets/Coordinate/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/html dijit/_WidgetsInTemplateMixin esri/geometry/Point esri/geometry/SpatialReference jimu/BaseWidget jimu/utils jimu/dijit/Message dojo/_base/lang dojo/on dojo/dom-class dijit/DropDownMenu dijit/MenuItem dojo/aspect dojo/Deferred esri/request esri/Graphic esri/layers/GraphicsLayer esri/rest/support/ProjectParameters esri/geometry/support/webMercatorUtils esri/symbols/PictureMarkerSymbol jimu/portalUtils esri/config libs/usng/usng jimu/SpatialReference/unitUtils dojo/throttle".split(" "),function(G,
r,A,x,m,f,z,n,k,F,K,N,L,Q,R,T,O,U,P,M,g,h,t,u,q,p){var B={INCHES:"Inches",FOOT:"Foot",FEET:"Foot",YARDS:"Yards",MILES:"Miles",NAUTICAL_MILES:"Nautical_Miles",MILLIMETERS:"Millimeters",CENTIMETERS:"Centimeters",METER:"Meter",METERS:"Meter",KILOMETERS:"Kilometers",DECIMETERS:"Decimeters",DEGREE:"Decimal_Degrees",DECIMAL_DEGREES:"Decimal_Degrees",DEGREE_MINUTE_SECONDS:"Degree_Minutes_Seconds",MGRS:"MGRS",USNG:"USNG"},D={esriCentimeters:"CENTIMETERS",esriDecimalDegrees:"DECIMAL_DEGREES",esriDegreeMinuteSeconds:"DEGREE_MINUTE_SECONDS",
esriDecimeters:"DECIMETERS",esriFeet:"FOOT",esriInches:"INCHES",esriKilometers:"KILOMETERS",esriMeters:"METER",esriMiles:"MILES",esriMillimeters:"MILLIMETERS",esriNauticalMiles:"NAUTICAL_MILES",esriPoints:"POINTS",esriUnknownUnits:"UNKNOWN",esriYards:"YARDS"};return G([f,A],{baseClass:"jimu-widget-coordinate",name:"Coordinate",_cache:{_container:null,_mouseX:null,_mouseY:null},postMixInProperties:function(){this.nls.enableClick=this.nls.enableClick||"Click to enable clicking map to get coordinates";
this.nls.disableClick=this.nls.disableClick||"Click to disable clicking map to get coordinates"},postCreate:function(){this.inherited(arguments);this._cache._container=this.sceneView.container;K.add(this.coordinateBackground,"coordinate-background");this.own(F(this.sceneView,"click",k.hitch(this,this.onMapClick)));this.own(F(this.locateButton,"click",k.hitch(this,this.onLocateButtonClick)));this.own(F(this.foldContainer,"click",k.hitch(this,this.onFoldContainerClick)));this.graphicsLayer=new U;this.graphicsLayer.listMode=
"hide";this.sceneView.map.add(this.graphicsLayer);this.own(this.sceneView.watch("viewpoint",p(k.hitch(this,this.onWatchViewpoint),50)));this.own(F(this._cache._container,"mousemove",p(k.hitch(this,this.onMouseMove),100)))},startup:function(){this.inherited(arguments);this.config.spatialReferences&&1<this.config.spatialReferences.length?r.setStyle(this.foldableNode,"display","inline-block"):r.setStyle(this.foldableNode,"display","none")},onOpen:function(){this.sceneView.when(k.hitch(this,function(){try{this.sceneView.spatialReference&&
(this.sceneView.spatialReference.isWebMercator?this._mapWkid=3857:this.sceneView.spatialReference.wkid&&(this._mapWkid=this.sceneView.spatialReference.wkid)),this.selectedWkid=this._mapWkid}catch(a){console.error(a)}this._processData().then(k.hitch(this,function(a){this.domNode&&(this.initPopMenu(a),1>=this.popMenu.getChildren().length&&r.setStyle(this.foldContainer,"display","none"))}),k.hitch(this,function(a){console.error(a)}))}),k.hitch(this,function(a){console.error(a)}))},_processData:function(){var a=
new R,b=this.sceneView.map.itemInfo.itemData.baseMap.baseMapLayers[0];this.config.spatialReferences&&this.config.spatialReferences.length?(this._configured=!0,a.resolve(this.config.spatialReferences)):h.getUnits(this.appConfig.portalUrl).then(k.hitch(this,function(c){b||(b=this.sceneView.map.layers.items[0]);var d=b&&("BingMapsRoad"===b.layerType||"BingMapsHybrid"===b.layerType||"BingMapsAerial"===b.layerType),e=b&&"WebTiledLayer"===b.layerType,l=b&&"VectorTileLayer"===b.layerType;b&&b.url?T(b.url,
{responseType:"json",callbackParamName:"callback",query:{f:"json"}}).then(k.hitch(this,function(v){this._processMapUnits(v).then(k.hitch(this,function(C){var E=this._getUnconfiguredUnitOptions(C.data.units,c),w=C.data.spatialReference,y=C.data.fullExtent;w={wkid:w&&(w.latestWkid||w.wkid)||y&&y.spatialReference&&y.spatialReference.wkid,label:"",outputUnit:E.outputUnit};w.options={sameSRWithMap:!0,defaultUnit:D[C.data.units]||C.data.units,isGeographicUnit:E.isGeographicUnit,isGeographicCS:E.isGeographicCS,
isProjectUnit:E.isProjectUnit,isProjectedCS:E.isProjectedCS,unitRate:E.unitRate};this._configured=!1;a.resolve(w)}))}),k.hitch(this,function(v){console.error(v);a.reject(v)})):b&&("OpenStreetMap"===b.layerType||d||e||l)?(d=this._getUnconfiguredUnitOptions("esriMeters",c),e={wkid:3857,label:"",outputUnit:d.outputUnit},e.options={sameSRWithMap:!0,defaultUnit:D.esriMeters,isGeographicUnit:d.isGeographicUnit,isGeographicCS:d.isGeographicCS,isProjectUnit:d.isProjectUnit,isProjectedCS:d.isProjectedCS,unitRate:d.unitRate},
this._configured=!1,a.resolve(e)):a.reject(Error("no baseMap"))}));return a},_processMapUnits:function(a){var b=new R;if(a.data.units)b.resolve(a);else{var c=a.spatialReference||k.exists("tileInfo.spatialReference",a)&&a.tileInfo.spatialReference,d=a.extent||a.initialExtent||a.fullExtent,e=c&&(c.latestWkid||c.wkid)||d&&d.spatialReference&&d.spatialReference.wkid,l=this;require(["jimu/SpatialReference/srUtils"],function(v){v.loadResource().then(k.hitch(l,function(){var C=v.getCSUnit(e);a.data={};a.data.units=
C;b.resolve(a)}))})}return b},_getUnconfiguredUnitOptions:function(a,b){a=D[a]||a;var c="",d=1,e="",l="",v="",C="";q.isProjectUnit(a)?(v=C=!0,e=l=!1,c="english"===b?D.esriFeet.toUpperCase():D.esriMeters.toUpperCase(),d=q.getUnitRate(a.toUpperCase(),c)):q.isGeographicUnit(a)&&(v=C=!1,e=l=!0,c=a.toUpperCase());this.sceneView.spatialReference.isWebMercator&&(c=D.esriDecimalDegrees,l=!0,C=!1,d=1);return{outputUnit:c,unitRate:d,isGeographicUnit:l,isGeographicCS:e,isProjectUnit:C,isProjectedCS:v}},initPopMenu:function(a){this.popMenu=
new N({},this.coordinateMenu);Q.after(this.popMenu,"onItemClick",k.hitch(this,this.onClickMenu),!0);"[object Array]"!==Object.prototype.toString.call(a)?(this.selectedWkid=parseInt(a.wkid,10),this.addMenuItem("",this.selectedWkid,a.outputUnit,a.elevationUnit,a.eyeAltUnit,null,null,a.options),this.selectedItem=this.popMenu.getChildren()[0]):(this.selectedWkid=parseInt(a[0].wkid,10),this.selectedTfWkid=a[0].transformationWkid&&parseInt(a[0].transformationWkid,10),this._addAllMenuItems(),this.selectedItem=
this.popMenu.getChildren()[0],this.selectedItem.set({label:this.getStatusString(!0,this.selectedItem.params.name,this.selectedItem.params.wkid)}),r.addClass(this.selectedItem.domNode,"selected-item"));this._adjustCoordinateInfoUI(this.selectedWkid);this.popMenu.startup()},_addAllMenuItems:function(){for(var a=this.config.spatialReferences.length,b=0;b<a;b++)this.addMenuItem(this.config.spatialReferences[b].label,this.config.spatialReferences[b].wkid,this.config.spatialReferences[b].outputUnit,this.config.spatialReferences[b].elevationUnit,
this.config.spatialReferences[b].eyeAltUnit,this.config.spatialReferences[b].transformationWkid,this.config.spatialReferences[b].transformForward,this.config.spatialReferences[b].options)},_isWebMercator:function(a){return m.prototype._isWebMercator?m.prototype._isWebMercator.apply({wkid:parseInt(a,10)},[]):(new m(parseInt(a,10))).isWebMercator},canShowInClient:function(a){a=4326===this._mapWkid&&this._isWebMercator(a)||this._isWebMercator(this._mapWkid)&&4326===parseInt(a,10);var b=this.selectedItem.get("options");
return b&&b.sameSRWithMap||a?!0:!1},onClickMenu:function(a){this._setElevInfo();r.removeClass(this.selectedItem.domNode,"selected-item");this.selectedItem.set({label:this.getStatusString(!1,this.selectedItem.params.name,this.selectedItem.params.wkid)});this.selectedWkid=parseInt(a.params.wkid,10);this.selectedTfWkid=a.params.tfWkid;this.forward=a.params.forward;a.set({label:this.getStatusString(!0,a.params.name,a.params.wkid)});r.addClass(a.domNode,"selected-item");this.selectedItem=a;this._adjustCoordinateInfoUI(this.selectedWkid);
this.toggleMenuContainer(!1)},_adjustCoordinateInfoUI:function(a){r.removeClass(this.coordinateInfoMenu,"coordinate-info-menu-empty");this._markerGraphic&&this.graphicsLayer.remove(this._markerGraphic);this._markerGraphic=null;this.canShowInClient(a)?(this.enableRealtime=!0,this._getDefaultPlaceHolder()):(this.enableRealtime=!1,this._clearCoordinateInfo(),r.addClass(this.coordinateInfoMenu,"coordinate-info-menu-empty"));r.setAttr(this.locateButton,"title",this.nls.enableClick);r.removeClass(this.locateContainer,
"coordinate-locate-container-active");this.enableWebMapPopup();this.onExtentChange({extent:this.sceneView.map.extent})},disableWebMapPopup:function(){},enableWebMapPopup:function(){},onLocateButtonClick:function(){if(this.isMenuContainerOpen())this.onFoldContainerClick();r.removeClass(this.coordinateInfoMenu,"coordinate-info-menu-empty");r.toggleClass(this.locateContainer,"coordinate-locate-container-active");this._markerGraphic&&this.graphicsLayer.remove(this._markerGraphic);this._markerGraphic=
null;this.canShowInClient(this.selectedWkid)?this.enableRealtime?(this.enableRealtime=!1,this._setCoordinateInnerHTML(this.nls.hintMessage),r.setAttr(this.locateButton,"title",this.nls.disableClick),this.disableWebMapPopup()):(this.enableRealtime=!0,this._getDefaultPlaceHolder(),r.setAttr(this.locateButton,"title",this.nls.enableClick),this.enableWebMapPopup()):r.hasClass(this.locateContainer,"coordinate-locate-container-active")?(this._setCoordinateInnerHTML(this.nls.hintMessage),this.disableWebMapPopup(),
r.setAttr(this.locateButton,"title",this.nls.disableClick)):(this._clearCoordinateInfo(),r.addClass(this.coordinateInfoMenu,"coordinate-info-menu-empty"),this.enableWebMapPopup(),r.setAttr(this.locateButton,"title",this.nls.enableClick))},onDeActive:function(){if(r.hasClass(this.locateContainer,"coordinate-locate-container-active"))this.onLocateButtonClick();if(this.isMenuContainerOpen())this.onFoldContainerClick()},getStatusString:function(a,b,c){var d="",e=this._mapWkid;c=parseInt(c,10);d=a?"\x3cb\x3e"+
d+b+"\x3c/b\x3e\x26nbsp;"+this._rtlTheBrackets(c)+"\x26nbsp;":d+b+"\x26nbsp;\x26nbsp;"+this._rtlTheBrackets(c)+"\x26nbsp;";c===e&&(d+=this.nls.defaultLabel);return d},_rtlTheBrackets:function(a){return window.isRTL?"\x26rlm;("+a+")":"("+a+")"},_getEyeInfoUnitRate:function(a){return q.getUnitRate("METER","english"===a?"FOOT":"METER")},addMenuItem:function(a,b,c,d,e,l,v,C){a={label:this.getStatusString(!1,a,b)||"",name:a||"",wkid:b||"",outputUnit:c||"",tfWkid:l||"",options:C,elevationUnitRate:this._getEyeInfoUnitRate(d),
eyeAltUnitRate:this._getEyeInfoUnitRate(e)};a.tfWkid&&(a.forward=v);this.popMenu.addChild(new L(a))},_toFormat:function(a){return z.localizeNumberByFieldInfo(a,{format:{places:this.config.latLonDecimalPlaces,digitSeparator:this.config.addSeparator}})},onProjectComplete:function(a,b){if(this.selectedWkid&&a===this.selectedWkid&&this.domNode){b=b[0];a=b.x;b=b.y;var c=this.selectedItem.get("outputUnit"),d=this.selectedItem.get("options");!0===isNaN(a)&&!0===isNaN(b)?this._clearCoordinateInfo():"MGRS"===
c||"USNG"===c?this._displayUsngOrMgrs(c,b,a):d.isGeographicUnit?this._displayDegOrDms(c,b,a):this._displayProject(c,b,a)}},_unitToNls:function(a){var b=B[a.toUpperCase()];return this.nls[b]||this.nls[a]||a},onProjectError:function(a){new n({message:a.message||a.toString()});this._setCoordinateInnerHTML(this.nls.hintMessage);this._setElevInfo()},onExtentChange:function(){this.selectedItem&&(r.setStyle(this.locateContainer,"display","block"),1<this.popMenu.getChildren().length?r.setStyle(this.foldContainer,
"display","block"):r.setStyle(this.foldContainer,"display","none"))},_getMarkerGraphic:function(a){var b=new g(this.folderUrl+"css/images/esriGreenPin16x26.png",16,26);b.setXoffset=0;b.setYoffset=12;return new O(a,b)},onMapClick:function(a){if(!this.enableRealtime&&this.selectedItem){if(this.canShowInClient(this.selectedWkid)||r.hasClass(this.locateContainer,"coordinate-locate-container-active"))this._markerGraphic&&this.graphicsLayer.remove(this._markerGraphic),this._markerGraphic=this._getMarkerGraphic(a.mapPoint),
this.graphicsLayer.add(this._markerGraphic);this.canShowInClient(this.selectedWkid)?this._setCoordinateInfo():r.hasClass(this.locateContainer,"coordinate-locate-container-active")&&a.mapPoint&&a.mapPoint.x&&a.mapPoint.y&&(this._setCoordinateInfo(!0),a=new x(a.mapPoint.x,a.mapPoint.y,this.sceneView.spatialReference),this._projectMapPoint(a))}},_projectMapPoint:function(a){var b=new P,c=null,d=this.selectedItem.get("options");b.geometries=[a];d.isProjectedCS?c=d.isProjectUnit?this.selectedWkid:d.spheroidCS:
d.isGeographicCS&&(c=this.selectedWkid);this.selectedTfWkid&&(b.transformation=new m(parseInt(this.selectedTfWkid,10)),b.transformForward=JSON.parse(this.forward));b.outSpatialReference=new m(parseInt(c,10));this._setCoordinateInnerHTML(this.nls.computing);t.geometryService.project(b).then(k.hitch(this,this.onProjectComplete,this.selectedWkid),k.hitch(this,this.onProjectError))},_displayOnClient:function(a){var b=this.selectedItem.get("outputUnit"),c=a.x,d=a.y,e=null,l=4326===this._mapWkid&&this._isWebMercator(this.selectedWkid)||
this._isWebMercator(this._mapWkid)&&4326===this.selectedWkid,v=this.selectedItem.get("options");e=a.normalize();v.isGeographicUnit&&(c=e.longitude||c);v.isGeographicUnit&&(d=e.latitude||d);l?4326===a.spatialReference.wkid&&this._isWebMercator(this.selectedWkid)?"MGRS"===b||"USNG"===b?this._displayUsngOrMgrs(b,e.latitude,e.longitude):v.isGeographicUnit?this._displayDegOrDms(b,d,c):v.isProjectUnit&&(a=M.lngLatToXY(c,d),this._displayProject(b,a[1],a[0])):a.spatialReference.isWebMercator&&4326===this.selectedWkid&&
("MGRS"===b||"USNG"===b?this._displayUsngOrMgrs(b,e.latitude,e.longitude):v.isGeographicUnit&&this._displayDegOrDms(b,d,c)):v.defaultUnit===b?(this._displayCoordinatesByOrder(this._toFormat(c),this._toFormat(d)),this._setCoordinateInnerHTML(this.coordinateInfo.innerHTML+=" "+this._unitToNls(b))):4326===a.spatialReference.wkid||a.spatialReference.isWebMercator?"MGRS"===b||"USNG"===b?this._displayUsngOrMgrs(b,e.latitude,e.longitude):v.isGeographicUnit?this._displayDegOrDms(b,d,c):v.isProjectedCS&&this._displayProject(b,
d,c):v.isProjectedCS?this._displayProject(b,d,c):v.isGeographicCS&&("MGRS"===b||"USNG"===b?this._displayUsngOrMgrs(b,d,c):v.isGeographicUnit&&this._displayDegOrDms(b,d,c))},destroy:function(){this._markerGraphic&&this.graphicsLayer.remove(this._markerGraphic);this.graphicsLayer&&this.sceneView.map.remove(this.graphicsLayer);this.inherited(arguments)},_displayUsngOrMgrs:function(a,b,c){"MGRS"===a?this._setCoordinateInnerHTML(u.LLtoMGRS(b,c,5)):"USNG"===a&&this._setCoordinateInnerHTML(u.LLtoUSNG(b,
c,5));this._setCoordinateInnerHTML(this.coordinateInfo.innerHTML+=" "+this._unitToNls(a))},_displayDegOrDms:function(a,b,c){var d="",e="";d=this.selectedItem.get("options");c*=d.unitRate;b*=d.unitRate;"DEGREE_MINUTE_SECONDS"===a?(d=this.degToDMS(b,"LAT"),e=this.degToDMS(c,"LON"),this._displayCoordinatesByOrder(d,e)):(this._displayCoordinatesByOrder(this._toFormat(c),this._toFormat(b)),this._setCoordinateInnerHTML(this.coordinateInfo.innerHTML+=" "+this._unitToNls(a)))},_displayProject:function(a,
b,c){var d=this.selectedItem.get("options");c*=d.unitRate;b*=d.unitRate;this._displayCoordinatesByOrder(this._toFormat(c),this._toFormat(b));this._setCoordinateInnerHTML(this.coordinateInfo.innerHTML+=" "+this._unitToNls(a))},_clearCoordinateInfo:function(){this.coordinateInfo.innerHTML=""},_displayCoordinatesByOrder:function(a,b){this.config.displayOrderLonLat?this._setCoordinateInnerHTML(a+"  "+b):this._setCoordinateInnerHTML(b+"  "+a)},onFoldContainerClick:function(){this._configured&&this.toggleMenuContainer()},
isMenuContainerOpen:function(){return r.hasClass(this.coordinateMenuContainer,"display-coordinate-menu")},toggleMenuContainer:function(a){a||(a=this.isMenuContainerOpen(),a=!a);!0===a?r.addClass(this.coordinateMenuContainer,"display-coordinate-menu"):!1===a&&r.removeClass(this.coordinateMenuContainer,"display-coordinate-menu")},onWatchViewpoint:function(){this.onMouseMove({x:this._cache._mouseX,y:this._cache._mouseY})},onMouseMove:function(a){a.pageX&&a.pageY&&(this._cache._mouseX=a.pageX,this._cache._mouseY=
a.pageY);this._setEyeInfo();this.enableRealtime&&this.selectedItem&&this._setCoordinateInfo()},_setCoordinateInfo:function(a){this._cache._mouseX&&this._cache._mouseY&&this.sceneView.hitTest({x:this._cache._mouseX,y:this._cache._mouseY}).then(k.hitch(this,function(b){a||this._setLonLat(b);this._setElev(b)}))},_setLonLat:function(a){"undefined"!==typeof a&&a.ground&&null!==a.ground.mapPoint&&(null!==a.ground.mapPoint.latitude&&null!==a.ground.mapPoint.longitude||null!==a.ground.mapPoint.x&&null!==
a.ground.mapPoint.y)?this._displayOnClient(a.ground.mapPoint):this._clearCoordinateInfo()},_setElev:function(a){a.results&&a.results[0]&&a.results[0].mapPoint&&a.results[0].mapPoint.z?this._setElevInfo(a.results[0].mapPoint):"undefined"!==typeof a&&a.ground&&null!==a.ground.mapPoint&&"undefined"!==typeof a.ground.mapPoint.z?this._setElevInfo(a.ground.mapPoint):this._setElevInfo()},_getElev:function(a){var b="";a&&a.z&&(b=" "+this.nls.ELEV+" "+this._trunNumToKmOrM(a.z,!0));return b},_setElevInfo:function(a){var b=
"";a&&(b=this._getElev(a),b+=" ");this.elevInfo.innerHTML=z.sanitizeHTML(b)},_setEyeInfo:function(){if(this.sceneView.camera&&this.sceneView.camera.position){var a=this.sceneView.camera.position.z;a=this._trunNumToKmOrM(a);this.eyeInfo.innerHTML=z.sanitizeHTML(this.nls.EYE_ALT+" "+a)}},_trunNumToKmOrM:function(a,b){var c="";c=1;var d=1E3;a=parseFloat(a);b&&(d=1E4);this.selectedItem&&this.selectedItem.get&&(c=b?this.selectedItem.get("elevationUnitRate"):this.selectedItem.get("eyeAltUnitRate"));1===
parseInt(c,10)?a>=d||a<=-d?(a/=1E3,c=this._unitToNls("KILOMETERS")):c=this._unitToNls("METERS"):(a*=c,c=this._unitToNls("FOOT"));return(a=z.localizeNumberByFieldInfo(a,{format:{places:this.config.eyeDecimalPlaces,digitSeparator:this.config.addSeparator}}))?a+" "+c:""},degToDMS:function(a,b){var c=Math.abs(a),d=Math.floor(c);c-=d;var e=Math.floor(60*c);c=Math.floor(3600*(c-e/60));60===c&&(e++,c=0);60===e&&(d++,e=0);return d+"\x26deg;"+(10>e?"0"+e:e)+"\x26prime;"+(10>c?"0"+c:c)+"\x26Prime;"+("LAT"===
b?0>a?"S":"N":0>a?"W":"E")},_getDefaultPlaceHolder:function(){z.isMobileUa()?this.coordinateInfo.innerHTML="":this.coordinateInfo.innerHTML=this.nls.realtimeLabel},_setCoordinateInnerHTML:function(a){var b=this.coordinateInfo;b&&(b.innerHTML=z.sanitizeHTML(a))}})});