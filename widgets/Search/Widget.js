// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Search":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/events ../core/Handles ../core/reactiveUtils ../core/string ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Search/SearchResultRenderer ./Search/SearchViewModel ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g,r,w,E,K,L,m,F,f,z){const B=/<[a-z/][\s\S]*>/i;a=function(O){function I(e,y){var l=O.call(this,e,y)||this;l._activeMenuItemIndex=-1;l._handles=new k;l._inputNode=null;l._menuItemCount=0;l._sourceMenuButtonNode=null;l._sourceListNode=null;l._suggestionListNode=null;l._searchResultRenderer=new E;l._locateFailed=null;l._container=null;l.activeMenu="none";l.activeSource=null;l.activeSourceIndex=null;l.allPlaceholder=null;l.allSources=null;l.autoNavigate=null;l.autoSelect=
null;l.defaultSources=null;l.disabled=!1;l.goToOverride=null;l.iconClass="esri-icon-search";l.includeDefaultSources=null;l.label=void 0;l.locationEnabled=null;l.maxResults=null;l.maxSuggestions=null;l.messages=null;l.messagesCommon=null;l.minSuggestCharacters=null;l.popupEnabled=null;l.popupTemplate=null;l.portal=null;l.resultGraphic=null;l.resultGraphicEnabled=null;l.results=null;l.searchAllEnabled=null;l.searchTerm=null;l.selectedResult=null;l.sources=null;l.suggestions=null;l.suggestionsEnabled=
null;l.view=null;l.viewModel=new K;l._clearActiveMenu=()=>{l.activeMenu="none"};l._removeActiveMenu=M=>{var aa;(M=M.relatedTarget)&&null!=(aa=l._container)&&aa.contains(M)||l._clearActiveMenu()};l.own([S.watch(()=>l.searchTerm,M=>{(M&&"warning"===l.activeMenu||!M&&!l.get("viewModel.selectedSuggestion.location"))&&l._clearActiveMenu()}),S.on(()=>{var M;return null==(M=l.viewModel)?void 0:M.allSources},"change",()=>l._watchSourceChanges()),S.watch(()=>l.activeMenu,()=>l._resetActiveMenuItemIndex(),
S.initial),S.watch(()=>{var M;return null==(M=l.viewModel)?void 0:M.defaultPopupTemplate},M=>{M&&(M.content=l._renderSearchResultsContent.bind(d._assertThisInitialized(l)))},S.initial)]);return l}d._inheritsLoose(I,O);var G=I.prototype;G.destroy=function(){this._handles.destroy();this._handles=null;this._cancelSuggest();this._cancelSearch();this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)};G.clear=function(){};
G.focus=function(){var e;null==(e=this._inputNode)?void 0:e.focus();this.emit("search-focus")};G.blur=function(){var e;null==(e=this._inputNode)?void 0:e.blur();this.emit("search-blur")};G.search=function(e){this._clearActiveMenu();this._cancelSuggest();this._cancelSearch();const y=new AbortController,{signal:l}=y;this._searchController=y;return this.viewModel.search(e,{signal:l}).catch(M=>{if(this._searchController===y)return this._clearActiveMenu(),this._searchController=null,M}).then(M=>{if(this._searchController===
y)return this.activeMenu=M.numResults?"none":"warning",this._searchController=null,M})};G.suggest=function(e){this._cancelSuggest();const y=new AbortController,{signal:l}=y;this._suggestController=y;return this.viewModel.suggest(e,null,{signal:l}).then(M=>{if(this._suggestController===y)return this._suggestController=null,M.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),M}).catch(()=>{if(this._suggestController===y)return this._suggestController=null})};G.render=function(){const {state:e}=
this.viewModel;return f.tsx("div",{class:this.classes("esri-search esri-widget",{["esri-disabled"]:"disabled"===e,["esri-widget--disabled"]:this.disabled})},"loading"===e?this.renderLoader():this.renderContainer())};G.renderSubmitButton=function(){const {messages:e,disabled:y}=this;return f.tsx("button",{"aria-label":e.searchButtonTitle,bind:this,disabled:y,class:this.classes("esri-search__submit-button","esri-widget--button"),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,
title:e.searchButtonTitle,type:"button"},f.tsx("span",{"aria-hidden":"true",class:"esri-icon-search"}))};G.renderWarningMenu=function(){return f.tsx("div",{key:"esri-search__error-menu",class:this.classes("esri-menu","esri-search__warning-menu")},f.tsx("div",{class:"esri-search__warning-body"},this.renderWarning()))};G.renderSourceMenuButton=function(){const {messages:e,activeMenu:y,sourceMenuId:l,sourceMenuButtonId:M,disabled:aa}=this,{activeSourceIndex:A,allSources:Q}=this.viewModel;return 1<Q.length?
f.tsx("button",{id:M,key:"esri-search__source-menu-button",bind:this,disabled:aa,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":("source"===y).toString(),"aria-controls":l,class:this.classes("esri-search__sources-button","esri-widget--button"),onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,afterCreate:L.storeNode,"data-node-ref":"_sourceMenuButtonNode",type:"button"},f.tsx("span",{"aria-hidden":"true",class:"esri-icon-down-arrow esri-search__sources-button--down"}),
f.tsx("span",{"aria-hidden":"true",class:"esri-icon-up-arrow esri-search__sources-button--up"}),f.tsx("span",{class:"esri-search__source-name"},this._getSourceName(A))):null};G.renderSourcesList=function(){const {allSources:e,searchAllEnabled:y}=this.viewModel,{_activeMenuItemIndex:l,activeMenu:M,sourceMenuId:aa,sourceMenuButtonId:A}=this,Q="source"===M&&-1<l?this._buildId("source-item",l):null;return 1<e.length?f.tsx("ul",{"aria-activedescendant":Q,"aria-labelledby":A,id:aa,role:"menu",bind:this,
afterCreate:L.storeNode,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:"esri-menu__list",tabIndex:-1},y?this.renderSource(K.ALL_INDEX):null,e.map((T,U)=>this.renderSource(U)).toArray()):null};G.renderSourcesMenu=function(){const {allSources:e}=this.viewModel;return 1<e.length?f.tsx("div",{key:"esri-search__source-menu",class:this.classes("esri-menu","esri-search__sources-menu")},this.renderSourcesList()):null};G.renderLoader=function(){const {messages:e,
messagesCommon:y,disabled:l}=this;return f.tsx("div",{class:"esri-widget__loader",key:"base-loader",tabIndex:l?-1:null},f.tsx("span",{"aria-hidden":"true",class:"esri-widget__loader-animation"}),f.tsx("span",{class:"esri-icon-font-fallback-text"},e.searchButtonTitle),f.tsx("span",{class:"esri-widget__loader-text"},y.loading))};G.renderContainer=function(){const {allSources:e,state:y}=this.viewModel,{activeMenu:l}=this;return f.tsx("div",{tabIndex:-1,afterCreate:M=>{this._container=M;M.addEventListener("focusout",
this._removeActiveMenu)},afterRemoved:M=>{M.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes({["esri-search--multiple-sources"]:1<e.length,["esri-search--loading"]:"loading"===y,["esri-search--searching"]:"searching"===y,["esri-search--warning"]:"warning"===l,["esri-search--sources"]:"source"===l,["esri-search--show-suggestions"]:"suggestion"===l},"esri-search__container"),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),
this.renderSubmitButton(),this.renderWarningMenu())};G.renderClearButton=function(){return this.searchTerm?f.tsx("button",{bind:this,disabled:this.disabled,class:this.classes("esri-search__clear-button","esri-widget--button"),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},f.tsx("span",{"aria-hidden":"true",class:"esri-icon-close"})):null};G.renderLocationGroup=function(){const {messages:e,locationEnabled:y,
displayedSearchTerm:l}=this,M="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return y&&!l?f.tsx("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes("esri-menu__list","esri-search__suggestions-list","esri-search__suggestions-list--current-location")},f.tsx("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),
role:"option",class:this.classes("esri-menu__list-item",M?"esri-menu__list-item--focus":null)},f.tsx("span",{"aria-hidden":"true",class:"esri-icon-locate-circled"})," ",e.useCurrentLocation)):null};G.renderInput=function(){const {activeMenu:e,locationEnabled:y,displayedSearchTerm:l,messages:M,suggestionsMenuId:aa,inputId:A,_activeMenuItemIndex:Q,disabled:T}=this,{maxInputLength:U,placeholder:v,searchTerm:h,suggestionCount:C}=this.viewModel,W=!!(y&&!l||C),Z="suggestion"===e&&-1<Q?this._buildId("suggestion-item",
Q):null;return f.tsx("input",{"aria-activedescendant":Z,"aria-autocomplete":"list","aria-expanded":(W&&"suggestion"===e).toString(),"aria-controls":W?aa:null,"aria-haspopup":"listbox","aria-label":M.searchButtonTitle,bind:this,disabled:T,placeholder:v,maxlength:U,autocomplete:"off",type:"text",class:this.classes("esri-input","esri-search__input"),value:h,id:A,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,
afterCreate:L.storeNode,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:h?"":v})};G.renderForm=function(){return f.tsx("form",{key:"esri-search__form",bind:this,disabled:this.disabled,class:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this.renderInput())};G.renderSuggestList=function(e){const {sourceIndex:y}=e,l=e.results;return e.results.length?f.tsx("ul",{role:"group",key:`esri-search__suggestion-list-${y}`,class:this.classes("esri-menu__list","esri-search__suggestions-list")},
l.map(M=>this.renderSuggestion(M,this._menuItemCount++))):null};G.renderSuggestionsGroup=function(){const {suggestions:e}=this.viewModel;return e?e.map(y=>[this.renderSuggestionHeader(y),this.renderSuggestList(y)]):null};G.renderSuggestionsMenu=function(){const {displayedSearchTerm:e,locationEnabled:y,suggestionsMenuId:l,inputId:M}=this,{suggestionCount:aa}=this.viewModel;this._menuItemCount=0;return y&&!e||aa?f.tsx("div",{id:l,key:"esri-search__suggestions-menu",class:this.classes("esri-menu","esri-search__suggestions-menu"),
role:"listbox","aria-labelledby":M,bind:this,afterCreate:L.storeNode,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null};G.renderInputContainer=function(){return f.tsx("div",{key:"esri-search__input-container",class:"esri-search__input-container"},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())};G.renderSuggestionHeader=function(e){const {allSources:y,activeSourceIndex:l}=this.viewModel,{sourceIndex:M}=e,aa=1<y.length&&l===
K.ALL_INDEX;return e.results.length&&aa?f.tsx("div",{key:`esri-search__suggestion-header-${M}`,class:"esri-menu__header"},this._getSourceName(M)):null};G.renderSuggestion=function(e,y){const {_activeMenuItemIndex:l,messages:M}=this;var {searchTerm:aa}=this.viewModel;if(aa){var {text:A}=e;A=A||M.untitledResult;const Q=[];if(B.test(A))Q.push(f.tsx("div",{innerHTML:A}));else{A=this._splitResult(A,aa);const T=aa.toLowerCase();A.forEach((U,v)=>{U&&U.length&&(U.toLowerCase()===T?Q.push(f.tsx("strong",{key:v},
U)):Q.push(U))})}aa="suggestion"===this.activeMenu&&l===y;return f.tsx("li",{bind:this,id:this._buildId("suggestion-item",y),"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===y).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${y}`,"data-suggestion":e,role:"option",class:this.classes("esri-menu__list-item",aa?"esri-menu__list-item--focus":null)},Q)}};G.renderSource=function(e){const {activeSourceIndex:y,searchAllEnabled:l}=this.viewModel,M={["esri-menu__list-item--active"]:e===
y,["esri-menu__list-item--focus"]:"source"===this.activeMenu&&e===(l?this._activeMenuItemIndex-1:this._activeMenuItemIndex)};return f.tsx("li",{bind:this,key:`esri-search__source-${e}`,id:this._buildId("source-item",l?e+1:e),"aria-checked":(e===y).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes("esri-search__source","esri-menu__list-item",M)},this._getSourceName(e))};G.renderNoResultsWarning=function(e){const {messages:y}=this;e=e?z.substitute(y.noResultsFoundForValue,
{value:`"${e}"`}):y.noResultsFound;return f.tsx("div",{key:"esri-search__no_results"},f.tsx("div",{class:"esri-search__warning-header"},y.noResults),f.tsx("div",{class:"esri-search__warning-text"},e))};G.renderEmptySearchWarning=function(){const {messages:e}=this;return f.tsx("div",{key:"esri-search__empty-search"},f.tsx("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),f.tsx("span",{class:"esri-search__no-value-text"},e.emptyValue))};G.renderLocateWarning=function(){const {messages:e}=
this;return f.tsx("div",{key:"esri-search__locate-error"},f.tsx("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),f.tsx("span",{class:"esri-search__no-value-text"},e.locateError))};G.renderWarning=function(){var e;const {displayedSearchTerm:y,_locateFailed:l}=this,{viewModel:M}=this;return l?this.renderLocateWarning():null!=(e=M.selectedSuggestion)&&e.location||y?this.renderNoResultsWarning(y):this.renderEmptySearchWarning()};G._resetActiveMenuItemIndex=function(){this._activeMenuItemIndex=
-1};G._buildId=function(e,y){return`${this.id}-${e}${void 0===y?"":`-${y}`}`};G._watchSourceChanges=function(){const {_handles:e,viewModel:{allSources:y}}=this;e.remove("sources");y.forEach(l=>e.add(S.watch(()=>l.name,()=>this.scheduleRender()),"sources"))};G._handleSourcesMenuToggleFocus=function(){"source"!==this.activeMenu&&this._clearActiveMenu()};G._handleSourcesMenuToggleClick=function(){this.activeMenu="source"===this.activeMenu?"none":"source";this.renderNow();if("source"===this.activeMenu){var e;
null==(e=this._sourceListNode)?void 0:e.focus()}};G._handleClearButtonClick=function(){this.viewModel.clear();this._focus()};G._handleSearchButtonClick=function(){this.search()};G._handleSuggestionClick=function(e){if(e=e.currentTarget["data-suggestion"])this._focus(),this.search(e)};G._handleUseCurrentLocationClick=function(){this._useCurrentLocation()};G._useCurrentLocation=function(){this._focus("none");this._cancelSuggest();this._cancelSearch();const e=new AbortController,{signal:y}=e;this._searchController=
e;this.viewModel.searchNearby({signal:y}).then(l=>{this.activeMenu=l.numResults?"none":"warning"}).catch(()=>{this._locateFailed=!0;this.activeMenu="warning"}).then(()=>{this._searchController=null})};G._handleSourceClick=function(e){this._setSourceFromMenuItem(e.currentTarget)};G._setSourceFromMenuItem=function(e){var y;e&&(this.viewModel.activeSourceIndex=e["data-source-index"],this._clearActiveMenu(),null==(y=this._sourceMenuButtonNode)?void 0:y.focus())};G._cancelSuggest=function(){this._suggestController&&
(this._suggestController.abort(),this._suggestController=null)};G._cancelSearch=function(){this._searchController&&(this._searchController.abort(),this._searchController=null);this._locateFailed=!1};G._handleInputKeyup=function(e){var y,l=t.eventKey(e);if(!e.ctrlKey&&!e.metaKey&&"Copy"!==l&&"ArrowLeft"!==l&&"ArrowRight"!==l&&"Shift"!==l)if("Tab"===l||"Escape"===l||e.shiftKey&&"Tab"===l)this._cancelSuggest(),"Escape"===l&&this._clearActiveMenu();else{var M="Home"===l||"End"===l||"ArrowUp"===l||"ArrowDown"===
l;if("Enter"===l&&0>this._activeMenuItemIndex)this._cancelSuggest();else{var aa=null==(y=this._suggestionListNode)?void 0:y.getElementsByTagName("li");if(null!=aa&&aa.length){"suggestion"!==this.activeMenu&&this._openSuggestionMenu();if(M){e.preventDefault();this._cancelSuggest();this._handleItemNavigation(l,aa,this._suggestionListNode);return}e=aa[this._activeMenuItemIndex];if("Enter"===l&&e){(l=e["data-suggestion"])?(this._focus(),this.search(l)):e["data-current-location-item"]&&this._useCurrentLocation();
return}}this.viewModel.searchTerm&&this.suggest()}}};G._handleItemNavigation=function(e,y,l){const M=this._activeMenuItemIndex;"Home"===e&&(this._activeMenuItemIndex=0);"End"===e&&(this._activeMenuItemIndex=y.length-1);"ArrowUp"===e&&(this._activeMenuItemIndex=0>=this._activeMenuItemIndex?y.length-1:this._activeMenuItemIndex-1);"ArrowDown"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex===y.length-1?0:this._activeMenuItemIndex+1);M!==this._activeMenuItemIndex&&L.keepMenuItemWithinView(y[this._activeMenuItemIndex],
l)};G._scrollToTopSuggestion=function(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)};G._openSuggestionMenu=function(){this.activeMenu="suggestion"};G._handleInputPaste=function(e){e=e.target;this.viewModel.searchTerm!==e.value&&(this.viewModel.searchTerm=e.value);this.viewModel.searchTerm&&this.suggest()};G._handleSourceMenuKeydown=function(e){const y=t.eventKey(e);L.isActivationKey(y)?(e.preventDefault(),e=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex],
this._setSourceFromMenuItem(e)):"ArrowUp"!==y&&"ArrowDown"!==y&&"End"!==y&&"Home"!==y||e.preventDefault()};G._handleSourceMenuKeyup=function(e){var y;const l=t.eventKey(e),M="ArrowUp"===l||"ArrowDown"===l||"End"===l||"Home"===l;M&&e.preventDefault();if("Escape"===l){var aa;this._clearActiveMenu();null==(aa=this._sourceMenuButtonNode)?void 0:aa.focus()}else(e=null==(y=this._sourceListNode)?void 0:y.getElementsByTagName("li"))&&0!==e.length&&M&&("source"!==this.activeMenu&&(this.activeMenu="source"),
this._handleItemNavigation(l,e,this._sourceListNode.parentElement))};G._focus=function(e){this.focus();e&&(this.activeMenu=e)};G._formSubmit=function(e){e.preventDefault();-1===this._activeMenuItemIndex&&this.search()};G._getSourceName=function(e){const {messages:y}=this;var {allSources:l}=this.viewModel;l=l.getItemAt(e);return e===K.ALL_INDEX?y.all:l?l.name||y.untitledSource:y.untitledSource};G._splitResult=function(e,y){y=J.escapeRegExpString(y);return e.replace(new RegExp(`(^|)(${y})(|$)`,"ig"),
"$1|$2|$3").split("|")};G._renderSearchResultsContent=function(){this._searchResultRenderer.showMoreResultsOpen=!1;this._searchResultRenderer.viewModel=this.viewModel;return this._searchResultRenderer};d._createClass(I,[{key:"displayedSearchTerm",get:function(){return`${this.viewModel.searchTerm}`.trim()}},{key:"inputId",get:function(){return this._buildId("input")}},{key:"suggestionsMenuId",get:function(){return this._buildId("suggest-menu")}},{key:"sourceMenuId",get:function(){return this._buildId("source-menu")}},
{key:"sourceMenuButtonId",get:function(){return this._buildId("source-menu-button")}}]);return I}(w);b.__decorate([g.property()],a.prototype,"_activeMenuItemIndex",void 0);b.__decorate([g.property()],a.prototype,"displayedSearchTerm",null);b.__decorate([g.property({readOnly:!0})],a.prototype,"inputId",null);b.__decorate([g.property({readOnly:!0})],a.prototype,"suggestionsMenuId",null);b.__decorate([g.property({readOnly:!0})],a.prototype,"sourceMenuId",null);b.__decorate([g.property({readOnly:!0})],
a.prototype,"sourceMenuButtonId",null);b.__decorate([g.property()],a.prototype,"activeMenu",void 0);b.__decorate([N.aliasOf("viewModel.activeSource")],a.prototype,"activeSource",void 0);b.__decorate([N.aliasOf("viewModel.activeSourceIndex")],a.prototype,"activeSourceIndex",void 0);b.__decorate([N.aliasOf("viewModel.allPlaceholder")],a.prototype,"allPlaceholder",void 0);b.__decorate([N.aliasOf("viewModel.allSources")],a.prototype,"allSources",void 0);b.__decorate([N.aliasOf("viewModel.autoNavigate")],
a.prototype,"autoNavigate",void 0);b.__decorate([N.aliasOf("viewModel.autoSelect")],a.prototype,"autoSelect",void 0);b.__decorate([N.aliasOf("viewModel.defaultSources")],a.prototype,"defaultSources",void 0);b.__decorate([g.property()],a.prototype,"disabled",void 0);b.__decorate([N.aliasOf("viewModel.goToOverride")],a.prototype,"goToOverride",void 0);b.__decorate([g.property()],a.prototype,"iconClass",void 0);b.__decorate([N.aliasOf("viewModel.includeDefaultSources")],a.prototype,"includeDefaultSources",
void 0);b.__decorate([g.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],a.prototype,"label",void 0);b.__decorate([N.aliasOf("viewModel.locationEnabled")],a.prototype,"locationEnabled",void 0);b.__decorate([N.aliasOf("viewModel.maxResults")],a.prototype,"maxResults",void 0);b.__decorate([N.aliasOf("viewModel.maxSuggestions")],a.prototype,"maxSuggestions",void 0);b.__decorate([g.property(),m.messageBundle("esri/widgets/Search/t9n/Search")],a.prototype,"messages",void 0);b.__decorate([g.property(),
m.messageBundle("esri/t9n/common")],a.prototype,"messagesCommon",void 0);b.__decorate([N.aliasOf("viewModel.minSuggestCharacters")],a.prototype,"minSuggestCharacters",void 0);b.__decorate([N.aliasOf("viewModel.popupEnabled")],a.prototype,"popupEnabled",void 0);b.__decorate([N.aliasOf("viewModel.popupTemplate")],a.prototype,"popupTemplate",void 0);b.__decorate([N.aliasOf("viewModel.portal")],a.prototype,"portal",void 0);b.__decorate([N.aliasOf("viewModel.resultGraphic")],a.prototype,"resultGraphic",
void 0);b.__decorate([N.aliasOf("viewModel.resultGraphicEnabled")],a.prototype,"resultGraphicEnabled",void 0);b.__decorate([N.aliasOf("viewModel.results")],a.prototype,"results",void 0);b.__decorate([N.aliasOf("viewModel.searchAllEnabled")],a.prototype,"searchAllEnabled",void 0);b.__decorate([N.aliasOf("viewModel.searchTerm")],a.prototype,"searchTerm",void 0);b.__decorate([N.aliasOf("viewModel.selectedResult")],a.prototype,"selectedResult",void 0);b.__decorate([N.aliasOf("viewModel.sources")],a.prototype,
"sources",void 0);b.__decorate([N.aliasOf("viewModel.suggestions")],a.prototype,"suggestions",void 0);b.__decorate([N.aliasOf("viewModel.suggestionsEnabled")],a.prototype,"suggestionsEnabled",void 0);b.__decorate([N.aliasOf("viewModel.view")],a.prototype,"view",void 0);b.__decorate([F.vmEvent("search-complete search-clear search-start select-result suggest-start suggest-complete".split(" ")),g.property({type:K})],a.prototype,"viewModel",void 0);b.__decorate([N.aliasOf("viewModel.clear")],a.prototype,
"clear",null);return a=b.__decorate([r.subclass("esri.widgets.Search")],a)})},"esri/widgets/Search/SearchResultRenderer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../Widget ./SearchViewModel ../support/decorators/accessibleHandler ../support/decorators/messageBundle ../support/jsxFactory ../support/widgetUtils".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g,r){t=function(w){function E(L,m){L=w.call(this,L,m)||this;L.messages=null;L.showMoreResultsOpen=!1;L.viewModel=null;return L}d._inheritsLoose(E,w);var K=E.prototype;K.render=function(){return g.tsx("div",{class:"esri-search-result-renderer esri-widget"},g.tsx("div",{key:"esri-search-renderer__container",class:this.classes("esri-search-result-renderer__more-results",{["esri-search-result-renderer__more-results--show-more-results"]:this.showMoreResultsOpen})},this.renderSearchResultName(),
this.renderMoreResults()))};K.renderMoreResults=function(){return g.tsx("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())};K.renderSearchResultName=function(){var L;const m=null==(L=this.viewModel)?void 0:L.selectedResult;return g.tsx("div",{key:"esri-search-renderer__result-name",class:"esri-search-result-renderer__more-results-item"},m&&m.name||"")};K.renderMoreResultsLists=function(){var L,m=null==(L=this.viewModel)?void 0:L.results;
({resultCount:L}=this.viewModel);if(2>L)return null;m=m.map(F=>this.renderMoreResultsList(F));return g.tsx("div",{key:"esri-search-renderer__more-results-container",class:"esri-search-result-renderer__more-results-list"},m)};K.renderMoreResultsButton=function(){const {messages:L}=this,{resultCount:m}=this.viewModel;return 2>m?null:g.tsx("div",{key:"esri-search-renderer__more-results-button",class:"esri-search-result-renderer__more-results-item"},g.tsx("a",{class:"esri-widget__anchor",href:"#",bind:this,
onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?L.hideMoreResults:L.showMoreResults))};K.renderMoreResultsHeader=function(L,m){return g.tsx("div",{key:`esri-search-result-renderer__header-${m}`,class:"esri-search-result-renderer__more-results-list-header"},L)};K.renderMoreResultsList=function(L){var m,F;const {results:f}=L;var z=f.length;const B=!!z,O=null==(m=this.viewModel)?void 0:m.selectedResult;m=1===z&&f[0]===O;z=this._getSourceName(L.source,
L.sourceIndex);z=1<(null==(F=this.viewModel)?void 0:F.results.length)&&!m?this.renderMoreResultsHeader(z,L.sourceIndex):null;F=B&&f.map((I,G)=>this.renderMoreResultsListItem(I,G));F=B&&!m?g.tsx("ul",{key:`esri-search-result-renderer__list-${L.sourceIndex}`},F):null;return B?g.tsx("div",{key:`esri-search-result-renderer__results-${L.sourceIndex}`},z,F):null};K.renderMoreResultsListItem=function(L,m){const F=this.get("viewModel.selectedResult");return L!==F?g.tsx("li",{key:`esri-search-result-renderer__list-item-${m}`},
g.tsx("a",{class:"esri-widget__anchor",href:"#",tabindex:"0",bind:this,"data-result":L,onclick:this._selectResultClick,onkeydown:this._selectResultClick},L.name)):null};K._showMoreResultsClick=function(L){L.preventDefault();this.showMoreResultsOpen=!this.showMoreResultsOpen;(L=this.get("viewModel.view.popup"))&&L.reposition()};K._selectResultClick=function(L){L.preventDefault();L=L.currentTarget["data-result"];this.viewModel&&this.viewModel.select(L)};K._getSourceName=function(L,m){return m===x.ALL_INDEX?
this.messages.all:L.name};return E}(N);b.__decorate([a.property(),p.messageBundle("esri/widgets/Search/t9n/Search")],t.prototype,"messages",void 0);b.__decorate([a.property()],t.prototype,"showMoreResultsOpen",void 0);b.__decorate([a.property()],t.prototype,"viewModel",void 0);b.__decorate([u.accessibleHandler()],t.prototype,"_showMoreResultsClick",null);b.__decorate([u.accessibleHandler()],t.prototype,"_selectResultClick",null);return t=b.__decorate([J.subclass("esri.widgets.Search.SearchResultRenderer")],
t)})},"esri/widgets/Search/SearchViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../assets ../../config ../../Graphic ../../PopupTemplate ../../symbols ../../core/Accessor ../../core/Collection ../../core/deprecate ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/SpatialReference ../../intl/locale ../../intl/messages ../../portal/Portal ../../views/support/layerViewUtils ./LayerSearchSource ./LocatorSearchSource ./SearchSource ./support/geometryUtils ./support/locatorUtils ../support/geolocationUtils ../support/GoTo ../../symbols/TextSymbol ../../symbols/PictureMarkerSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleFillSymbol".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g,r,w,E,K,L,m,F,f,z,B,O,I,G,e,y,l,M,aa,A,Q,T,U,v,h,C,W,Z){function X(ja,ha){return ja.hasOwnProperty(ha)&&null!=ja[ha]&&""!==ja[ha]}const ca=w.getLogger("esri.widgets.Search.SearchViewModel"),ma=x.ofType({key:ja=>ja.layer?"layer":"locator",base:A,typeMap:{layer:M,locator:aa}}),ra=I.WGS84,pa=/<(?:.|\s)*?>/g;J=function(ja){function ha(c){c=ja.call(this,c)||this;c._handles=new r;c._gotoController=null;c._searching=null;c._createdFeatureLayers=[];c.autoNavigate=!0;c.autoSelect=
!0;c.defaultPopupTemplate=null;c.defaultSources=new ma;c.defaultSymbols={point:new C({url:a.getAssetUrl("esri/images/search/search-symbol-32.png"),size:24,width:24,height:24}),polyline:new W({color:[130,130,130,1],width:2}),polygon:new Z({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})};c.includeDefaultSources=!0;c.maxInputLength=128;c.maxResults=6;c.maxSuggestions=6;c.messages=null;c.minSuggestCharacters=3;c.popupEnabled=!0;c.popupTemplate=null;c.portal=y.getDefault();c.resultCount=
null;c.resultGraphicEnabled=!0;c.resultGraphic=null;c.results=null;c.selectedSuggestion=null;c.searchAllEnabled=!0;c.selectedResult=null;c.sources=new ma;c.suggestionDelay=350;c.suggestionCount=null;c.suggestions=null;c.suggestionsEnabled=!0;c.view=null;return c}d._inheritsLoose(ha,ja);var V=ha.prototype;V.initialize=function(){var c=this;const q=function(){var D=d._asyncToGenerator(function*(){const H=yield e.fetchMessageBundle("esri/widgets/Search/t9n/Search");c.messages=H;c.defaultPopupTemplate=
new S({title:H.searchResult,content:"{Match_addr}"})});return function(){return D.apply(this,arguments)}}();q();this._handles.add([L.watch(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),L.initial),G.onLocaleChange(q)])};V.destroy=function(){this._destroyFeatureLayers();this._abortGoTo();this.clearGraphics();this._handles.destroy();this._handles=null};V.clear=function(){this.searchTerm=""};V.clearGraphics=function(){this._removeHighlight();this._closePopup();this.view&&this.view.graphics.remove(this.resultGraphic);
this._set("resultGraphic",null)};V.search=function(c,q){this.emit("search-start");this.clearGraphics();const D=this._createSuggestionForSearch(c);return this._searching=c=this.when().then(()=>this._getResultsFromSources(D,q).then(H=>{var R;if(null!=(R=E.unwrap(null==q?void 0:q.signal))&&R.aborted)return null;const ba={activeSourceIndex:this.activeSourceIndex,searchTerm:D.text,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(ba,H,D);H=this._getFirstResult(ba.results);R=(D.location&&
H?H.name:D.text).replace(pa,"");this._set("searchTerm",R);(D.key&&"number"===typeof D.sourceIndex||D.location)&&this._set("selectedSuggestion",D);this._set("results",ba.results);this._set("resultCount",ba.results.reduce((ea,ia)=>ea+ia.results.length,0));this.emit("search-complete",ba);return this._selectFirstResult(H).then(()=>ba)})).then(H=>{this._clearSearching();return H},H=>{this._clearSearching();throw H;})};V.searchNearby=function(c){if(!this.locationEnabled){var q=new p("searchNearby:geolocation-unsupported",
"Geolocation API is unsupported.",{geolocation:navigator.geolocation});ca.error(q);return Promise.reject(q)}this._searching=q=U.getCurrentPosition().then(D=>U.positionToPoint({position:D,view:this.view},c)).then(D=>this.search(D,c));q.catch(()=>{}).then(()=>this._clearSearching());return q};V.select=function(c){this.clearGraphics();if(!c){var q=new p("select:missing-parameter","Cannot select without a searchResult.",{searchResult:c});ca.error(q);return Promise.reject(q)}const {view:D}=this,H=X(c,
"sourceIndex")?c.sourceIndex:this._getSourceIndexOfResult(c),R=this.allSources.getItemAt(H);if(!R)return q=new p("select:missing-source","Cannot select without a source.",{source:R}),ca.error(q),Promise.reject(q);q=R instanceof M?this._getLayerSourcePopupTemplate(R):R.popupTemplate;const ba=R.resultSymbol||this._getDefaultSymbol(c),ea=X(R,"resultGraphicEnabled")?R.resultGraphicEnabled:this.resultGraphicEnabled,ia=X(R,"autoNavigate")?R.autoNavigate:this.autoNavigate,qa=X(R,"popupEnabled")?R.popupEnabled:
this.popupEnabled,ta=qa?q||this.popupTemplate||this.defaultPopupTemplate:null,{feature:oa}=c;if(!oa)return q=new p("select:missing-feature","Cannot select without a feature.",{feature:oa}),ca.error(q),Promise.reject(q);const {attributes:ua,geometry:va,layer:na,sourceLayer:sa}=oa,da=Q.getPointFromGeometry(va);q={layerViewQuery:this._getLayerView(oa),elevationQuery:D&&E.isSome(da)?Q.getPointWithElevation(da,D).catch(()=>da):Promise.resolve(da)};return K.eachAlways(q).then(n=>{const P=n.layerViewQuery.value,
Y=n.elevationQuery.value;ba instanceof h&&(ba.text=c.name);n=D&&ia?c.target||c.extent:null;return(E.isSome(n)?this._goToSearchResult(n):Promise.resolve()).then(()=>{var fa;const ka=P?oa:new k({geometry:va,symbol:ba,attributes:ua,layer:na,sourceLayer:sa,popupTemplate:ta}),la=qa&&(null==(fa=this.view)?void 0:fa.popup);(fa=la&&ka.getEffectivePopupTemplate(la.defaultPopupTemplateEnabled))&&D.popup.open({features:[ka],location:Y});P&&l.highlightsSupported(P)&&!fa&&this._highlightFeature({graphic:ka,layerView:P});
!P&&ea&&D&&D.graphics.push(ka);this._setResultFloor(c);this._set("selectedResult",c);this._set("resultGraphic",ka);this.emit("select-result",{result:c,source:R,sourceIndex:H});return c})})};V.suggest=function(c,q,D){const H=c||this.searchTerm;this.emit("suggest-start",{searchTerm:H});return this._suggestTimer(q,D).then(()=>this._suggestImmediate(H,D).then(R=>{this._set("suggestions",R.results);this._set("suggestionCount",R.results.reduce((ba,ea)=>ba+ea.results.length,0));this.emit("suggest-complete",
R);return R}))};V.when=function(){var c=d._asyncToGenerator(function*(){yield L.whenOnce(()=>!this.updating)});return function(){return c.apply(this,arguments)}}();V._update=function(){var c=d._asyncToGenerator(function*(){const {portal:q,view:D}=this;if(this.includeDefaultSources){const H=this._updatingPromise=K.eachAlways([null==q?void 0:q.load(),null==D?void 0:D.when()]);if(this.destroyed)return;yield H;if(H!==this._updatingPromise)return}yield L.whenOnce(()=>this.messages);this.destroyed||this._updateDefaultSources();
this._updatingPromise=null});return function(){return c.apply(this,arguments)}}();V._clearSearching=function(){this._searching=null};V._convertHelperServices=function(){var c,q;const D=null==(c=this.portal)?void 0:null==(q=c.helperServices)?void 0:q.geocode;return D?D.map(H=>{if(!1!==H.placefinding){var R=t.apiKey&&T.isArcGISWorldGeocoder(H.url)?{url:T.meteredArcGISLocatorUrl}:null;H=aa.fromJSON({...H,...R});R=H.url;(T.isArcGISWorldGeocoder(R)||T.isProxiedArcGISWorldGeocoder(R)||T.isMeteredArcGISWorldGeocoder(R))&&
H.set({singleLineFieldName:"SingleLine",outFields:H.outFields||["Addr_type","Match_addr","StAddr","City"],placeholder:H.placeholder||this.messages.placeholder,defaultZoomScale:"number"===typeof H.defaultZoomScale?H.defaultZoomScale:2500});if(H.singleLineFieldName)return H}}).filter(Boolean):[]};V._destroyFeatureLayers=function(){this._createdFeatureLayers.forEach(c=>null==c?void 0:c.destroy());this._createdFeatureLayers=[]};V._getLayerSources=function(c,q){var D;const H=null==(D=this.view)?void 0:
D.map;return c.map(R=>{const ba=H.findLayerById(R.id);if(ba){R=this._getLayerJSON(R);var ea=M.fromJSON(R);ea.placeholder=q;this._getLayer(ba,R).then(ia=>{ea.layer=ia});return ea}}).filter(Boolean).toArray()};V._getTableSources=function(c,q){var D;const H=null==(D=this.view)?void 0:D.map;return c.map(R=>{const ba=H.findTableById(R.id);if(ba){R=this._getLayerJSON(R);var ea=M.fromJSON(R);ea.placeholder=q;this._getLayer(ba,R).then(ia=>{ea.layer=ia});return ea}}).filter(Boolean).toArray()};V._convertApplicationProperties=
function(){var c,q,D;const H=null==(c=this.view)?void 0:c.map;c=null==H?void 0:null==(q=H.applicationProperties)?void 0:null==(D=q.viewing)?void 0:D.search;if(!c)return[];const {enabled:R,hintText:ba,layers:ea,tables:ia}=c;if(!R)return[];q=this._getLayerSources(ea,ba);D=this._getTableSources(ia,ba);return[...q,...D]};V._getSubLayer=function(){var c=d._asyncToGenerator(function*(q,D){yield q.load();if(!q.allSublayers)throw Error();q=q.allSublayers.find(H=>H.id===D.subLayer);if(!q)throw Error();q=yield q.createFeatureLayer();
this._createdFeatureLayers.push(q);return q});return function(q,D){return c.apply(this,arguments)}}();V._getBuildingSubLayer=function(){var c=d._asyncToGenerator(function*(q,D){yield q.load();q=q.allSublayers.find(H=>H.id===D.subLayer);if("building-component"!==(null==q?void 0:q.type))throw Error();yield q.load();if(null==q.associatedLayer)throw Error();yield q.associatedLayer.load();return q});return function(q,D){return c.apply(this,arguments)}}();V._getLayer=function(c,q){return"feature"===c.type||
"scene"===c.type||"csv"===c.type||"geojson"===c.type||"ogc-feature"===c.type?Promise.resolve(c):"map-image"===c.type?this._getSubLayer(c,q).catch(()=>{const D=new p("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:c});ca.error(D);return null}):"building-scene"===c.type?this._getBuildingSubLayer(c,q):Promise.resolve(null)};V._getLayerJSON=function(c){return"function"===typeof c.toJSON?c.toJSON():c};V._updateDefaultSources=function(){const {defaultSources:c,
includeDefaultSources:q}=this;this._destroyFeatureLayers();c.removeAll();q&&c.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])};V._abortGoTo=function(){this._gotoController&&this._gotoController.abort();this._gotoController=null};V._clear=function(){this._abortGoTo();this._set("resultCount",null);this._set("results",null);this._set("suggestions",null);this._set("suggestionCount",null);this._set("selectedResult",null);this._set("selectedSuggestion",null);this.emit("search-clear")};
V._closePopup=function(){var c;const q=null==(c=this.view)?void 0:c.popup;({resultGraphic:c}=this);if(q&&c){var {selectedFeature:D}=q;D&&D===c&&q.close()}};V._suggestTimer=function(c,q){return K.after(null!=c?c:this.suggestionDelay,null,q&&q.signal)};V._createLocationForSearch=function(c){return c instanceof k?Q.getPointFromGeometry(c.geometry):c instanceof O?c:Array.isArray(c)&&2===c.length?new O({longitude:c[0],latitude:c[1]}):null};V._createSuggestionForSearch=function(c){if(c&&X(c,"key")&&X(c,
"text")&&X(c,"sourceIndex"))return c;const q=this._createLocationForSearch(c),D="string"===typeof c?c:this.searchTerm,{selectedSuggestion:H,selectedResult:R}=this,ba=(c=!c&&H&&R)&&H.location;return c&&H.key===R.key&&H.sourceIndex===R.sourceIndex||ba?H:{location:E.unwrap(q),text:q?"":D,sourceIndex:null,key:null}};V._getFirstResult=function(c){let q=null;c&&c.some(D=>{({results:D}=D);D=D[0];const H=!!D;H&&(q=D);return H});return q};V._selectFirstResult=function(c){return this.autoSelect&&c?this.select(c):
Promise.resolve(null)};V._suggestImmediate=function(c,q){return this.when().then(()=>this._getSuggestionsFromSources(c,q)).then(D=>{var H;if(null!=(H=E.unwrap(null==q?void 0:q.signal))&&H.aborted)return null;H={activeSourceIndex:this.activeSourceIndex,searchTerm:c,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(H,D);return H})};V._formatSourceResponse=function(c,q,D){const H=q&&q.value||[];q=q&&q.error;const R=this.allSources.getItemAt(D);q?(c.errors.push({sourceIndex:D,source:R,
error:q}),ca.error(q),c.numErrors++):(c.results.push({sourceIndex:D,source:R,results:H}),c.numResults+=H.length)};V._formatResponse=function(c,q,D){if(q)if(-1===c.activeSourceIndex){const H=D&&X(D,"sourceIndex")&&-1!==D.sourceIndex?D.sourceIndex:void 0;q.forEach((R,ba)=>{this._formatSourceResponse(c,R,void 0!==H?H:ba)})}else this._formatSourceResponse(c,q[0],c.activeSourceIndex)};V._getResultsFromSources=function(c,q){var {allSources:D}=this;const H=!c.location&&X(c,"sourceIndex")?c.sourceIndex:this.activeSourceIndex,
R=[];if(!D.length)return D=new p("search:no-sources-defined","At least one source is required.",{allSources:D}),ca.error(D),Promise.reject(D);-1===H?D.forEach((ba,ea)=>{R.push(this._getResultsFromSource(c,ea,q))}):R.push(this._getResultsFromSource(c,H,q));return K.eachAlways(R)};V._getSuggestionsFromSources=function(c,q){const {allSources:D,activeSourceIndex:H}=this,R=[];if(!D.length){const ba=new p("suggest:no-sources-defined","At least one source is required.",{allSources:D});ca.error(ba);return Promise.reject(ba)}-1===
H?D.forEach((ba,ea)=>{R.push(this._getSuggestionsFromSource(c,ea,q))}):R.push(this._getSuggestionsFromSource(c,H,q));return K.eachAlways(R)};V._getResultsFromSource=function(c,q,D){var H;const R=this.allSources.getItemAt(q),{location:ba=null}=c,ea=(null==(H=this.view)?void 0:H.spatialReference)||ra;H=X(R,"maxResults")?R.maxResults:this.maxResults;const ia=R instanceof M&&X(R,"exactMatch")?R.exactMatch:!1,{view:qa}=this;return R.getResults({view:qa,sourceIndex:q,location:ba,suggestResult:c,spatialReference:ea,
exactMatch:ia,maxResults:H},D)};V._getSuggestionsFromSource=function(c,q,D){const H=this.allSources.getItemAt(q);var R=X(H,"suggestionsEnabled")?H.suggestionsEnabled:this.suggestionsEnabled,ba=c.length,ea=X(H,"minSuggestCharacters")?H.minSuggestCharacters:this.minSuggestCharacters;if(R&&c.trim()&&ba>=ea){var ia;R=(null==(ia=this.view)?void 0:ia.spatialReference)||ra;ia=X(H,"maxSuggestions")?H.maxSuggestions:this.maxSuggestions;({view:ba}=this);ea=H instanceof M&&X(H,"exactMatch")?H.exactMatch:!1;
return H.getSuggestions({view:ba,sourceIndex:q,suggestTerm:c,spatialReference:R,maxSuggestions:ia,exactMatch:ea},D)}return Promise.resolve(null)};V._getLayerSourcePopupTemplate=function(c){const {layer:q}=c;if(q)return X(c,"popupTemplate")?c.popupTemplate:q.popupTemplate};V._getSourceIndexOfResult=function(c){let q=null;this.results.some(D=>D.results.some(H=>H===c?(q=D.sourceIndex,!0):!1));return q};V._goToSearchResult=function(){var c=d._asyncToGenerator(function*(q){const D=!!q;this._abortGoTo();
const H=new AbortController;this._gotoController=H;yield this.callGoTo({target:{target:q},options:{animate:D,signal:H.signal}});this._gotoController=null});return function(q){return c.apply(this,arguments)}}();V._getDefaultSymbol=function(c){var q;const {defaultSymbols:D}=this;c=null==(q=c.feature)?void 0:q.geometry;if(E.isNone(c))return null;if((q=this._get("defaultSymbol"))&&("point"===c.type||"multipoint"===c.type))return q;switch(c.type){case "point":case "multipoint":return D.point;case "polyline":return D.polyline;
case "extent":case "polygon":return D.polygon;default:return null}};V._removeHighlight=function(){this._handles.remove("highlight")};V._getLayerView=function(){var c=d._asyncToGenerator(function*(q){const {view:D}=this;if(!q||!D||"building-component"===q.layer.type||"subtype-sublayer"===q.layer.type)return null;({layer:q}=q);yield D.when();return D.whenLayerView(q)});return function(q){return c.apply(this,arguments)}}();V._highlightFeature=function(c){const {graphic:q,layerView:D}=c,{attributes:H,
layer:R}=q;({objectIdField:c}=R);c=D.highlight(H&&H[c]||q);this._handles.add(c,"highlight")};V._setResultFloor=function(c){var q,D,H;const {view:R}=this,ba=null==(q=c.feature)?void 0:q.attributes;(c=null==(D=c.feature)?void 0:D.sourceLayer)&&"floorInfo"in c&&null!=c&&null!=(H=c.floorInfo)&&H.floorField&&ba&&R.emit("select-result-floor",ba[c.floorInfo.floorField])};d._createClass(ha,[{key:"activeSource",get:function(){return this.allSources.getItemAt(this.activeSourceIndex)||null}},{key:"activeSourceIndex",
get:function(){return 1!==this.allSources.length&&this.searchAllEnabled?-1:0},set:function(c){void 0===c?this._clearOverride("activeSourceIndex"):this._override("activeSourceIndex",c)}},{key:"allPlaceholder",get:function(){var c;return null==(c=this.messages)?void 0:c.allPlaceholder},set:function(c){c?this._override("allPlaceholder",c):this._clearOverride("allPlaceholder")}},{key:"allSources",get:function(){const {sources:c,defaultSources:q,includeDefaultSources:D}=this,H="function"===typeof D?D.call(null,
{sources:c,defaultSources:q}):D?q.concat(c):c,R=this._get("allSources")||new ma;R.removeAll();R.addMany(H.filter(Boolean));return R}},{key:"defaultSymbol",get:function(){u.deprecatedProperty(ca,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"});return this._get("defaultSymbol")},set:function(c){u.deprecatedProperty(ca,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"});this._set("defaultSymbol",c)}},{key:"locationEnabled",get:function(){return this._get("locationEnabled")||
U.supported()},set:function(c){if(void 0===c)this._clearOverride("locationEnabled");else{var q=U.supported();if(c&&!q){const D=new p("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});ca.error(D)}this._override("locationEnabled",c&&q)}}},{key:"placeholder",get:function(){const {allSources:c,activeSourceIndex:q,allPlaceholder:D}=this;if(-1===q)return D;const H=c.getItemAt(q);return H?H.placeholder:""}},{key:"searchTerm",get:function(){return this._get("searchTerm")||
""},set:function(c){this._set("searchTerm",c||"");this.clearGraphics();this.selectedSuggestion&&this.selectedSuggestion.text!==c&&this._set("selectedSuggestion",null);""===c&&this._clear()}},{key:"state",get:function(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}},{key:"updating",get:function(){return null!=this._updatingPromise}}]);return ha}(v.GoToMixin(g.EventedMixin(N)));J.ALL_INDEX=-1;b.__decorate([m.property()],J.prototype,"_searching",
void 0);b.__decorate([m.property()],J.prototype,"_updatingPromise",void 0);b.__decorate([m.property({readOnly:!0,value:null})],J.prototype,"activeSource",null);b.__decorate([m.property()],J.prototype,"activeSourceIndex",null);b.__decorate([m.property()],J.prototype,"allPlaceholder",null);b.__decorate([m.property({readOnly:!0})],J.prototype,"allSources",null);b.__decorate([m.property()],J.prototype,"autoNavigate",void 0);b.__decorate([m.property()],J.prototype,"autoSelect",void 0);b.__decorate([m.property()],
J.prototype,"defaultPopupTemplate",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"defaultSources",void 0);b.__decorate([m.property()],J.prototype,"defaultSymbol",null);b.__decorate([m.property()],J.prototype,"defaultSymbols",void 0);b.__decorate([m.property()],J.prototype,"includeDefaultSources",void 0);b.__decorate([m.property()],J.prototype,"locationEnabled",null);b.__decorate([m.property()],J.prototype,"maxInputLength",void 0);b.__decorate([m.property()],J.prototype,"maxResults",
void 0);b.__decorate([m.property()],J.prototype,"maxSuggestions",void 0);b.__decorate([m.property()],J.prototype,"messages",void 0);b.__decorate([m.property()],J.prototype,"minSuggestCharacters",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"placeholder",null);b.__decorate([m.property()],J.prototype,"popupEnabled",void 0);b.__decorate([m.property({type:S})],J.prototype,"popupTemplate",void 0);b.__decorate([m.property({type:y})],J.prototype,"portal",void 0);b.__decorate([m.property()],
J.prototype,"resultCount",void 0);b.__decorate([m.property()],J.prototype,"resultGraphicEnabled",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"resultGraphic",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"results",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"selectedSuggestion",void 0);b.__decorate([m.property()],J.prototype,"searchAllEnabled",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"selectedResult",void 0);b.__decorate([m.property()],
J.prototype,"searchTerm",null);b.__decorate([m.property({type:ma})],J.prototype,"sources",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"state",null);b.__decorate([m.property()],J.prototype,"suggestionDelay",void 0);b.__decorate([m.property()],J.prototype,"suggestionCount",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"suggestions",void 0);b.__decorate([m.property()],J.prototype,"suggestionsEnabled",void 0);b.__decorate([m.property({readOnly:!0})],J.prototype,"updating",
null);b.__decorate([m.property()],J.prototype,"view",void 0);b.__decorate([m.property()],J.prototype,"clear",null);return J=b.__decorate([B.subclass("esri.widgets.Search.SearchViewModel")],J)})},"esri/widgets/Search/LayerSearchSource":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/layerSearchUtils".split(" "),
function(d,b,a,t,k,S,J,N){var x;k=x=function(u){function p(r){var w=u.call(this,r)||this;w.displayField=null;w.exactMatch=null;w.orderByFields=null;w.searchFields=null;w.searchTemplate=null;w.suggestionTemplate=null;w.getResults=(E,K)=>N.getResults({source:d._assertThisInitialized(w),...E},K);w.getSuggestions=(E,K)=>N.getSuggestions({source:d._assertThisInitialized(w),...E},K);return w}d._inheritsLoose(p,u);var g=p.prototype;g.clone=function(){return new x({autoNavigate:this.autoNavigate,filter:this.filter,
maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?a.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,
layer:this.layer,searchFields:this.searchFields?a.clone(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})};g._getFirstStringField=function(){var r,w;return null!=(r=null==(w=this.layer.fieldsIndex.fields.find(E=>"string"===E.type))?void 0:w.name)?r:""};g._getDisplayField=function(){return this.displayField||this.layer.displayField||this._getFirstStringField()};g._getSearchFieldsString=function(){const {layer:r,searchFields:w}=this;return r.loaded?`: ${(w||
[this._getDisplayField()]).map(E=>{const K=r.getField(E);return K&&K.alias||E}).join(", ")}`:""};g._getLayerTitle=function(){var {layer:r}=this;if(r&&({title:r}=r,r))return`${r}${this._getSearchFieldsString()}`};d._createClass(p,[{key:"layer",set:function(r){this._set("layer",r);r&&r.load().catch(()=>{})}},{key:"name",get:function(){return this._getLayerTitle()||""},set:function(r){void 0===r?this._clearOverride("name"):this._override("name",r)}}]);return p}(J);b.__decorate([t.property({json:{read:{source:"field.name"},
write:{target:"field.name"}}})],k.prototype,"displayField",void 0);b.__decorate([t.property({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],k.prototype,"exactMatch",void 0);b.__decorate([t.property({value:null})],k.prototype,"layer",null);b.__decorate([t.property()],k.prototype,"name",null);b.__decorate([t.property({type:[String],json:{write:!0}})],k.prototype,"orderByFields",void 0);b.__decorate([t.property()],k.prototype,"searchFields",void 0);b.__decorate([t.property()],
k.prototype,"searchTemplate",void 0);b.__decorate([t.property()],k.prototype,"suggestionTemplate",void 0);return k=x=b.__decorate([S.subclass("esri.widgets.Search.LayerSearchSource")],k)})},"esri/widgets/Search/SearchSource":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,b,a,t,k,S,J,N,x){a=function(u){function p(g){g=u.call(this,g)||this;g.autoNavigate=null;g.filter=null;g.getResults=null;g.getSuggestions=null;g.maxResults=null;g.maxSuggestions=null;g.minSuggestCharacters=null;g.outFields=null;g.placeholder="";g.popupEnabled=null;g.popupTemplate=null;g.prefix="";g.resultGraphicEnabled=null;g.resultSymbol=null;g.suggestionsEnabled=null;g.suffix="";g.withinViewEnabled=!1;g.zoomScale=null;return g}d._inheritsLoose(p,u);return p}(a.IdentifiableMixin(t.JSONSupport));
b.__decorate([k.property()],a.prototype,"autoNavigate",void 0);b.__decorate([k.property()],a.prototype,"filter",void 0);b.__decorate([k.property()],a.prototype,"getResults",void 0);b.__decorate([k.property()],a.prototype,"getSuggestions",void 0);b.__decorate([k.property()],a.prototype,"maxResults",void 0);b.__decorate([k.property()],a.prototype,"maxSuggestions",void 0);b.__decorate([k.property()],a.prototype,"minSuggestCharacters",void 0);b.__decorate([k.property()],a.prototype,"outFields",void 0);
b.__decorate([k.property()],a.prototype,"placeholder",void 0);b.__decorate([k.property()],a.prototype,"popupEnabled",void 0);b.__decorate([k.property()],a.prototype,"popupTemplate",void 0);b.__decorate([k.property()],a.prototype,"prefix",void 0);b.__decorate([k.property()],a.prototype,"resultGraphicEnabled",void 0);b.__decorate([k.property()],a.prototype,"resultSymbol",void 0);b.__decorate([k.property()],a.prototype,"suggestionsEnabled",void 0);b.__decorate([k.property()],a.prototype,"suffix",void 0);
b.__decorate([k.property()],a.prototype,"withinViewEnabled",void 0);b.__decorate([k.property()],a.prototype,"zoomScale",void 0);return a=b.__decorate([x.subclass("esri.widgets.Search.SearchSource")],a)})},"esri/widgets/Search/support/layerSearchUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../intl ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/unitUtils ../../../geometry/Polygon ./geometryUtils ../../../intl/substitute ../../../intl/date".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g){function r(A,Q){const {filter:T,withinViewEnabled:U}=A;A=Q&&Q.extent;return T&&T.geometry||(U&&A?A:void 0)}function w(A){return E.apply(this,arguments)}function E(){E=b._asyncToGenerator(function*(A){A&&(yield A.load())});return E.apply(this,arguments)}function K(A){var Q,T,U;return null!=(Q=null==A?void 0:null==(T=A.capabilities)?void 0:null==(U=T.query)?void 0:U.supportsPagination)?Q:!1}function L(A){var Q,T,U,v;return null!=(Q=null==A?void 0:null==(T=A.fieldsIndex)?
void 0:null==(U=T.fields)?void 0:null==(v=U.find(h=>"string"===h.type))?void 0:v.name)?Q:""}function m(A,Q){return A&&Q?Q.every(T=>!!A.getField(T)):!1}function F(A,Q,T){let U=null;({codedValues:A}=A);A&&A.some(v=>{var h=v.name;h=T?h:h.toLowerCase();return(T?Q:Q.toLowerCase())===h?(U=v.code.toString(),!0):!1});return U}function f(A,Q){return(Q=Q&&Q.where)?`(${A}) AND (${Q})`:A}function z({currentTerm:A,field:Q,filter:T,exactMatch:U,url:v,type:h}){var C=Q.type;Q=Q.name;if("string"===C||"date"===C||
"global-id"===C){if(C=v=l.test(v))a:{for(C=0;C<A.length;C++)if(255<A.charCodeAt(C)){C=!0;break a}C=!1}C=C?"N":"";if(U&&"search"===h)return f(`${Q} = ${C}'${A}'`,T);h=v?Q:`UPPER(${Q})`;A=v?A:A.toUpperCase();return f(`${h} LIKE ${C}${U?`'${A}%'`:`'%${A}%'`}`,T)}return"oid"===C||"small-integer"===C||"integer"===C||"single"===C||"double"===C?(U=Number(A),isNaN(U)?null:f(`${Q} = ${U}`,T)):f(`${Q} = ${A}`,T)}function B({searchTerm:A,layer:Q,searchFields:T,filter:U,exactMatch:v,type:h}){const {definitionExpression:C,
url:W}=Q;let Z="";A&&T&&T.forEach(X=>{var ca=Q.getField(X);X=((X="function"===typeof Q.getFieldDomain&&Q.getFieldDomain(X))&&"coded-value"===X.type?F(X,A,v):null)||A||null;null!==X&&(ca=z({currentTerm:X,field:ca,filter:U,exactMatch:v,url:W,type:h}))&&(Z+=Z?` OR (${ca})`:`(${ca})`)});return C?`(${C}) AND (${Z})`:Z}function O(A,Q){let T=null;({codedValues:A}=A);A&&A.length&&A.some(U=>U.code===Q?(T=U.name,!0):!1);return T}function I(A,Q){return A[Object.keys(A).find(T=>T.toLowerCase()===Q.toLowerCase())]}
function G(A,Q,T){const U=A.sourceLayer,{attributes:v}=A;A="function"===typeof U.getFieldDomain&&U.getFieldDomain(T);return Q?p.substitute(Q,v):T&&v?(Q=U.getField(T),T=I(v,T),null==T?"":A&&"coded-value"===A.type?O(A,T):"date"===(null==Q?void 0:Q.type)?g.formatDate(new Date(T)):"number"===typeof T?T.toString():"string"!==typeof T?"":T.trim()):""}function e(A,Q,T,U){return A.features.map(v=>{var h=v.sourceLayer,{attributes:C}=v;({objectIdField:h}=h);C=C[h];return v={text:G(v,Q.suggestionTemplate,U),
key:C,sourceIndex:T}})}function y(A,Q,T,U,v,h,C){return A.features.map(W=>{{var Z=W.clone();var X=W.sourceLayer;X=(X=X&&X.objectIdField)&&W.attributes[X];const ma=G(W,T.searchTemplate,v);var ca=u.createExtentFromGeometry(Z.geometry,Q,h);ca="number"===typeof C?u.scaleExtent(k.clone(ca),Q,C):ca;W=W.clone();J.isSome(ca)&&(W.geometry=x.fromExtent(ca));Z={extent:ca,target:W,feature:Z,key:X,name:ma,sourceIndex:U}}return Z})}const l=/https?:\/\/services.*\.arcgis\.com/i,M=/(?:\{([^}]+)\})/g,aa=S.getLogger("esri.widgets.Search.support.layerSearchUtils");
d.getResults=function(A,Q){const {exactMatch:T=!1,location:U,maxResults:v,spatialReference:h,source:C,sourceIndex:W,suggestResult:Z,view:X}=A,{layer:ca,filter:ma,zoomScale:ra}=C,pa=X&&X.scale,ja=r(C,X),ha=Q&&Q.signal;return w(ca).then(()=>{const V=ca.popupTemplate;return V?V.getRequiredFields(ca.fieldsIndex):null}).then(V=>{var c,q,D;const {objectIdField:H,returnZ:R}=ca,ba=C.displayField||C.layer.displayField||L(C.layer);if(!ca.getField(ba))throw aa.error("invalid-field: displayField is invalid."),
new t("getResults():invalid-field","displayField is invalid.");V=V&&V.length?V:[ba];var ea=(V=C.outFields||V)&&V.includes("*");V.includes(H)||ea||V.push(H);null!=(c=ca.floorInfo)&&c.floorField&&V.push(ca.floorInfo.floorField);if(!ea&&!m(ca,V))throw aa.error("invalid-field: outField is invalid."),new t("getResults():invalid-field","outField is invalid.");c=ca.createQuery();({orderByFields:ea}=C);ea&&(c.orderByFields=ea);h&&(c.outSpatialReference=h,ea=1/N.getMetersPerUnitForSR(h))&&(c.maxAllowableOffset=
ea);ea="mesh"===ca.geometryType||"multipatch"===ca.geometryType;const ia=(null==(q=ca.capabilities)?void 0:null==(D=q.data)?void 0:D.supportsZ)&&!ea;c.returnZ=ia&&!1!==R;c.returnGeometry=!0;c.multipatchOption=ea?"xyFootprint":null;V&&(c.outFields=V);if(U)c.geometry=U;else if(Z.key)c.objectIds=[Z.key];else{q=C.searchFields||[ba];if(!m(ca,q))throw aa.error("invalid-field: search field is invalid."),new t("getResults():invalid-field","search field is invalid.");K(ca)&&(c.num=v);ja&&(c.geometry=ja);if(!Z.text.trim())return[];
const {prefix:qa="",suffix:ta=""}=C;D=`${qa}${Z.text}${ta}`.replace(/'/g,"''");q=B({searchTerm:D,layer:ca,searchFields:q,filter:ma,exactMatch:T,type:"search"});if(!q)return[];c.where=q}return ca.queryFeatures(c,{signal:ha}).then(qa=>y(qa,X,C,W,ba,pa,ra))})};d.getSuggestions=function(A,Q){const {source:T,spatialReference:U,view:v,suggestTerm:h,maxSuggestions:C,sourceIndex:W,exactMatch:Z}=A,{layer:X,filter:ca}=T,ma=Q&&Q.signal,ra=r(T,v);return w(X).then(()=>{if(!K(X))return[];const pa=T.displayField||
T.layer.displayField||L(T.layer);var ja=T.searchFields||[pa];const ha=[];T.suggestionTemplate?T.suggestionTemplate.replace(M,(R,ba)=>{ha.push(ba);return R}):ha.push(pa);var V=ha&&ha.includes("*");ha.includes(X.objectIdField)||V||ha.push(X.objectIdField);var c=!!X.getField(pa);V=V||m(X,ha);const q=m(X,ja);if(!c)throw aa.error("invalid-field: displayField is invalid."),new t("getSuggestions():invalid-field","displayField is invalid.");if(!V)throw aa.error("invalid-field: outField is invalid."),new t("getSuggestions():invalid-field",
"outField is invalid.");if(!q)throw aa.error("invalid-field: search field is invalid."),new t("getSuggestions():invalid-field","search field is invalid.");c=X.createQuery();({orderByFields:V}=T);V&&(c.orderByFields=V);c.outSpatialReference=U;c.returnGeometry=!1;c.num=C;c.outFields=ha;ra&&(c.geometry=ra);if(!h.trim())return[];const {prefix:D="",suffix:H=""}=T;V=`${D}${h}${H}`.replace(/'/g,"''");ja=B({searchTerm:V,layer:X,searchFields:ja,filter:ca,exactMatch:Z,type:"suggest"});if(!ja)return[];c.where=
ja;return X.queryFeatures(c,{signal:ma}).then(R=>e(R,T,W,pa))})};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Search/support/geometryUtils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/Logger ../../../core/maybe ../../../geometry/support/scaleUtils ../../../geometry/Extent".split(" "),function(d,b,a,t,k,S,J){function N(u,p,g){const r=u.hasZ?u.z:void 0;return p&&p.map?(g?S.getExtentForScale(p,g):p.extent).clone().centerAt(u).set({zmax:r,
zmin:r}):new J({xmin:u.x-.25,ymin:u.y-.25,xmax:u.x+.25,ymax:u.y+.25,spatialReference:u.spatialReference,zmin:r,zmax:r})}const x=t.getLogger("esri.widgets.Search.support.geometryUtils");d.createExtentFromGeometry=function(u,p,g){if(k.isNone(u))return null;if("extent"===u.type)return u;if("multipoint"===u.type||"polygon"===u.type||"polyline"===u.type)return u.extent;if("point"===u.type)return N(u,p,g)};d.getPointFromGeometry=function(u){if(k.isNone(u))return null;switch(u.type){case "point":return u;
case "extent":return u.center;case "polygon":return u.centroid;case "multipoint":return u.getPoint(0);case "polyline":return u.getPoint(0,0)}return null};d.getPointWithElevation=function(u,p){var g,r;if(!p)return x.error("missing-parameter: view is missing."),Promise.reject(new a("searchgeometryutils:missing-parameter","view is missing."));if(!u)return x.error("missing-parameter: point is missing."),Promise.reject(new a("searchgeometryutils:missing-parameter","point is missing."));if(u.hasZ||"2d"===
p.type)return Promise.resolve(u);const w=null==p?void 0:null==(g=p.map)?void 0:g.ground;return w&&w.layers.length?w.queryElevation(u,{cache:null==(r=p.basemapTerrain)?void 0:r.elevationQueryCache}).then(E=>E.geometry):Promise.resolve(u)};d.scaleExtent=function(u,p,g){return k.isNone(u)||k.isNone(p)?null:N(u.center,p,g)};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Search/LocatorSearchSource":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/locatorUtils".split(" "),
function(d,b,a,t,k,S,J,N){var x;k=x=function(u){function p(g){var r=u.call(this,g)||this;r.apiKey=null;r.categories=null;r.countryCode=null;r.defaultZoomScale=null;r.localSearchDisabled=!1;r.locationType=null;r.name="";r.placeholder="";r.searchTemplate="";r.singleLineFieldName=null;r.suggestionsEnabled=null;r.url=null;r.zoomScale=null;r.getResults=(w,E)=>N.getResults({source:d._assertThisInitialized(r),...w},E);r.getSuggestions=(w,E)=>N.getSuggestions({source:d._assertThisInitialized(r),...w},E);
return r}d._inheritsLoose(p,u);p.prototype.clone=function(){return new x({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?a.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,
suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?a.clone(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})};return p}(J);b.__decorate([t.property()],k.prototype,"apiKey",void 0);b.__decorate([t.property()],k.prototype,"categories",void 0);b.__decorate([t.property()],k.prototype,"countryCode",void 0);b.__decorate([t.property({json:{write:!0}})],
k.prototype,"defaultZoomScale",void 0);b.__decorate([t.property()],k.prototype,"localSearchDisabled",void 0);b.__decorate([t.property()],k.prototype,"locationType",void 0);b.__decorate([t.property({json:{write:!0}})],k.prototype,"name",void 0);b.__decorate([t.property({json:{write:!0}})],k.prototype,"placeholder",void 0);b.__decorate([t.property()],k.prototype,"searchTemplate",void 0);b.__decorate([t.property({json:{write:!0}})],k.prototype,"singleLineFieldName",void 0);b.__decorate([t.property({json:{read:{source:"suggest"},
write:{target:"suggest"}}})],k.prototype,"suggestionsEnabled",void 0);b.__decorate([t.property({json:{write:!0}})],k.prototype,"url",void 0);b.__decorate([t.property({json:{write:!0}})],k.prototype,"zoomScale",void 0);return k=x=b.__decorate([S.subclass("esri.widgets.Search.LocatorSearchSource")],k)})},"esri/widgets/Search/support/locatorUtils":function(){define("exports ../../../Graphic ../../../core/maybe ../../../geometry/Polygon ../../../rest/locator/addressToLocations ../../../rest/locator/locationToAddress ../../../rest/locator/suggestLocations ../../../rest/support/AddressToLocationsParameters ../../../rest/support/LocationToAddressParameters ../../../rest/support/SuggestLocationsParameters ./geometryUtils".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p){function g(m,F){if(F.localSearchDisabled)return null;F=null==m?void 0:m.scale;return"number"===typeof F&&3E5>=F?m.get("extent.center"):null}function r(m,F){const {source:f,spatialReference:z,location:B,sourceIndex:O,view:I}=m,{apiKey:G,url:e,zoomScale:y,defaultZoomScale:l}=f,M=I&&I.scale;m=F&&F.signal;F=new x;F.location=B;G&&(F.apiKey=G);z&&(F.outSpatialReference=z);return S.locationToAddress(e,F,{signal:m}).then(aa=>L([aa],{sourceIndex:O,scale:M,view:I,zoomScale:y,
defaultZoomScale:l})).catch(()=>[])}function w(m,F){const {filter:f,withinViewEnabled:z}=m;m=F&&F.extent;return(F=p.createExtentFromGeometry(f&&f.geometry,F,F&&F.scale))||(z&&m?m:void 0)}function E(m,F){const {source:f,suggestResult:z,spatialReference:B,view:O,maxResults:I,sourceIndex:G}=m,e=f&&f.zoomScale,y=f&&f.defaultZoomScale;if(!z.text.trim())return Promise.resolve(null);m=`${!z.key&&f.prefix?f.prefix:""}${z.text}${!z.key&&f.suffix?f.suffix:""}`;const l=new N,{apiKey:M,url:aa}=f,A=O&&O.scale;
var Q=w(f,O);F=F&&F.signal;M&&(l.apiKey=M);if(!aa)return Promise.resolve(null);f.categories&&(l.categories=f.categories);f.locationType&&(l.locationType=f.locationType);B&&(l.outSpatialReference=B);const T=g(O,f);T&&(l.location=T);l.maxLocations=I;Q&&(l.searchExtent=a.unwrap(Q));f.countryCode&&(l.countryCode=f.countryCode);({key:Q}=z);const U=`${Q}`;Q&&(l.magicKey=U);l.address={};l.address[f.singleLineFieldName||"Single Line Input"]=m;f.outFields&&(l.outFields=f.outFields);return k.addressToLocations(aa,
l,{signal:F}).then(v=>L(v,{key:U,scale:A,sourceIndex:G,view:O,zoomScale:e,defaultZoomScale:y}))}function K(m,F){return m.map(f=>({text:f.text,key:f.magicKey,sourceIndex:F}))}function L(m,F){return m.filter(Boolean).map(f=>{{const {key:O,scale:I,sourceIndex:G,view:e,zoomScale:y,defaultZoomScale:l}=F,{attributes:M,extent:aa,location:A,address:Q}=f;f=new b({geometry:A,attributes:M});var z=aa||A,B=p.createExtentFromGeometry(z,e,I);z="number"===typeof y?p.scaleExtent(B,e,y):"number"===typeof l&&"point"===
z.type?p.scaleExtent(B,e,l):B;B=A?`${A.x},${A.y}`:"";B=Q||B;const T=f.clone();a.isSome(z)&&(T.geometry=t.fromExtent(z));f={extent:z,feature:f,target:T,key:O,name:B,sourceIndex:G}}return f})}d.getLocation=g;d.getResults=function(m,F){return m.location?r(m,F):E(m,F)};d.getSuggestions=function(m,F){const {source:f,spatialReference:z,view:B,suggestTerm:O,maxSuggestions:I,sourceIndex:G}=m;m=new u;const {apiKey:e,url:y}=f,l=w(f,B);F=F&&F.signal;if(!y)return Promise.resolve(null);e&&(m.apiKey=e);f.categories&&
(m.categories=f.categories);z&&(m.outSpatialReference=z);const M=g(B,f);M&&(m.location=M);if(!O.trim())return Promise.resolve(null);const {prefix:aa="",suffix:A=""}=f;m.text=`${aa}${O}${A}`;l&&(m.searchExtent=a.unwrap(l));m.maxSuggestions=I;f.countryCode&&(m.countryCode=f.countryCode);return J.suggestLocations(y,m,{signal:F}).then(Q=>K(Q,G))};d.isArcGISWorldGeocoder=function(m){return m?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(m):!1};d.isMeteredArcGISWorldGeocoder=function(m){return m?
/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(m):!1};d.isProxiedArcGISWorldGeocoder=function(m){return m?/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(m):!1};d.meteredArcGISLocatorUrl="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/locator/addressToLocations":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../utils ./utils ../support/AddressCandidate ../support/AddressToLocationsParameters".split(" "),
function(d,b,a,t,k,S,J){function N(){N=b._asyncToGenerator(function*(u,p,g){p=J.from(p);u=t.parseUrl(u);const {address:r,...w}=p.toJSON();p=t.encode({...u.query,...r,...w,f:"json"});g=t.asValidOptions(p,g);return a(`${u.path}/findAddressCandidates`,g).then(x)});return N.apply(this,arguments)}function x({data:u}){if(!u)return[];const {candidates:p,spatialReference:g}=u;return p?p.map(r=>{if(r){var {extent:w,location:E}=r,K=w?k.isValidExtent(w):!0;if(k.isValidLocation(E)&&K)return w&&(w.spatialReference=
g),E.spatialReference=g,S.fromJSON(r)}}):[]}d.addressToLocations=function(u,p,g){return N.apply(this,arguments)};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/locator/utils":function(){define(["exports"],function(d){d.isValidExtent=function(b){return b&&"number"===typeof b.xmin&&"number"===typeof b.ymin&&"number"===typeof b.xmax&&"number"===typeof b.ymax};d.isValidLocation=function(b){return b&&"number"===typeof b.x&&"number"===typeof b.y};
d.normalizeExtent=function(b){return b?b.shiftCentralMeridian():null};d.normalizePoint=function(b){return b?b.clone().normalize():null};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/AddressCandidate":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point".split(" "),
function(d,b,a,t,k,S,J,N,x,u){a=function(p){function g(r){r=p.call(this,r)||this;r.address=null;r.attributes=null;r.extent=null;r.location=null;r.score=null;return r}d._inheritsLoose(g,p);return g}(a.JSONSupport);b.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"address",void 0);b.__decorate([t.property({type:Object,json:{write:!0}})],a.prototype,"attributes",void 0);b.__decorate([t.property({type:x,json:{write:!0}})],a.prototype,"extent",void 0);b.__decorate([t.property({type:u,
json:{write:!0}})],a.prototype,"location",void 0);b.__decorate([t.property({type:Number,json:{write:!0}})],a.prototype,"score",void 0);return a=b.__decorate([N.subclass("esri.rest.support.AddressCandidate")],a)})},"esri/rest/support/AddressToLocationsParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g,r){a=function(w){function E(K){K=w.call(this,K)||this;K.address=null;K.apiKey=null;K.categories=null;K.countryCode=null;K.forStorage=null;K.location=null;K.locationType=null;K.magicKey=null;K.maxLocations=null;K.outFields=null;K.outSpatialReference=null;K.searchExtent=null;return K}d._inheritsLoose(E,w);return E}(t.JSONSupport);b.__decorate([k.property({type:Object,json:{write:!0}})],a.prototype,"address",void 0);b.__decorate([k.property(u.apiKey)],a.prototype,"apiKey",
void 0);b.__decorate([k.property({type:[String],json:{read:{source:"category",reader:w=>w?w.split(","):null},write:{target:"category",writer:(w,E)=>{E.category=w?w.join(","):null}}}})],a.prototype,"categories",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],a.prototype,"countryCode",void 0);b.__decorate([k.property({type:Boolean,json:{write:!0}})],a.prototype,"forStorage",void 0);b.__decorate([k.property({type:p,json:{write:{writer:(w,E)=>{E.location=w?w.clone().normalize():null}}}})],
a.prototype,"location",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],a.prototype,"locationType",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],a.prototype,"magicKey",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],a.prototype,"maxLocations",void 0);b.__decorate([k.property({type:[String],json:{write:{writer:(w,E)=>{E.outFields=w?w.join(","):null}}}})],a.prototype,"outFields",void 0);b.__decorate([k.property({type:g,json:{read:{source:"outSR"},
write:{target:"outSR"}}})],a.prototype,"outSpatialReference",void 0);b.__decorate([k.property({type:r,json:{write:{writer:(w,E)=>{w=w?w.shiftCentralMeridian():null;E.searchExtent=w}}}})],a.prototype,"searchExtent",void 0);a=b.__decorate([x.subclass("esri.rest.support.AddressToLocationsParameters")],a);a.from=N.ensureType(a);return a})},"esri/rest/support/commonProperties":function(){define(["exports"],function(d){d.apiKey={type:String,json:{read:{source:"token"},write:{target:"token"}}};Object.defineProperties(d,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/locator/locationToAddress":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../utils ../support/AddressCandidate ../support/LocationToAddressParameters".split(" "),function(d,b,a,t,k,S){function J(){J=b._asyncToGenerator(function*(x,u,p){u=S.from(u);x=t.parseUrl(x);u={...u.toJSON(),f:"json"};u=t.encode({...x.query,...u});p=t.asValidOptions(u,p);return a(`${x.path}/reverseGeocode`,p).then(N)});
return J.apply(this,arguments)}function N({data:x}){if(x){var {address:u,location:p}=x;return k.fromJSON({address:u&&u.Match_addr||"",attributes:u||{},location:p,score:100})}}d.locationToAddress=function(x,u,p){return J.apply(this,arguments)};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/LocationToAddressParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g){a=function(r){function w(E){E=r.call(this,E)||this;E.apiKey=null;E.location=null;E.locationType=null;E.outSpatialReference=null;return E}d._inheritsLoose(w,r);return w}(t.JSONSupport);b.__decorate([k.property(u.apiKey)],a.prototype,"apiKey",void 0);b.__decorate([k.property({type:p,json:{write:{writer:(r,w)=>{r=r?r.clone().normalize():null;w.location="undefined"!==typeof r?r:null}}}})],a.prototype,"location",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],
a.prototype,"locationType",void 0);b.__decorate([k.property({type:g,json:{read:{source:"outSR"},write:{target:"outSR"}}})],a.prototype,"outSpatialReference",void 0);a=b.__decorate([x.subclass("esri.rest.support.LocationToAddressParameters")],a);a.from=N.ensureType(a);return a})},"esri/rest/locator/suggestLocations":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../utils ../support/SuggestionCandidate ../support/SuggestLocationsParameters".split(" "),function(d,b,a,
t,k,S){function J(){J=b._asyncToGenerator(function*(x,u,p){x=t.parseUrl(x);u=S.from(u);u={...u.toJSON(),f:"json"};u=t.encode({...x.query,...u});p=t.asValidOptions(u,p);return a(`${x.path}/suggest`,p).then(N)});return J.apply(this,arguments)}function N(x){({data:x}=x);if(!x)return[];({suggestions:x}=x);return x?x.map(u=>new k(u)):[]}d.suggestLocations=function(x,u,p){return J.apply(this,arguments)};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/SuggestionCandidate":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,b,a,t,k,S,J,N){a=function(x){function u(p){p=x.call(this,p)||this;p.isCollection=null;p.magicKey=null;p.text=null;return p}d._inheritsLoose(u,x);return u}(a.JSONSupport);b.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"isCollection",void 0);b.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"magicKey",void 0);b.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"text",void 0);return a=b.__decorate([N.subclass("esri.rest.support.SuggestionCandidate")],
a)})},"esri/rest/support/SuggestLocationsParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),function(d,b,a,t,k,S,J,N,x,u,p,g,r){a=function(w){function E(K){K=
w.call(this,K)||this;K.apiKey=null;K.categories=null;K.countryCode=null;K.location=null;K.maxSuggestions=null;K.outSpatialReference=null;K.searchExtent=null;K.text=null;return K}d._inheritsLoose(E,w);return E}(t.JSONSupport);b.__decorate([k.property(u.apiKey)],a.prototype,"apiKey",void 0);b.__decorate([k.property({type:[String],json:{read:{source:"category",reader:w=>w?w.split(","):null},write:{target:"category",writer:(w,E)=>{E.category=w?w.join(","):null}}}})],a.prototype,"categories",void 0);b.__decorate([k.property({type:String,
json:{write:!0}})],a.prototype,"countryCode",void 0);b.__decorate([k.property({type:p,json:{write:{writer:(w,E)=>{E.location=w?w.clone().normalize():null}}}})],a.prototype,"location",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],a.prototype,"maxSuggestions",void 0);b.__decorate([k.property({type:g,json:{read:{source:"outSR"},write:{target:"outSR"}}})],a.prototype,"outSpatialReference",void 0);b.__decorate([k.property({type:r,json:{write:{writer:(w,E)=>{w=w?w.shiftCentralMeridian():
null;E.searchExtent=JSON.stringify(w)}}}})],a.prototype,"searchExtent",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],a.prototype,"text",void 0);a=b.__decorate([x.subclass("esri.rest.support.SuggestLocationsParameters")],a);a.from=N.ensureType(a);return a})},"esri/widgets/support/geolocationUtils":function(){define("exports ../../config ../../core/Error ../../core/has ../../core/Logger ../../geometry/Point ../../geometry/support/webMercatorUtils ../../portal/Portal ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/arrayUtils ../../core/urlUtils ../../geometry ../../geometry/Extent ../../geometry/Geometry ../../geometry/Multipoint ../../geometry/Polygon ../../geometry/Polyline ../../rest/geometryService/units ../../rest/operations/generalize ../../rest/support/GeneralizeParameters ../../rest/operations/lengths ../../rest/support/LengthsParameters ../../rest/operations/offset ../../rest/support/OffsetParameters ../../rest/geometryService/project ../../rest/operations/relation ../../rest/support/RelationParameters ../../rest/operations/trimExtend ../../rest/support/TrimExtendParameters ../../rest/support/ProjectParameters".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g,r,w,E,K,L,m,F,f,z,B,O,I,G,e,y,l,M,aa,A){function Q(h,C,W){if(!C)return Promise.resolve(h);const Z=C.spatialReference;return Z.isWGS84?Promise.resolve(h):Z.isWebMercator?Promise.resolve(J.geographicToWebMercator(h)):T(W).then(X=>{if(!X)throw new a("geometry-service:missing-url","Geometry service URL is missing");const ca=new A({geometries:[h],outSpatialReference:Z});return e.project(X,ca,W).then(ma=>ma[0])})}function T(h){if(b.geometryServiceUrl)return Promise.resolve(b.geometryServiceUrl);
const C=N.getDefault();return C.load(h).catch(()=>{}).then(()=>C.get("helperServices.geometry.url"))}const U=k.getLogger("esri.widgets.support.geolocationUtils"),v={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};d.getCurrentPosition=function(h){h||(h=v);return new Promise((C,W)=>{setTimeout(()=>W(new a("geolocation:timeout","getting the current geolocation position timed out")),15E3);navigator.geolocation.getCurrentPosition(C,W,h)})};d.positionToPoint=function(h,C){const {position:W,view:Z}=h;h=
W&&W.coords||{};h={accuracy:h.accuracy,altitude:h.altitude,altitudeAccuracy:h.altitudeAccuracy,heading:h.heading,latitude:h.latitude,longitude:h.longitude,speed:h.speed};h=W?{coords:h,timestamp:W.timestamp}:W;h=(h=h&&h.coords)?new S({longitude:h.longitude,latitude:h.latitude,z:h.altitude||null,spatialReference:{wkid:4326}}):null;return Q(h,Z,C)};d.supported=function(){var h;(h=t("esri-geolocation"))||U.warn("geolocation-unsupported","Geolocation unsupported.");h&&((h=window.isSecureContext)||U.warn("insecure-context",
"Geolocation requires a secure origin."));return h};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/SceneLayer":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../PopupTemplate ../renderers/ClassBreaksRenderer ../renderers/DictionaryRenderer ../renderers/DotDensityRenderer ../renderers/HeatmapRenderer ../renderers/PieChartRenderer ../renderers/Renderer ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/support/jsonUtils ../renderers/support/types ../request ../core/Collection ../core/Error ../core/Logger ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/reactiveUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/utils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/PropertyOrigin ./Layer ./mixins/APIKeyMixin ./mixins/ArcGISService ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/SceneService ./support/capabilities ./support/commonProperties ./support/FeatureReduction ./support/FeatureReductionSelection ./support/FetchAssociatedFeatureLayer ./support/fieldProperties ./support/FieldsIndex ./support/fieldUtils ./support/I3SLayerDefinitions ./support/LabelClass ./support/labelingInfo ./support/LayerFloorInfo ./support/RangeInfo ./support/SceneFilter ../renderers/support/styleUtils ../rest/support/Query ../support/popupUtils ../webdoc/support/opacityUtils".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g,r,w,E,K,L,m,F,f,z,B,O,I,G,e,y,l,M,aa,A,Q,T,U,v,h,C,W,Z,X,ca,ma,ra,pa,ja,ha,V,c,q,D,H,R,ba,ea,ia,qa){const ta=["3DObject","Point"],oa=m.getLogger("esri.layers.SceneLayer");k=pa.defineFieldProperties();f=function(na){function sa(...n){n=na.call(this,...n)||this;n.featureReduction=null;n.rangeInfos=null;n.operationalLayerType="ArcGISSceneServiceLayer";n.type="scene";n.fields=null;n.floorInfo=null;n.outFields=null;n.nodePages=null;n.materialDefinitions=null;n.textureSetDefinitions=
null;n.geometryDefinitions=null;n.serviceUpdateTimeStamp=null;n.excludeObjectIds=new K;n.definitionExpression=null;n.filter=null;n.path=null;n.labelsVisible=!0;n.labelingInfo=null;n.legendEnabled=!0;n.priority=null;n.semantic=null;n.cachedDrawingInfo={color:!1};n.popupEnabled=!0;n.popupTemplate=null;n.objectIdField=null;n.globalIdField=null;n._fieldUsageInfo={};n.screenSizePerspectiveEnabled=!0;return n}b._inheritsLoose(sa,na);var da=sa.prototype;da.normalizeCtorArgs=function(n,P){return"string"===
typeof n?{url:n,...P}:n};da.getField=function(n){return this.fieldsIndex.get(n)};da.getFieldDomain=function(n,P){var Y,fa,ka,la;return(P=null==(Y=this.getFeatureType(null==P?void 0:P.feature))?void 0:null==(fa=Y.domains)?void 0:fa[n])&&"inherited"!==P.type?P:null!=(ka=null==(la=this.getField(n))?void 0:la.domain)?ka:null};da.getFeatureType=function(n){return n&&F.isSome(this.associatedLayer)?this.associatedLayer.getFeatureType(n):null};da.readNodePages=function(n,P,Y){"Point"===P.layerType&&(n=P.pointNodePages);
return null==n||"object"!==typeof n?null:V.I3SNodePageDefinition.fromJSON(n,Y)};da.readCachedDrawingInfo=function(n){if(null==n||"object"!==typeof n)n={};null==n.color&&(n.color=!1);return n};da.readObjectIdField=function(n,P){!n&&P.fields&&P.fields.some(Y=>{"esriFieldTypeOID"===Y.type&&(n=Y.name);return!!n});return n||void 0};da.readGlobalIdField=function(n,P){!n&&P.fields&&P.fields.some(Y=>{"esriFieldTypeGlobalID"===Y.type&&(n=Y.name);return!!n});return n||void 0};da.readProfile=function(n,P){n=
P.store.profile;if(null!=n&&ua[n])return ua[n];oa.error("Unknown or missing profile",{profile:n,layer:this});return"mesh-pyramids"};da.load=function(n){const P=F.isSome(n)?n.signal:null,Y=this.loadFromPortal({supportedTypes:["Scene Service"]},n).catch(z.throwIfAbortError).then(()=>this._fetchService(P)).then(()=>Promise.all([this._fetchIndexAndUpdateExtent(this.nodePages,P),this._setAssociatedFeatureLayer(P),F.isSome(this.filter)?this.filter.loadGeometries(this.spatialReference):null])).then(()=>
this._validateElevationInfo()).then(()=>this._applyAssociatedLayerOverrides()).then(()=>this._populateFieldUsageInfo()).then(()=>ba.loadStyleRenderer(this,{origin:"service"},P)).then(()=>ha.fixRendererFields(this.renderer,this.fieldsIndex)).then(()=>this.finishLoadEditablePortalLayer(n));this.addResolvingPromise(Y);return Promise.resolve(this)};da.beforeSave=function(){var n=b._asyncToGenerator(function*(){F.isSome(this.filter)&&(yield this.load())});return function(){return n.apply(this,arguments)}}();
da.createQuery=function(){const n=new ea;"mesh"!==this.geometryType&&(n.returnGeometry=!0,n.returnZ=!0);n.where=this.definitionExpression||"1\x3d1";n.sqlFormat="standard";return n};da.queryExtent=function(n,P){return this._getAssociatedLayerForQuery().then(Y=>Y.queryExtent(n||this.createQuery(),P))};da.queryFeatureCount=function(n,P){return this._getAssociatedLayerForQuery().then(Y=>Y.queryFeatureCount(n||this.createQuery(),P))};da.queryFeatures=function(n,P){return this._getAssociatedLayerForQuery().then(Y=>
Y.queryFeatures(n||this.createQuery(),P)).then(Y=>{if(null!=Y&&Y.features)for(const fa of Y.features)fa.layer=this,fa.sourceLayer=this;return Y})};da.queryObjectIds=function(n,P){return this._getAssociatedLayerForQuery().then(Y=>Y.queryObjectIds(n||this.createQuery(),P))};da.queryAttachments=function(n,P){return this._getAssociatedLayerForQuery().then(Y=>Y.queryAttachments(n,P))};da.getFieldUsageInfo=function(n){const P={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};
return this.loaded?this._fieldUsageInfo[n]||P:(oa.error("#getFieldUsageInfo()","Unavailable until layer is loaded"),P)};da.createPopupTemplate=function(n){return ia.createPopupTemplate(this,n)};da._getAssociatedLayerForQuery=function(){const n=this.associatedLayer;return F.isSome(n)&&n.loaded?Promise.resolve(n):this._loadAssociatedLayerForQuery()};da._loadAssociatedLayerForQuery=function(){var n=b._asyncToGenerator(function*(){yield this.load();if(F.isNone(this.associatedLayer))throw new L("scenelayer:query-not-available",
"SceneLayer queries are not available without an associated feature layer",{layer:this});try{yield this.associatedLayer.load()}catch(P){throw new L("scenelayer:query-not-available","SceneLayer associated feature layer could not be loaded",{layer:this,error:P});}return this.associatedLayer});return function(){return n.apply(this,arguments)}}();da.hasCachedStatistics=function(n){return null!=this.statisticsInfo&&this.statisticsInfo.some(P=>P.name===n)};da.queryCachedStatistics=function(){var n=b._asyncToGenerator(function*(P,
Y){yield this.load(Y);if(!this.statisticsInfo)throw new L("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");const fa=this.fieldsIndex.get(P);if(!fa)throw new L("scenelayer:field-unexisting",`Field '${P}' does not exist on the layer`);for(const ka of this.statisticsInfo)if(ka.name===fa.name)return P=O.join(this.parsedUrl.path,ka.href),E(P,{query:{f:"json",token:this.apiKey},responseType:"json",signal:Y?Y.signal:null}).then(la=>la.data);throw new L("scenelayer:no-cached-statistics",
"Cached statistics for this attribute are not available");});return function(P,Y){return n.apply(this,arguments)}}();da.saveAs=function(){var n=b._asyncToGenerator(function*(P,Y){return this._debouncedSaveOperations(W.SaveOperationType.SAVE_AS,{...Y,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"},P)});return function(P,Y){return n.apply(this,arguments)}}();da.save=function(){var n=b._asyncToGenerator(function*(){return this._debouncedSaveOperations(W.SaveOperationType.SAVE,
{getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"})});return function(){return n.apply(this,arguments)}}();da.applyEdits=function(){var n=b._asyncToGenerator(function*(P,Y){const fa=yield new Promise((ka,la)=>d(["./graphics/editingSupport"],ka,la));yield this.load();if(F.isNone(this.associatedLayer))throw new L(`${this.type}-layer:not-editable`,"Service is not editable");yield this.associatedLayer.load();return fa.applyEdits(this,this.associatedLayer.source,P,Y)});return function(P,
Y){return n.apply(this,arguments)}}();da.on=function(n,P){return na.prototype.on.call(this,n,P)};da.validateLayer=function(n){if(n.layerType&&!ta.includes(n.layerType))throw new L("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:n.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new L("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});
if(2<this.version.major)throw new L("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});{n=this.normalReferenceFrame;var P=this.spatialReference;let Y=!1,fa=!1;if(null==n)fa=Y=!0;else switch(P=P&&P.isGeographic,n){case "east-north-up":case "earth-centered":Y=!0;fa=P;break;case "vertex-reference-frame":Y=!0;fa=!P;break;default:Y=!1}if(!Y)throw new L("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");
if(!fa)throw new L("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.");}};da._getTypeKeywords=function(){const n=[];if("points"===this.profile)n.push("Point");else if("mesh-pyramids"===this.profile)n.push("3DObject");else throw new L("scenelayer:unknown-profile","SceneLayer:save() encountered an unknown SceneLayer profile: "+this.profile);return n};da._populateFieldUsageInfo=function(){this._fieldUsageInfo={};if(this.fields)for(const n of this.fields){const P=
!(!this.attributeStorageInfo||!this.attributeStorageInfo.some(fa=>fa.name===n.name)),Y=!!(F.isSome(this.associatedLayer)&&this.associatedLayer.fields&&this.associatedLayer.fields.some(fa=>fa&&n.name===fa.name));this._fieldUsageInfo[n.name]={supportsLabelingInfo:P,supportsRenderer:P,supportsPopupTemplate:P||Y,supportsLayerQuery:Y}}};da._applyAssociatedLayerOverrides=function(){this._applyAssociatedLayerFieldsOverrides();this._applyAssociatedLayerPopupOverrides()};da._applyAssociatedLayerFieldsOverrides=
function(){if(!F.isNone(this.associatedLayer)&&this.associatedLayer.fields){var n=null;for(const P of this.associatedLayer.fields){const Y=this.getField(P.name);Y?(!Y.domain&&P.domain&&(Y.domain=P.domain.clone()),Y.editable=P.editable,Y.nullable=P.nullable,Y.length=P.length):(n||(n=this.fields?this.fields.slice():[]),n.push(P.clone()))}n&&this._set("fields",n)}};da._applyAssociatedLayerPopupOverrides=function(){if(!F.isNone(this.associatedLayer)){var n=["popupTemplate","popupEnabled"],P=y.getProperties(this);
for(let Y=0;Y<n.length;Y++){const fa=n[Y],ka=this.originIdOf(fa),la=this.associatedLayer.originIdOf(fa);ka<la&&(la===A.OriginId.SERVICE||la===A.OriginId.PORTAL_ITEM)&&P.setAtOrigin(fa,this.associatedLayer[fa],la)}}};da._setAssociatedFeatureLayer=function(){var n=b._asyncToGenerator(function*(P){if(["mesh-pyramids","points"].includes(this.profile)){P=new ra.FetchAssociatedFeatureLayer(this.parsedUrl,this.portalItem,this.apiKey,P);try{this.associatedLayer=yield P.fetch()}catch(Y){z.isAbortError(Y)||
this._logWarningOnPopupEnabled()}}});return function(P){return n.apply(this,arguments)}}();da._logWarningOnPopupEnabled=function(){var n=b._asyncToGenerator(function*(){yield B.whenOnce(()=>this.popupEnabled&&null!=this.popupTemplate);const P=`this SceneLayer: ${this.title}`;null==this.attributeStorageInfo?oa.warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${P}`):oa.info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${P}`)});
return function(){return n.apply(this,arguments)}}();da._validateElevationInfo=function(){const n=this.elevationInfo;n&&("mesh-pyramids"===this.profile&&"relative-to-scene"===n.mode&&oa.warn(".elevationInfo\x3d","Mesh scene layers don't support relative-to-scene elevation mode"),n.featureExpressionInfo&&"0"!==n.featureExpressionInfo.expression&&oa.warn(".elevationInfo\x3d","Scene layers do not support featureExpressionInfo"))};b._createClass(sa,[{key:"types",get:function(){return F.isSome(this.associatedLayer)?
this.associatedLayer.types:[]}},{key:"typeIdField",get:function(){return F.isSome(this.associatedLayer)?this.associatedLayer.typeIdField:null}},{key:"formTemplate",get:function(){return F.isSome(this.associatedLayer)?this.associatedLayer.formTemplate:null}},{key:"fieldsIndex",get:function(){return new ja(this.fields)}},{key:"elevationInfo",set:function(n){this._set("elevationInfo",n);this.loaded&&this._validateElevationInfo()}},{key:"geometryType",get:function(){return va[this.profile]||"mesh"}},
{key:"renderer",set:function(n){ha.fixRendererFields(n,this.fieldsIndex);this._set("renderer",n)}},{key:"capabilities",get:function(){var n=F.isSome(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:Z.zeroCapabilities;const {query:P,editing:{supportsGlobalId:Y,supportsRollbackOnFailure:fa,supportsUploadWithItemId:ka,supportsReturnServiceEditsInSourceSpatialReference:la},data:{supportsZ:wa,supportsM:xa,isVersioned:ya,supportsAttachment:za},operations:{supportsEditing:Aa,
supportsUpdate:Ba,supportsQuery:Ca,supportsQueryAttachments:Da}}=n;n=n.operations.supportsChangeTracking;return{query:P,editing:{supportsGlobalId:Y,supportsReturnServiceEditsInSourceSpatialReference:la,supportsRollbackOnFailure:fa,supportsGeometryUpdate:!1,supportsUploadWithItemId:ka},data:{supportsAttachment:za,supportsZ:wa,supportsM:xa,isVersioned:ya},operations:{supportsQuery:Ca,supportsQueryAttachments:Da,supportsEditing:Aa&&n,supportsAdd:!1,supportsDelete:!1,supportsUpdate:Ba&&n}}}},{key:"editingEnabled",
get:function(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.userHasEditingPrivileges},set:function(n){null!=n?this._override("editingEnabled",n):this._clearOverride("editingEnabled")}},{key:"defaultPopupTemplate",get:function(){return F.isSome(this.associatedLayer)||this.attributeStorageInfo?this.createPopupTemplate():null}},{key:"displayField",get:function(){return F.isSome(this.associatedLayer)?this.associatedLayer.displayField:null}}]);return sa}(W.SceneService(U.ArcGISService(v.OperationalLayer(h.PortalLayer(C.ScaleRangeLayer(f.MultiOriginJSONMixin(T.APIKeyMixin(Q))))))));
a.__decorate([I.property({types:{key:"type",base:ca.FeatureReduction,typeMap:{selection:ma}},json:{origins:{"web-scene":{name:"layerDefinition.featureReduction",write:!0},"portal-item":{name:"layerDefinition.featureReduction",write:!0}}}})],f.prototype,"featureReduction",void 0);a.__decorate([I.property({type:[H.RangeInfo],json:{read:!1,origins:{"web-scene":{name:"layerDefinition.rangeInfos",write:!0},"portal-item":{name:"layerDefinition.rangeInfos",write:!0}}}})],f.prototype,"rangeInfos",void 0);
a.__decorate([I.property({json:{read:!1}})],f.prototype,"associatedLayer",void 0);a.__decorate([I.property({type:["show","hide"]})],f.prototype,"listMode",void 0);a.__decorate([I.property({type:["ArcGISSceneServiceLayer"]})],f.prototype,"operationalLayerType",void 0);a.__decorate([I.property({json:{read:!1},readOnly:!0})],f.prototype,"type",void 0);a.__decorate([I.property({...k.fields,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],f.prototype,"fields",void 0);a.__decorate([I.property()],
f.prototype,"types",null);a.__decorate([I.property()],f.prototype,"typeIdField",null);a.__decorate([I.property()],f.prototype,"formTemplate",null);a.__decorate([I.property({readOnly:!0})],f.prototype,"fieldsIndex",null);a.__decorate([I.property({type:D,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],f.prototype,"floorInfo",void 0);a.__decorate([I.property(k.outFields)],f.prototype,"outFields",void 0);a.__decorate([I.property({type:V.I3SNodePageDefinition,
readOnly:!0,json:{read:!1}})],f.prototype,"nodePages",void 0);a.__decorate([M.reader("service","nodePages",["nodePages","pointNodePages"])],f.prototype,"readNodePages",null);a.__decorate([I.property({type:[V.I3SMaterialDefinition],readOnly:!0})],f.prototype,"materialDefinitions",void 0);a.__decorate([I.property({type:[V.I3STextureSetDefinition],readOnly:!0})],f.prototype,"textureSetDefinitions",void 0);a.__decorate([I.property({type:[V.I3SGeometryDefinition],readOnly:!0})],f.prototype,"geometryDefinitions",
void 0);a.__decorate([I.property({readOnly:!0})],f.prototype,"serviceUpdateTimeStamp",void 0);a.__decorate([I.property({readOnly:!0})],f.prototype,"attributeStorageInfo",void 0);a.__decorate([I.property({readOnly:!0})],f.prototype,"statisticsInfo",void 0);a.__decorate([I.property({type:K.ofType(Number),nonNullable:!0,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.excludeObjectIds",write:{enabled:!0}}})],f.prototype,"excludeObjectIds",void 0);a.__decorate([I.property({type:String,
json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],f.prototype,"definitionExpression",void 0);a.__decorate([I.property({type:R,json:{name:"layerDefinition.polygonFilter",write:!0}})],f.prototype,"filter",void 0);a.__decorate([I.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],f.prototype,"path",void 0);a.__decorate([I.property(X.elevationInfo)],f.prototype,"elevationInfo",null);a.__decorate([I.property({type:String})],
f.prototype,"geometryType",null);a.__decorate([I.property(X.labelsVisible)],f.prototype,"labelsVisible",void 0);a.__decorate([I.property({type:[c],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:{reader:q.reader},write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:q.reader},write:!0}})],f.prototype,"labelingInfo",void 0);a.__decorate([I.property(X.legendEnabled)],f.prototype,"legendEnabled",void 0);a.__decorate([I.property({type:Number,json:{origins:{"web-document":{default:1,
write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}},read:{source:["opacity","layerDefinition.drawingInfo.transparency"],reader(na,sa){var da,n;if("number"===typeof na&&0<=na&&1>=na)return na;na=null==(da=sa.layerDefinition)?void 0:null==(n=da.drawingInfo)?void 0:n.transparency;return void 0!==na?qa.transparencyToOpacity(na):void 0}}},"portal-item":{write:!0},service:{read:!1}}}})],f.prototype,"opacity",void 0);a.__decorate([I.property({type:["Low",
"High"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],f.prototype,"priority",void 0);a.__decorate([I.property({type:["Labels"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],f.prototype,"semantic",void 0);a.__decorate([I.property({types:w.webSceneRendererTypes,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],f.prototype,"renderer",null);a.__decorate([I.property({json:{read:!1}})],f.prototype,"cachedDrawingInfo",
void 0);a.__decorate([M.reader("service","cachedDrawingInfo")],f.prototype,"readCachedDrawingInfo",null);a.__decorate([I.property({readOnly:!0,json:{read:!1}})],f.prototype,"capabilities",null);a.__decorate([I.property({type:Boolean,json:{read:!1}})],f.prototype,"editingEnabled",null);a.__decorate([I.property(X.popupEnabled)],f.prototype,"popupEnabled",void 0);a.__decorate([I.property({type:t,json:{name:"popupInfo",write:!0}})],f.prototype,"popupTemplate",void 0);a.__decorate([I.property({readOnly:!0,
json:{read:!1}})],f.prototype,"defaultPopupTemplate",null);a.__decorate([I.property({type:String,json:{read:!1}})],f.prototype,"objectIdField",void 0);a.__decorate([M.reader("service","objectIdField",["objectIdField","fields"])],f.prototype,"readObjectIdField",null);a.__decorate([I.property({type:String,json:{read:!1}})],f.prototype,"globalIdField",void 0);a.__decorate([M.reader("service","globalIdField",["globalIdField","fields"])],f.prototype,"readGlobalIdField",null);a.__decorate([I.property({readOnly:!0,
type:String,json:{read:!1}})],f.prototype,"displayField",null);a.__decorate([I.property({type:String,json:{read:!1}})],f.prototype,"profile",void 0);a.__decorate([M.reader("service","profile",["store.profile"])],f.prototype,"readProfile",null);a.__decorate([I.property({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],f.prototype,"normalReferenceFrame",void 0);a.__decorate([I.property(X.screenSizePerspectiveEnabled)],f.prototype,"screenSizePerspectiveEnabled",
void 0);f=a.__decorate([aa.subclass("esri.layers.SceneLayer")],f);const ua={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},va={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"};return f})},"esri/layers/mixins/SceneService":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Error ../../core/has ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/originUtils ../../geometry/Extent ../../geometry/HeightModelInfo ../../geometry/SpatialReference ../support/arcgisLayerUrl ../support/commonProperties ../support/I3SIndexInfo ../../portal/Portal ../../portal/PortalItem ../../webdoc/support/saveUtils".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g,r,w,E,K,L,m,F,f,z,B,O,I,G,e,y){const l=N.getLogger("esri.layers.mixins.SceneService");var M;(function(A){A[A.existingItem=0]="existingItem";A[A.newItem=1]="newItem"})(M||(M={}));const aa={getTypeKeywords:()=>[],portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}};b.SaveOperationType=void 0;(function(A){A[A.SAVE=0]="SAVE";A[A.SAVE_AS=1]="SAVE_AS"})(b.SaveOperationType||(b.SaveOperationType={}));b.SCENE_SERVICE_ITEM_TYPE=
"Scene Service";b.SceneService=A=>{A=function(Q){function T(){var v=Q.apply(this,arguments)||this;v.spatialReference=null;v.fullExtent=null;v.heightModelInfo=null;v.minScale=0;v.maxScale=0;v.version={major:Number.NaN,minor:Number.NaN,versionString:""};v.copyright=null;v.sublayerTitleMode="item-title";v.title=null;v.layerId=null;v.indexInfo=null;v._debouncedSaveOperations=u.debounce(function(){var h=a._asyncToGenerator(function*(C,W,Z){switch(C){case b.SaveOperationType.SAVE:return v._save(W);case b.SaveOperationType.SAVE_AS:return v._saveAs(Z,
W)}});return function(C,W,Z){return h.apply(this,arguments)}}());return v}a._inheritsLoose(T,Q);var U=T.prototype;U.readSpatialReference=function(v,h){return this._readSpatialReference(h)};U._readSpatialReference=function(v){if(null!=v.spatialReference)return z.fromJSON(v.spatialReference);v=v.store;v=(v=v.indexCRS||v.geographicCRS)&&parseInt(v.substring(v.lastIndexOf("/")+1,v.length),10);return null!=v?new z(v):null};U.readFullExtent=function(v,h,C){if(null!=v&&"object"===typeof v)return h=null==
v.spatialReference?{...v,spatialReference:this._readSpatialReference(h)}:v,F.fromJSON(h,C);C=h.store;h=this._readSpatialReference(h);return null==h||null==C||null==C.extent||!Array.isArray(C.extent)||C.extent.some(W=>-1E38>W)?null:new F({xmin:C.extent[0],ymin:C.extent[1],xmax:C.extent[2],ymax:C.extent[3],spatialReference:h})};U.parseVersionString=function(v){const h={major:Number.NaN,minor:Number.NaN,versionString:v};v=v.split(".");2<=v.length&&(h.major=parseInt(v[0],10),h.minor=parseInt(v[1],10));
return h};U.readVersion=function(v,h){v=h.store;return this.parseVersionString(null!=v.version?v.version.toString():"")};U.readTitlePortalItem=function(v){return"item-title"!==this.sublayerTitleMode?void 0:v};U.readTitleService=function(v,h){v=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return B.titleFromUrlAndName(this.url,h.name);h=h.name;if(!h&&this.url){const C=B.parse(this.url);x.isSome(C)&&(h=C.title)}"item-title-and-service-name"===this.sublayerTitleMode&&
v&&(h=v+" - "+h);return B.cleanTitle(h)};U.writeUrl=function(v,h,C,W){B.writeUrlWithLayerId(this,v,"layers",h,W)};U._fetchIndexAndUpdateExtent=function(){var v=a._asyncToGenerator(function*(h,C){this.indexInfo=I.fetchIndexInfo(this.parsedUrl.path,this.rootNode,h,this.apiKey,l,C);null==this.fullExtent||this.fullExtent.hasZ||this._updateExtent(yield this.indexInfo)});return function(h,C){return v.apply(this,arguments)}}();U._updateExtent=function(v){if("page"===(null==v?void 0:v.type)){var h,C,W=v.rootIndex%
v.pageSize;v=null==(h=v.rootPage)?void 0:null==(C=h.nodes)?void 0:C[W];if(null==v||null==v.obb||null==v.obb.center||null==v.obb.halfSize)throw new S("sceneservice:invalid-node-page","Invalid node page.");-1E38>v.obb.center[0]||null==this.fullExtent||this.fullExtent.hasZ||(h=v.obb.halfSize,C=v.obb.center[2],h=Math.sqrt(h[0]*h[0]+h[1]*h[1]+h[2]*h[2]),this.fullExtent.zmin=C-h,this.fullExtent.zmax=C+h)}else"node"===(null==v?void 0:v.type)&&(C=null==(W=v.rootNode)?void 0:W.mbs,!Array.isArray(C)||4!==C.length||
-1E38>C[0]||(h=C[2],C=C[3],this.fullExtent.zmin=h-C,this.fullExtent.zmax=h+C))};U._fetchService=function(){var v=a._asyncToGenerator(function*(h){if(null==this.url)throw new S("sceneservice:url-not-set","Scene service can not be loaded without valid portal item or url");if(null==this.layerId&&/SceneServer\/*$/i.test(this.url)){const C=yield this._fetchFirstLayerId(h);null!=C&&(this.layerId=C)}return this._fetchServiceLayer(h)});return function(h){return v.apply(this,arguments)}}();U._fetchFirstLayerId=
function(){var v=a._asyncToGenerator(function*(h){h=yield k(this.url,{query:{f:"json",token:this.apiKey},responseType:"json",signal:h});if(h.data&&Array.isArray(h.data.layers)&&0<h.data.layers.length)return h.data.layers[0].id});return function(h){return v.apply(this,arguments)}}();U._fetchServiceLayer=function(){var v=a._asyncToGenerator(function*(h){h=yield k(this.parsedUrl.path,{query:{f:"json",token:this.apiKey},responseType:"json",signal:h});h.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));
let C=!1;h.data.layerType&&"Voxel"===h.data.layerType&&(C=!0);if(C)return this._fetchVoxelServiceLayer();h=h.data;this.read(h,{origin:"service",url:this.parsedUrl});this.validateLayer(h)});return function(h){return v.apply(this,arguments)}}();U._fetchVoxelServiceLayer=function(){var v=a._asyncToGenerator(function*(h){h=(yield k(this.parsedUrl.path+"/layer",{query:{f:"json",token:this.apiKey},responseType:"json",signal:h})).data;this.read(h,{origin:"service",url:this.parsedUrl});this.validateLayer(h)});
return function(h){return v.apply(this,arguments)}}();U._ensureLoadBeforeSave=function(){var v=a._asyncToGenerator(function*(){yield this.load();"beforeSave"in this&&"function"===typeof this.beforeSave&&(yield this.beforeSave())});return function(){return v.apply(this,arguments)}}();U.validateLayer=function(v){};U._updateTypeKeywords=function(v,h,C){v.typeKeywords||(v.typeKeywords=[]);h=h.getTypeKeywords();for(const W of h)v.typeKeywords.push(W);v.typeKeywords&&(v.typeKeywords=v.typeKeywords.filter((W,
Z,X)=>X.indexOf(W)===Z),C===M.newItem&&(v.typeKeywords=v.typeKeywords.filter(W=>"Hosted Service"!==W)))};U._saveAs=function(){var v=a._asyncToGenerator(function*(h,C){C={...aa,...C};h=e.from(h);h||(l.error("_saveAs(): requires a portal item parameter"),yield Promise.reject(new S("sceneservice:portal-item-required","_saveAs() requires a portal item to save to")));h.id&&(h=h.clone(),h.id=null);const W=h.portal||G.getDefault();yield this._ensureLoadBeforeSave();h.type="Scene Service";h.portal=W;const Z=
{origin:"portal-item",url:null,messages:[],portal:W,portalItem:h,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},X={layers:[this.write({},Z)]};yield Promise.all(Z.resources.pendingOperations);yield this._validateAgainstJSONSchema(X,Z,C);h.url=this.url;h.title||(h.title=this.title);this._updateTypeKeywords(h,C,M.newItem);yield W._signIn();yield W.user.addItem({item:h,folder:C&&C.folder,data:X});yield y.saveResources(this.resourceReferences,
Z,null);this.portalItem=h;m.updateOrigins(Z);return Z.portalItem=h});return function(h,C){return v.apply(this,arguments)}}();U._save=function(){var v=a._asyncToGenerator(function*(h){h={...aa,...h};this.portalItem||(l.error("_save(): requires the .portalItem property to be set"),yield Promise.reject(new S("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService")));"Scene Service"!==this.portalItem.type&&(l.error("_save(): Non-matching portal item type. Got "+
this.portalItem.type+", expected Scene Service"),yield Promise.reject(new S("sceneservice:portal-item-wrong-type",'Portal item needs to have type "Scene Service"')));yield this._ensureLoadBeforeSave();const C={origin:"portal-item",url:this.portalItem.itemUrl&&p.urlToObject(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||G.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},W={layers:[this.write({},
C)]};yield Promise.all(C.resources.pendingOperations);yield this._validateAgainstJSONSchema(W,C,h);this.portalItem.url=this.url;this.portalItem.title||(this.portalItem.title=this.title);this._updateTypeKeywords(this.portalItem,h,M.existingItem);yield this.portalItem.update({data:W});yield y.saveResources(this.resourceReferences,C,null);m.updateOrigins(C);return this.portalItem});return function(h){return v.apply(this,arguments)}}();U._validateAgainstJSONSchema=function(){var v=a._asyncToGenerator(function*(h,
C,W){C=C.messages.filter(Z=>"error"===Z.type).map(Z=>new S(Z.name,Z.message,Z.details));W&&W.validationOptions.ignoreUnsupported&&(C=C.filter(Z=>"layer:unsupported"!==Z.name&&"symbol:unsupported"!==Z.name&&"symbol-layer:unsupported"!==Z.name&&"property:unsupported"!==Z.name&&"url:unsupported"!==Z.name&&"scenemodification:unsupported"!==Z.name));if(W.validationOptions.enabled&&(h=(yield new Promise((Z,X)=>d(["../support/schemaValidator"],Z,X))).validate(h,W.portalItemLayerType),0<h.length)){const Z=
`Layer item did not validate:\n${h.join("\n")}`;l.error(`_validateAgainstJSONSchema(): ${Z}`);if("throw"===W.validationOptions.failPolicy)throw W=h.map(X=>new S("sceneservice:schema-validation",X)).concat(C),new S("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{combined:W});}if(0<C.length)throw new S("sceneservice:save","Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information",
{errors:C});});return function(h,C,W){return v.apply(this,arguments)}}();a._createClass(T,[{key:"url",set:function(v){v=B.sanitizeUrlWithLayerId({layer:this,url:v,nonStandardUrlAllowed:!1,logger:l});this._set("url",v.url);null!=v.layerId&&this._set("layerId",v.layerId)}},{key:"parsedUrl",get:function(){var v=this._get("url");if(!v)return null;v=p.urlToObject(v);null!=this.layerId&&(v.path=`${v.path}/layers/${this.layerId}`);return v}}]);return T}(A);t.__decorate([g.property(O.id)],A.prototype,"id",
void 0);t.__decorate([g.property({type:z})],A.prototype,"spatialReference",void 0);t.__decorate([E.reader("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],A.prototype,"readSpatialReference",null);t.__decorate([g.property({type:F})],A.prototype,"fullExtent",void 0);t.__decorate([E.reader("fullExtent",["fullExtent","store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],A.prototype,"readFullExtent",null);t.__decorate([g.property({readOnly:!0,type:f})],
A.prototype,"heightModelInfo",void 0);t.__decorate([g.property({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],A.prototype,"minScale",void 0);t.__decorate([g.property({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],A.prototype,"maxScale",void 0);t.__decorate([g.property({readOnly:!0})],A.prototype,"version",void 0);t.__decorate([E.reader("version",["store.version"])],
A.prototype,"readVersion",null);t.__decorate([g.property({type:String,json:{read:{source:"copyrightText"}}})],A.prototype,"copyright",void 0);t.__decorate([g.property({type:String,json:{read:!1}})],A.prototype,"sublayerTitleMode",void 0);t.__decorate([g.property({type:String})],A.prototype,"title",void 0);t.__decorate([E.reader("portal-item","title")],A.prototype,"readTitlePortalItem",null);t.__decorate([E.reader("service","title",["name"])],A.prototype,"readTitleService",null);t.__decorate([g.property({type:Number,
json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],A.prototype,"layerId",void 0);t.__decorate([g.property(O.url)],A.prototype,"url",null);t.__decorate([L.writer("url")],A.prototype,"writeUrl",null);t.__decorate([g.property()],A.prototype,"parsedUrl",null);t.__decorate([g.property({readOnly:!0})],A.prototype,"store",void 0);t.__decorate([g.property({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],A.prototype,"rootNode",
void 0);return A=t.__decorate([K.subclass("esri.layers.mixins.SceneService")],A)};Object.defineProperties(b,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/I3SIndexInfo":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/maybe"],function(d,b,a,t,k){function S(){S=b._asyncToGenerator(function*(J,N,x,u,p,g){var r=null;if(k.isSome(x)){r=`${J}/nodepages/`;const w=r+Math.floor(x.rootIndex/x.nodesPerPage);
try{return{type:"page",rootPage:(yield a(w,{query:{f:"json",token:u},responseType:"json",signal:g})).data,rootIndex:x.rootIndex,pageSize:x.nodesPerPage,lodMetric:x.lodSelectionMetricType,urlPrefix:r}}catch(E){k.isSome(p)&&p.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",w,E),r=E}}if(!N)return null;N=N&&N.split("/").pop();J=`${J}/nodes/`;N=J+N;try{return{type:"node",rootNode:(yield a(N,{query:{f:"json",token:u},responseType:"json",signal:g})).data,urlPrefix:J}}catch(w){throw new t("sceneservice:root-node-missing",
"Root node missing.",{pageError:r,nodeError:w,url:N});}});return S.apply(this,arguments)}d.fetchIndexInfo=function(J,N,x,u,p,g){return S.apply(this,arguments)};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/capabilities":function(){define(["exports"],function(d){d.zeroCapabilities={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,
supportsResize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,
supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,
supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,
supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/FetchAssociatedFeatureLayer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../kernel ../../request ../../core/maybe ../../core/promiseUtils ../FeatureLayer ../../portal/Portal ../../portal/PortalItem".split(" "),
function(d,b,a,t,k,S,J,N,x){let u=function(){function p(r,w,E,K){this.parsedUrl=r;this.portalItem=w;this.apiKey=E;this.signal=K;this.rootDocument=null;if(r=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i))this.urlParts={root:r[1],layerId:parseInt(r[2],10)}}var g=p.prototype;g.fetch=function(){var r=b._asyncToGenerator(function*(){var w;if(!this.urlParts)return null;const E=null!=(w=this.portalItem)?w:yield this._portalItemFromServiceItemId();if(k.isNone(E))return this._loadFromUrl();
w=yield this._findAndLoadRelatedPortalItem(E);return k.isNone(w)?null:this._loadFeatureLayerFromPortalItem(w)});return function(){return r.apply(this,arguments)}}();g.fetchPortalItem=function(){var r=b._asyncToGenerator(function*(){var w;if(!this.urlParts)return null;const E=null!=(w=this.portalItem)?w:yield this._portalItemFromServiceItemId();return k.isNone(E)?null:this._findAndLoadRelatedPortalItem(E)});return function(){return r.apply(this,arguments)}}();g._fetchRootDocument=function(){var r=
b._asyncToGenerator(function*(){if(k.isSome(this.rootDocument))return this.rootDocument;if(k.isNone(this.urlParts))return this.rootDocument={},{};const w={query:{f:"json",token:this.apiKey},responseType:"json",signal:this.signal},E=`${this.urlParts.root}/SceneServer`;try{this.rootDocument=(yield t(E,w)).data}catch{this.rootDocument={}}return this.rootDocument});return function(){return r.apply(this,arguments)}}();g._fetchServiceOwningPortalUrl=function(){var r=b._asyncToGenerator(function*(){var w;
const E=null==(w=a.id)?void 0:w.findServerInfo(this.parsedUrl.path);if(null!=E&&E.owningSystemUrl)return E.owningSystemUrl;w=this.parsedUrl.path.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const K=(yield t(w,{query:{f:"json"},responseType:"json",signal:this.signal})).data.owningSystemUrl;if(K)return K}catch(K){S.throwIfAbortError(K)}return null});return function(){return r.apply(this,arguments)}}();g._findAndLoadRelatedPortalItem=function(){var r=b._asyncToGenerator(function*(w){try{return(yield w.fetchRelatedItems({relationshipType:"Service2Service",
direction:"reverse"},{signal:this.signal})).find(E=>"Feature Service"===E.type)||null}catch(E){return S.throwIfAbortError(E),null}});return function(w){return r.apply(this,arguments)}}();g._loadFeatureLayerFromPortalItem=function(){var r=b._asyncToGenerator(function*(w){yield w.load({signal:this.signal});const E=yield this._findMatchingAssociatedSublayerUrl(w.url);return(new J({url:E,portalItem:w})).load({signal:this.signal})});return function(w){return r.apply(this,arguments)}}();g._loadFromUrl=
function(){var r=b._asyncToGenerator(function*(){const w=yield this._findMatchingAssociatedSublayerUrl(`${this.urlParts.root}/FeatureServer`);return(new J({url:w})).load({signal:this.signal})});return function(){return r.apply(this,arguments)}}();g._findMatchingAssociatedSublayerUrl=function(){var r=b._asyncToGenerator(function*(w){w=w.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1");var E={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:this.signal};const K=this.urlParts.layerId;
var L=this._fetchRootDocument();E=t(w,E);const [m,F]=yield Promise.all([E,L]);L=F&&F.layers;E=m.data&&m.data.layers;if(!Array.isArray(E))throw Error("expected layers array");if(!Array.isArray(L)){if(K<E.length)return`${w}/${E[K].id}`}else for(let f=0;f<Math.min(L.length,E.length);f++)if(L[f].id===K)return`${w}/${E[f].id}`;throw Error("could not find matching associated sublayer");});return function(w){return r.apply(this,arguments)}}();g._portalItemFromServiceItemId=function(){var r=b._asyncToGenerator(function*(){var w=
(yield this._fetchRootDocument()).serviceItemId;if(!w)return null;w=new x({id:w,apiKey:this.apiKey});const E=yield this._fetchServiceOwningPortalUrl();k.isSome(E)&&(w.portal=new N({url:E}));try{return w.load({signal:this.signal})}catch(K){return S.throwIfAbortError(K),null}});return function(){return r.apply(this,arguments)}}();return p}();d.FetchAssociatedFeatureLayer=u;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/I3SLayerDefinitions":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,b,a,t,k,S,J,N,x,u){d.I3SNodePageDefinition=function(p){function g(){var r=p.apply(this,arguments)||this;r.nodesPerPage=null;r.rootIndex=0;r.lodSelectionMetricType=null;return r}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([k.property({type:Number})],d.I3SNodePageDefinition.prototype,"nodesPerPage",void 0);a.__decorate([k.property({type:Number})],d.I3SNodePageDefinition.prototype,"rootIndex",void 0);a.__decorate([k.property({type:String})],d.I3SNodePageDefinition.prototype,
"lodSelectionMetricType",void 0);d.I3SNodePageDefinition=a.__decorate([u.subclass("esri.layer.support.I3SNodePageDefinition")],d.I3SNodePageDefinition);d.I3SMaterialTexture=function(p){function g(){var r=p.apply(this,arguments)||this;r.factor=1;return r}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([k.property({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],d.I3SMaterialTexture.prototype,"id",void 0);a.__decorate([k.property({type:Number})],d.I3SMaterialTexture.prototype,
"factor",void 0);d.I3SMaterialTexture=a.__decorate([u.subclass("esri.layer.support.I3SMaterialTexture")],d.I3SMaterialTexture);d.I3SMaterialPBRMetallicRoughness=function(p){function g(){var r=p.apply(this,arguments)||this;r.baseColorFactor=[1,1,1,1];r.baseColorTexture=null;r.metallicRoughnessTexture=null;r.metallicFactor=1;r.roughnessFactor=1;return r}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([k.property({type:[Number]})],d.I3SMaterialPBRMetallicRoughness.prototype,"baseColorFactor",
void 0);a.__decorate([k.property({type:d.I3SMaterialTexture})],d.I3SMaterialPBRMetallicRoughness.prototype,"baseColorTexture",void 0);a.__decorate([k.property({type:d.I3SMaterialTexture})],d.I3SMaterialPBRMetallicRoughness.prototype,"metallicRoughnessTexture",void 0);a.__decorate([k.property({type:Number})],d.I3SMaterialPBRMetallicRoughness.prototype,"metallicFactor",void 0);a.__decorate([k.property({type:Number})],d.I3SMaterialPBRMetallicRoughness.prototype,"roughnessFactor",void 0);d.I3SMaterialPBRMetallicRoughness=
a.__decorate([u.subclass("esri.layer.support.I3SMaterialPBRMetallicRoughness")],d.I3SMaterialPBRMetallicRoughness);d.I3SMaterialDefinition=function(p){function g(){var r=p.apply(this,arguments)||this;r.alphaMode="opaque";r.alphaCutoff=.25;r.doubleSided=!1;r.cullFace="none";r.normalTexture=null;r.occlusionTexture=null;r.emissiveTexture=null;r.emissiveFactor=null;r.pbrMetallicRoughness=null;return r}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([x.enumeration({opaque:"opaque",mask:"mask",
blend:"blend"})],d.I3SMaterialDefinition.prototype,"alphaMode",void 0);a.__decorate([k.property({type:Number})],d.I3SMaterialDefinition.prototype,"alphaCutoff",void 0);a.__decorate([k.property({type:Boolean})],d.I3SMaterialDefinition.prototype,"doubleSided",void 0);a.__decorate([x.enumeration({none:"none",back:"back",front:"front"})],d.I3SMaterialDefinition.prototype,"cullFace",void 0);a.__decorate([k.property({type:d.I3SMaterialTexture})],d.I3SMaterialDefinition.prototype,"normalTexture",void 0);
a.__decorate([k.property({type:d.I3SMaterialTexture})],d.I3SMaterialDefinition.prototype,"occlusionTexture",void 0);a.__decorate([k.property({type:d.I3SMaterialTexture})],d.I3SMaterialDefinition.prototype,"emissiveTexture",void 0);a.__decorate([k.property({type:[Number]})],d.I3SMaterialDefinition.prototype,"emissiveFactor",void 0);a.__decorate([k.property({type:d.I3SMaterialPBRMetallicRoughness})],d.I3SMaterialDefinition.prototype,"pbrMetallicRoughness",void 0);d.I3SMaterialDefinition=a.__decorate([u.subclass("esri.layer.support.I3SMaterialDefinition")],
d.I3SMaterialDefinition);d.I3STextureFormat=function(p){function g(){return p.apply(this,arguments)||this}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([k.property({type:String,json:{read:{source:["name","index"],reader:(p,g)=>null!=p?p:`${g.index}`}}})],d.I3STextureFormat.prototype,"name",void 0);a.__decorate([x.enumeration({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],d.I3STextureFormat.prototype,"format",void 0);d.I3STextureFormat=a.__decorate([u.subclass("esri.layer.support.I3STextureFormat")],
d.I3STextureFormat);d.I3STextureSetDefinition=function(p){function g(){var r=p.apply(this,arguments)||this;r.atlas=!1;return r}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([k.property({type:[d.I3STextureFormat]})],d.I3STextureSetDefinition.prototype,"formats",void 0);a.__decorate([k.property({type:Boolean})],d.I3STextureSetDefinition.prototype,"atlas",void 0);d.I3STextureSetDefinition=a.__decorate([u.subclass("esri.layer.support.I3STextureSetDefinition")],d.I3STextureSetDefinition);
d.I3SGeometryAttribute=function(p){function g(){return p.apply(this,arguments)||this}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([x.enumeration({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],d.I3SGeometryAttribute.prototype,"type",void 0);a.__decorate([k.property({type:Number})],d.I3SGeometryAttribute.prototype,"component",void 0);d.I3SGeometryAttribute=a.__decorate([u.subclass("esri.layer.support.I3SGeometryAttribute")],d.I3SGeometryAttribute);
d.I3SGeometryCompressedAttributes=function(p){function g(){return p.apply(this,arguments)||this}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([x.enumeration({draco:"draco"})],d.I3SGeometryCompressedAttributes.prototype,"encoding",void 0);a.__decorate([k.property({type:[String]})],d.I3SGeometryCompressedAttributes.prototype,"attributes",void 0);d.I3SGeometryCompressedAttributes=a.__decorate([u.subclass("esri.layer.support.I3SGeometryCompressedAttributes")],d.I3SGeometryCompressedAttributes);
d.I3SGeometryBuffer=function(p){function g(){var r=p.apply(this,arguments)||this;r.offset=0;return r}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([k.property({type:Number})],d.I3SGeometryBuffer.prototype,"offset",void 0);a.__decorate([k.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"position",void 0);a.__decorate([k.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"normal",void 0);a.__decorate([k.property({type:d.I3SGeometryAttribute})],
d.I3SGeometryBuffer.prototype,"uv0",void 0);a.__decorate([k.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"color",void 0);a.__decorate([k.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"uvRegion",void 0);a.__decorate([k.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"featureId",void 0);a.__decorate([k.property({type:d.I3SGeometryAttribute})],d.I3SGeometryBuffer.prototype,"faceRange",void 0);a.__decorate([k.property({type:d.I3SGeometryCompressedAttributes})],
d.I3SGeometryBuffer.prototype,"compressedAttributes",void 0);d.I3SGeometryBuffer=a.__decorate([u.subclass("esri.layer.support.I3SGeometryBuffer")],d.I3SGeometryBuffer);d.I3SGeometryDefinition=function(p){function g(){return p.apply(this,arguments)||this}b._inheritsLoose(g,p);return g}(t.JSONSupport);a.__decorate([x.enumeration({triangle:"triangle"})],d.I3SGeometryDefinition.prototype,"topology",void 0);a.__decorate([k.property()],d.I3SGeometryDefinition.prototype,"geometryBuffers",void 0);d.I3SGeometryDefinition=
a.__decorate([u.subclass("esri.layer.support.I3SGeometryDefinition")],d.I3SGeometryDefinition);Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/RangeInfo":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,b,a,t,k,S,J,N,x){d.RangeInfo=function(u){function p(){var g=u.apply(this,arguments)||this;g.name=null;g.field=null;g.currentRangeExtent=null;g.fullRangeExtent=null;g.type="rangeInfo";return g}b._inheritsLoose(p,u);return p}(t.JSONSupport);a.__decorate([k.property({type:String,json:{read:!0,write:!0}})],d.RangeInfo.prototype,"name",void 0);a.__decorate([k.property({type:String,json:{read:!0,write:!0}})],d.RangeInfo.prototype,"field",void 0);a.__decorate([k.property({type:[Number],json:{read:!0,
write:!0}})],d.RangeInfo.prototype,"currentRangeExtent",void 0);a.__decorate([k.property({type:[Number],json:{read:!0,write:!0}})],d.RangeInfo.prototype,"fullRangeExtent",void 0);a.__decorate([k.property({type:["rangeInfo"],readOnly:!0,json:{read:!1,write:!0}})],d.RangeInfo.prototype,"type",void 0);d.RangeInfo=a.__decorate([x.subclass("esri.layers.support.RangeInfo")],d.RangeInfo);Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/SceneFilter":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Handles ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/persistable ./PolygonCollection ../../chunks/persistableUrlUtils".split(" "),
function(d,b,a,t,k,S,J,N,x,u,p,g,r,w,E){var K;k=K=function(L){function m(f){f=L.call(this,f)||this;f.spatialRelationship="disjoint";f.geometries=new w;f._geometriesSource=null;f._handles=new t;return f}d._inheritsLoose(m,L);var F=m.prototype;F.initialize=function(){this._handles.add(N.on(()=>this.geometries,"after-changes",()=>this.geometries=this.geometries,N.sync))};F.destroy=function(){this._handles.destroy()};F.readGeometries=function(f,z,B){this._geometriesSource={url:E.fromJSON(f,B),context:B}};
F.loadGeometries=function(){var f=d._asyncToGenerator(function*(z,B){if(!J.isNone(this._geometriesSource)){var {url:O,context:I}=this._geometriesSource;B=yield a(O,{responseType:"json",signal:J.get(B,"signal")});var G=z.toJSON();z=B.data.map(e=>({...e,spatialReference:G}));this.geometries=w.fromJSON(z,I);this._geometriesSource=null}});return function(z,B){return f.apply(this,arguments)}}();F.clone=function(){return new K({geometries:S.clone(this.geometries),spatialRelationship:this.spatialRelationship})};
return m}(k.JSONSupport);b.__decorate([x.property({type:["disjoint","contains"],nonNullable:!0,json:{write:!0}})],k.prototype,"spatialRelationship",void 0);b.__decorate([x.property({type:w,nonNullable:!0,json:{write:!0}}),r.persistable({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries"})],k.prototype,"geometries",void 0);b.__decorate([p.reader(["web-scene","portal-item"],"geometries")],k.prototype,"readGeometries",null);return k=K=b.__decorate([g.subclass("esri.layers.support.SceneFilter")],
k)})},"esri/core/accessorSupport/decorators/persistable":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../maybe ../../multiOriginJSONSupportUtils ../../urlUtils ../../uuid ../metadata ../PropertyOrigin ./property ../../../portal/support/resourceExtension ../../../chunks/persistableUrlUtils".split(" "),function(d,b,a,t,k,S,J,N,x,u,p,g){function r(F,f,z){const B=N.getOwnPropertyMetadata(f,z);return{type:String,read:(O,I,G)=>{O=g.read(O,I,G);if(B.type===String)return O;
if("function"===typeof B.type)return new B.type({url:O})},write:{writer(O,I,G,e){if(e&&e.resources){var y=t.isNone(O)?null:"string"===typeof O?O:O.url;y=y?g.toJSON(y,{...e,verifyItemRelativeUrls:e&&e.verifyItemRelativeUrls?{writtenUrls:e.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},g.MarkKeep.NO):null;var l=B.type!==String&&(!k.isMultiOriginJSONMixin(this)||e&&e.origin&&this.originIdOf(z)>x.nameToId(e.origin));if(e&&e.portalItem&&t.isSome(y)&&!S.isAbsolute(y))if(l){{l=e.portalItem.resourceFromPath(y);
const M=K(O,y,e),aa=p.getResourceContentExtension(M),A=S.getPathExtension(l.path);aa!==A?w(this,z,O,y,I,G,e,F):(E(this,z,l,M,e.resources.toUpdate),I[G]=y)}}else e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(y)}),I[G]=y;else e&&e.portalItem&&(t.isNone(y)||t.isSome(g.itemIdFromResourceUrl(y))||S.isBlobProtocol(y)||l)?w(this,z,O,y,I,G,e,F):I[G]=y}else I[G]="string"===typeof O?g.toJSON(O,e):O.write({},e)}}}}function w(F,f,z,B,O,I,G,e){const y=J.generateUUID();z=K(z,B,G);const l=S.join(t.get(e,
"prefix"),y);e=`${l}.${p.getResourceContentExtension(z)}`;const M=G.portalItem.resourceFromPath(e);S.isBlobProtocol(B)&&G.resources.pendingOperations.push(L(B).then(aa=>{M.path=`${l}.${p.getResourceContentExtension(aa)}`;O[I]=M.itemRelativeUrl}).catch(()=>{}));E(F,f,M,z,G.resources.toAdd);O[I]=M.itemRelativeUrl}function E(F,f,z,B,O){O.push({resource:z,content:B,finish:I=>{"string"===typeof F[f]?F[f]=I.url:F[f].url=I.url}})}function K(F,f,z){return"string"===typeof F?{url:f}:new Blob([JSON.stringify(F.toJSON(z))],
{type:"application/json"})}function L(F){return m.apply(this,arguments)}function m(){m=a._asyncToGenerator(function*(F){const f=(yield new Promise((z,B)=>d(["../../../request"],O=>z(Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"}))),B))).default;({data:F}=yield f(F,{responseType:"blob"}));return F});return m.apply(this,arguments)}b.persistable=function(F){const f=t.isSome(F)&&F.origins?F.origins:[void 0];return(z,B)=>{a:if(t.isSome(F)&&"resource"===
F.type)var O=r(F,z,B);else{switch(t.isSome(F)&&F.type?F.type:"other"){case "other":O={read:!0,write:!0};break a;case "url":{const {read:I,write:G}=g.persistableUrlUtils;O={read:I,write:G};break a}}O=void 0}for(const I of f){const G=u.propertyJSONMeta(z,I,B);for(const e in O)G[e]=O[e]}}};Object.defineProperties(b,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/portal/support/resourceExtension":function(){define(["exports","../../core/urlUtils"],function(d,b){const a={},t=a["text/plain"],
k={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(const S in k)a[k[S]]=S;d.getResourceContentExtension=function(S){S instanceof Blob?S=S.type:(S=b.getPathExtension(S.url),S=k[S]||"text/plain");return a[S]||t};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/layers/support/PolygonCollection":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/JSONSupport ../../core/Warning ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/set ../../core/accessorSupport/decorators/subclass ../../geometry/Polygon ../../geometry/projection".split(" "),function(d,b,a,t,k,S,J,N,x,u,p,g,r){var w;a=w=function(E){function K(m){return E.call(this,
m)||this}d._inheritsLoose(K,E);var L=K.prototype;L.clone=function(){return new w(this.items.map(m=>m.clone()))};L.write=function(m,F){return this.toJSON(F)};L.toJSON=function(m){var F;const f=null==m?void 0:null==(F=m.layer)?void 0:F.spatialReference;return f?this.toArray().map(z=>{if(!f.equals(z.spatialReference)){if(!r.canProjectWithoutEngine(z.spatialReference,f))return m&&m.messages&&m.messages.push(new k("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",
{modification:this,spatialReference:m.layer.spatialReference,context:m})),null;const B=new g;r.projectPolygon(z,B,f);z=B}z=z.toJSON(m);delete z.spatialReference;return z}).filter(z=>null!=z):(null!=m&&m.messages&&m.messages.push(new k("scenefilter:unsupported","Writing Scene filters without context layer is not supported",{modification:this,spatialReference:m.layer.spatialReference,context:m})),this.toArray().map(z=>z.toJSON(m)))};K.fromJSON=function(m,F){const f=new w;m.forEach(z=>f.add(g.fromJSON(z,
F)));return f};return K}(t.JSONSupportMixin(a.ofType(g)));return a=w=b.__decorate([p.subclass("esri.layers.support.PolygonCollection")],a)})},"widgets/Search/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/promise/all jimu/portalUtils jimu/utils esri/request".split(" "),function(d,b,a,t,k,S,J,N){return{map:null,layerInfosObj:null,appConfig:null,_esriLocatorRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,setMap:function(x){this.map=
x},setLayerInfosObj:function(x){this.layerInfosObj=x},setAppConfig:function(x){this.appConfig=x},getConfigInfo:function(x){if(x&&x.sources&&0<x.sources.length){var u=null;return this.searchLayer(this.map)&&x.upgradeFromGeocoder?(u=this.map.itemInfo.itemData.applicationProperties.viewing.search,u=b.map(u.layers,d.hitch(this,function(p,g){g.hintText=p;return this._getQueryTypeGeocoder(g)},u.hintText)),k(u).then(d.hitch(this,function(p){x.sources=[].concat(p).concat(x.sources);return x}))):x}return t(this._getSoucesFromPortalAndWebmap()).then(d.hitch(this,
function(p){return{allPlaceholder:"",showInfoWindowOnSelect:!0,sources:p}}))},_getSoucesFromPortalAndWebmap:function(){var x=[],u=null;this.searchLayer(this.map)&&(u=this.map.itemInfo.itemData.applicationProperties.viewing.search,b.forEach(u.layers,d.hitch(this,function(p,g){g.hintText=p;x.push(this._getQueryTypeGeocoder(g))},u.hintText)));return S.getPortalSelfInfo(this.appConfig.portalUrl).then(d.hitch(this,function(p){if((p=p.helperServices&&p.helperServices.geocode)&&0<p.length)for(var g=0,r=
p.length;g<r;g++){var w=p[g];w&&x.push(this._processSingleLine(w))}return k(x).then(d.hitch(this,function(E){for(var K=[],L=0;L<E.length;L++){var m=E[L];m&&(m&&"query"===m.type?K.push(m):(m={name:m.name||this._getGeocodeName(m.url),url:m.url,singleLineFieldName:m.singleLineFieldName,placeholder:m.placeholder||window.jimuNls.common.findAddressOrPlace||m.name||this._getGeocodeName(m.url),maxResults:6,searchInCurrentMapExtent:!1,type:"locator"},K.push(m)))}return K}))}))},_getQueryTypeGeocoder:function(x){var u=
this.map.findLayerById(x.id),p=null,g=null;g=x.id;p=null;u&&u.allSublayers&&(p=u.allSublayers.find(function(r){return r.id===x.subLayer}));return u?(p="scene"===u.type?u.url+"/layers/"+u.layerId:p?p.url||u.url+"/"+x.subLayer:u.url+"/"+u.layerId,{name:u.title,layerId:g,url:p,placeholder:x.hintText||window.jimuNls.common.findAddressOrPlace,searchFields:[x.field.name],displayField:x.field.name,exactMatch:x.field.exactMatch||!1,maxResults:6,searchInCurrentMapExtent:!1,type:"query"}):null},_isEsriLocator:function(x){this._esriLocatorRegExp.lastIndex=
0;return this._esriLocatorRegExp.test(x)},_processSingleLine:function(x){if(x.singleLineFieldName)return x;if(this._isEsriLocator(x.url))return x.singleLineFieldName="SingleLine",x;var u=new a;N(x.url,{query:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(d.hitch(this,function(p){p.singleLineAddressField&&p.singleLineAddressField.name?(x.singleLineFieldName=p.singleLineAddressField.name,u.resolve(x)):(console.warn(x.url+"has no singleLineFieldName"),u.resolve(null))}),d.hitch(this,
function(p){console.error(p);u.resolve(null)}));return u.promise},_getGeocodeName:function(x){if("string"!==typeof x)return"geocoder";x=x.split("/");return x[x.length-2]||"geocoder"},getGeocoderName:function(x){return this._getGeocodeName(x)},hasAppSearchInfo:function(x){return x.itemInfo&&x.itemInfo.itemData&&x.itemInfo.itemData.applicationProperties&&x.itemInfo.itemData.applicationProperties.viewing&&x.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(x){if(!x||!this.hasAppSearchInfo(x))return!1;
x=x.itemInfo.itemData.applicationProperties.viewing.search;return x.enabled&&0!==x.layers.length?!0:!1}}})},"widgets/Search/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Search/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchNode" class\x3d"search-node"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchResultsNode" class\x3d"searchResults arcgisSearch esri-search"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Search/css/style.css":".jimu-widget-search{min-height: 32px;}.jimu-widget-search .search-node.default-width-for-openAtStart{width: 300px;}.jimu-widget-search .esri-search__container{border: 1px solid #57585A;}.jimu-widget-search .result-item-selected{background: #eee;}.jimu-widget-search .esri-search .esri-search-button:hover,.jimu-widget-search .esri-search .esri-search-button:focus {background-color: #485566; color: white;}.jimu-widget-search .esri-search .show-all-results{position: absolute; height: 25px; color: #686868; line-height: 25px; display: none; width: 237px; margin: auto; background-color: #fff; padding: 0 12px; cursor: pointer;}.jimu-widget-search .searchResults .esri-menu{border-radius: 0; color: #686868; font-size: 12px; padding: 0; top: 33px; visibility: visible;}.jimu-widget-search .searchMenu {position: absolute; top: 100%; left: 0; z-index: 1000; display: none; float: left; padding: 5px 0; margin: 2px 0 0; font-size: 14px; line-height: 16px; background-color: #fff; -webkit-background-clip: padding-box; background-clip: padding-box; border: 1px solid #57585A; -webkit-border-radius: 4px; border-radius: 4px; overflow: auto; max-height: 300px;}.jimu-widget-search .searchMenu ul {margin: 0; padding: 0; list-style: none;}.jimu-widget-search .esri-search .esri-menu li.active{background-color: #d9dde0; color: #686868; font-size: 14px;}.jimu-widget-search .esri-search .esri-menu li{padding: 0 12px; line-height: 25px; cursor: pointer;}.jimu-widget-search .esri-search .esri-menu li:hover,.jimu-widget-search .esri-search .esri-menu li:focus {background-color: #eee;}.jimu-widget-search .esri-search .esri-menu .menu-header{background-color: #d9dde0; color: #686868; font-size: 14px; min-height: 30px; padding: 0 12px; line-height: 30px;}",
"*now":function(d){d(['dojo/i18n!*preload*widgets/Search/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/when dojo/on dojo/query dojo/keys dojo/Deferred dojo/promise/all jimu/BaseWidget jimu/utils esri/widgets/Search esri/widgets/Search/SearchViewModel esri/rest/support/Query esri/layers/FeatureLayer esri/layers/SceneLayer esri/symbols/PictureMarkerSymbol esri/PopupTemplate ./utils dojo/NodeList-dom".split(" "),function(d,b,a,t,k,S,J,N,x,u,p,g,r,w,E,K,L,m,F,f){return d([p],{name:"Search",baseClass:"jimu-widget-search",searchDijit:null,
searchResults:null,_highlightedFeatureHandle:null,postCreate:function(){this.listenWidgetIds.push("framework")},startup:function(){this.inherited(arguments);this.config&&this.config.sources||(this.config.sources=[]);f.setMap(this.sceneView.map);f.setAppConfig(this.appConfig);k(f.getConfigInfo(this.config)).then(b.hitch(this,function(z){return u(this._convertConfig(z)).then(function(B){return a.filter(B,function(O){return O})})})).then(b.hitch(this,function(z){this.domNode&&(z=new w({activeSourceIndex:1===
z.length?0:-1,allPlaceholder:g.stripHTML(this.config.allPlaceholder?this.config.allPlaceholder:window.jimuNls.common.findAddressOrPlace),autoSelect:!0,buttonModeEnabled:!1,labelEnabled:!1,popupEnabled:g.isDefined(this.config.showInfoWindowOnSelect)?!!this.config.showInfoWindowOnSelect:!0,view:this.sceneView,sources:z,theme:"arcgisSearch"}),this.searchDijit=new r({viewModel:z,includeDefaultSources:!1,container:this.searchNode}),this._resetSearchDijitStyle(),this.own(this.searchDijit.viewModel.watch("activeSourceIndex",
b.hitch(this,"_onSourceIndexChange"))),this.own(S(this.searchDijit.viewModel,"select-result",b.hitch(this,"_onSelectResult"))),this.own(S(this.searchDijit.domNode,"click",b.hitch(this,"_onSearchDijitClick"))),this.own(S(this.searchDijit,"suggest-complete",b.hitch(this,"_onSuggestResults"))),this.own(S(this.searchDijit._inputNode,"keyup",b.hitch(this,function(B){B.keyCode!==N.ENTER&&this._onClearSearch()}))),this.own(S(this.searchDijit.viewModel,"search-clear",b.hitch(this,"_onClearSearch"))),this.fetchData("framework"))}))},
_convertConfig:function(z){return a.map(z.sources,b.hitch(this,function(B){var O=new x;if(B&&B.url&&"locator"===B.type)O.resolve({url:B.url||"",outFields:["*"],singleLineFieldName:B.singleLineFieldName||"",name:g.stripHTML(B.name||""),placeholder:g.stripHTML(B.placeholder||""),highlightSymbol:new m({url:this.folderUrl+"css/images/search-pointer.png",size:36,width:36,height:36,xoffset:9,yoffset:18}),countryCode:B.countryCode||"",maxSuggestions:B.maxSuggestions||6,maxResults:B.maxResults||6,zoomScale:B.zoomScale||
5E4,withinViewEnabled:!!B.searchInCurrentMapExtent});else if(B&&B.url&&"query"===B.type){var I=this._getLayerViewByLayerId(B.layerId);var G=/\/sceneserver\//gi.test(B.url)?new L({url:B.url||null,outFields:["*"]}):new K({url:B.url||null,outFields:["*"]});G.load().then(b.hitch(this,function(){var e=this._getInfoTemplate(G,B,B.displayField),y=null;B.searchFields&&0<B.searchFields.length?y=B.searchFields:(y=[],a.forEach(G.fields,function(l){"esriFieldTypeOID"!==l.type&&l.name!==G.objectIdField&&"esriFieldTypeGeometry"!==
l.type&&y.push(l.name)}));e={layer:G,outFields:["*"],searchFields:y,displayField:B.displayField||"",exactMatch:!!B.exactMatch,name:g.stripHTML(B.name||""),placeholder:g.stripHTML(B.placeholder||""),maxSuggestions:B.maxSuggestions||6,maxResults:B.maxResults||6,popupTemplate:e||null,zoomScale:B.zoomScale||5E4,withinViewEnabled:!!B.searchInCurrentMapExtent,featureLayerId:B.layerId,featurelayerGeometryType:G.geometryType};I&&(e.resultGraphicEnabled=!1);"scene"===G.type&&(e.autoNavigate=!1);O.resolve(e)}),
b.hitch(this,function(){O.resolve(null)}))}else O.resolve(null);return O}))},_getInfoTemplate:function(z,B){var O,I=[];a.filter(z.fields,function(G){var e=G.name.toLowerCase();0>e.indexOf("shape")&&0>e.indexOf("objectid")&&0>e.indexOf("perimeter")&&I.push(G.name)});(z=g.getDefaultPopupInfo(z,B.name+": {"+B.displayField+"}",I))&&(O=new F({title:z.title,content:[{type:"fields",fieldInfos:z.fieldInfos}]}));return O},destroy:function(){f.setAppConfig(null);var z=this.sceneView.popup.viewModel;z&&(z.visible=
!1);this.searchDijit&&this.searchDijit.viewModel&&(this.searchDijit.viewModel.set("view",null),this.searchDijit.viewModel.clear());this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove();this.inherited(arguments)},_getLayerViewByLayerId:function(z){return this.sceneView.layerViews.find(b.hitch(this,function(B){return B.layer.id===z}))},_onSelectResult:function(z){var B=z.result;if(B&&B.name){B=z.result.feature;var O=this._getLayerViewByLayerId(z.source.featureLayerId);if(O){var I=
new E;I.where=O.layer.objectIdField+" \x3d "+B.attributes[O.layer.objectIdField];I.outFields=["*"];I.returnGeometry=!0;I.maxAllowableOffset=0;I.outSpatialReference=this.sceneView.spatialReference;O.layer.queryFeatures(I).then(b.hitch(this,function(G){if(G=G.features[0])this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove(),this._highlightedFeatureHandle=O.highlight(G),"scene"===O.layer.type&&this.sceneView.goTo(G)}))}"point"===z.source.featurelayerGeometryType&&z.source.zoomScale&&
this.sceneView.goTo({scale:z.source.zoomScale})}},_onSearchComplete:function(){},onReceiveData:function(z,B,O){"framework"===z&&"framework"===B&&O&&O.searchString&&(this.searchDijit.viewModel.set("value",O.searchString),this.searchDijit.viewModel.search())},setPosition:function(){this._resetSearchDijitStyle();this.inherited(arguments)},resize:function(){this._resetSearchDijitStyle()},_onSourceIndexChange:function(){this.searchDijit.viewModel.value&&this.searchDijit.viewModel.search(this.searchDijit.viewModel.value)},
_onSuggestResults:function(){var z=0;setTimeout(b.hitch(this,function(){var B=J(".esri-search__suggestions-menu",this.domNode)[0];10<=z++||(B?this._resetSelectorPosition(".esri-search__suggestions-menu"):setTimeout(b.hitch(this,arguments.callee),10))}),10)},_onClearSearch:function(){t.setStyle(this.searchResultsNode,"display","none");this.searchResultsNode.innerHTML="";this.searchResults=null;this.sceneView.popup.close();this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove()},_onSearchDijitClick:function(){this._resetSelectorPosition(".esri-search__sources-menu");
this._onSuggestResults()},_resetSelectorPosition:function(z){var B=t.getMarginBox(window.jimuConfig.layoutId);J(z,this.domNode).forEach(b.hitch(this,function(O){var I=t.position(O);if("none"!==t.getStyle(O,"display")&&"hidden"!==t.getStyle(O,"visibility")){var G=t.position(this.searchDijit.domNode),e=G.y-2,y=B.h-G.y-G.h;y>I.y+I.h||e>I.h?t.setStyle(O,"top",(y>I.y+I.h?G.h:-I.h-2)+"px"):(t.setStyle(O,"height",Math.max(y,e)+"px"),t.setStyle(O,"top",(y>e?G.h:-e-2)+"px"))}}))},_onSelectSearchResult:function(z){for(z=
z.target;!t.hasAttr(z,"data-source-index")||!t.getAttr(z,"data-index");)z=z.parentNode;var B=null;B=t.getAttr(z,"data-source-index");z=parseInt(t.getAttr(z,"data-index"),10);"all"!==B&&(B=parseInt(B,10));this.searchResults&&this.searchResults[B]&&this.searchResults[B][z]&&(B=this.searchResults[B][z],this.searchDijit.viewModel.select(B))},_hideResultMenu:function(){J(".show-all-results",this.searchResultsNode).style("display","block");J(".searchMenu",this.searchResultsNode).style("display","none")},
_showResultMenu:function(){t.setStyle(this.searchResultsNode,"display","block");J(".show-all-results",this.searchResultsNode).style("display","none");J(".searchMenu",this.searchResultsNode).style("display","block");var z=J(".esri-input-container",this.searchDijit.domNode)[0];if(z){z=t.getMarginBox(z);var B={width:z.w+"px"};if(window.isRTL){var O=t.getMarginBox(this.searchDijit.domNode);B.right=O.w-z.l-z.w+"px"}else B.left=z.l+"px";J(".show-all-results",this.searchResultsNode).style(B);J(".searchMenu",
this.searchResultsNode).style(B)}},_resetSearchDijitStyle:function(){}})});