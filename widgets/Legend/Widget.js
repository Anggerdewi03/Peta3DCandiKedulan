// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Handles ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S,Q,n,A,m,L,K){N=function(E){function k(h,x){h=E.call(this,h,x)||this;h._handles=new z;h.activeLayerInfos=null;h.basemapLegendVisible=!1;h.groundLegendVisible=!1;h.headingLevel=3;h.hideLayersNotInCurrentView=!1;h.keepCacheOnDestroy=!1;h.respectLayerVisibility=!0;h.iconClass="esri-icon-layer-list";h.label=void 0;h.layerInfos=null;h.messages=null;h.style=new A;h.view=null;h.viewModel=new Q;return h}M._inheritsLoose(k,E);var d=k.prototype;d.initialize=function(){this.own([y.on(()=>
this.view,"resize",()=>this.scheduleRender()),y.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),y.watch(()=>this.headingLevel,h=>{const {style:x}=this;x&&(x.headingLevel=h)}),y.watch(()=>this.style,(h,x)=>{x&&h!==x&&x.destroy();h&&(h.activeLayerInfos=this.activeLayerInfos,"card"===h.type&&(h.view=this.view),h.headingLevel=this.headingLevel)},y.initial)])};d.destroy=function(){this._handles=V.destroyMaybe(this._handles)};d.castStyle=function(h){if(h instanceof
n||h instanceof A)return h;if("string"===typeof h)return"card"===h?new n:new A;if(h&&"string"===typeof h.type){const x={...h};delete x.type;return new ("card"===h.type?n:A)(x)}return new A};d.render=function(){return K.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof A?"esri-widget--panel":null)},this.style.render())};d._refreshActiveLayerInfos=function(h){this._handles.removeAll();h.forEach(x=>this._renderOnActiveLayerInfoChange(x));this.scheduleRender()};d._renderOnActiveLayerInfoChange=
function(h){var x=y.watch(()=>h.version,()=>this.scheduleRender());this._handles.add(x,`version_${h.layer.uid}`);x=y.on(()=>h.children,"change",()=>h.children.forEach(q=>this._renderOnActiveLayerInfoChange(q)),y.initial);this._handles.add(x,`children_${h.layer.uid}`);h.children.forEach(q=>this._renderOnActiveLayerInfoChange(q))};return k}(S);B.__decorate([da.aliasOf("viewModel.activeLayerInfos")],N.prototype,"activeLayerInfos",void 0);B.__decorate([da.aliasOf("viewModel.basemapLegendVisible")],N.prototype,
"basemapLegendVisible",void 0);B.__decorate([da.aliasOf("viewModel.groundLegendVisible")],N.prototype,"groundLegendVisible",void 0);B.__decorate([D.property()],N.prototype,"headingLevel",void 0);B.__decorate([da.aliasOf("viewModel.hideLayersNotInCurrentView")],N.prototype,"hideLayersNotInCurrentView",void 0);B.__decorate([da.aliasOf("viewModel.keepCacheOnDestroy")],N.prototype,"keepCacheOnDestroy",void 0);B.__decorate([da.aliasOf("viewModel.respectLayerVisibility")],N.prototype,"respectLayerVisibility",
void 0);B.__decorate([D.property()],N.prototype,"iconClass",void 0);B.__decorate([D.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],N.prototype,"label",void 0);B.__decorate([da.aliasOf("viewModel.layerInfos")],N.prototype,"layerInfos",void 0);B.__decorate([D.property(),L.messageBundle("esri/widgets/Legend/t9n/Legend")],N.prototype,"messages",void 0);B.__decorate([D.property()],N.prototype,"style",void 0);B.__decorate([ca.cast("style")],N.prototype,"castStyle",null);B.__decorate([da.aliasOf("viewModel.view")],
N.prototype,"view",void 0);B.__decorate([D.property()],N.prototype,"viewModel",void 0);return N=B.__decorate([F.subclass("esri.widgets.Legend")],N)})},"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S,Q,n){const A=y.ofType(Q),m="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer".split(" "),
L=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];z=function(K){function E(d){d=K.call(this,d)||this;d._handles=new da;d._layerViewByLayerId={};d._layerInfosByLayerViewId={};d._activeLayerInfosByLayerViewId={};d._activeLayerInfosWithNoParent=new y;d.activeLayerInfos=new A;d.basemapLegendVisible=!1;d.groundLegendVisible=!1;d.hideLayersNotInCurrentView=!1;d.keepCacheOnDestroy=!1;d.respectLayerVisibility=!0;d.layerInfos=[];d.view=
null;return d}M._inheritsLoose(E,K);var k=E.prototype;k.initialize=function(){this._handles.add(N.watch(()=>this.view,()=>this._viewHandles(),N.initial),"view");this._handles.add(n.onLocaleChange(()=>this._refresh()))};k.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};k._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(N.watch(()=>this.state,()=>this._stateHandles(),N.initial),"state")};k._stateHandles=function(){this._resetAll();
"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};k._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};k._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};k._destroyViewActiveLayerInfo=function(d){this._handles.remove(d);const h=this._activeLayerInfosByLayerViewId[d];delete this._activeLayerInfosByLayerViewId[d];
h&&h.parent&&h.parent.children.remove(h)};k._watchPropertiesAndAllLayerViews=function(){const {allLayerViews:d}=this.view;d.length&&this._refresh();this._handles.add(d.on("change",h=>this._allLayerViewsChangeHandle(h)),"all-layer-views");this._handles.add(N.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties")};k._allLayerViewsChangeHandle=function(d){d.removed.forEach(h=>this._destroyViewActiveLayerInfo(h.uid));this._refresh()};
k._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();this._refresh()};k._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};k._sortActiveLayerInfos=function(d){if(!(2>d.length)){var h=[];d.forEach(q=>{if(!q.parent){var C=q.layer.parent;
(C=(C=C&&"uid"in C&&this._layerViewByLayerId[C.uid])&&this._activeLayerInfosByLayerViewId[C.uid])&&d.includes(C)&&(h.push(q),q.parent=C,C.children.add(q),this._sortActiveLayerInfos(C.children))}});d.removeMany(h);var x={};this.view.allLayerViews.forEach((q,C)=>x[q.layer.uid]=C);d.sort((q,C)=>(x[C.layer.uid]||0)-(x[q.layer.uid]||0))}};k._generateLayerViews=function(){const d=[];L.filter(this._filterLayerViews,this).map(this.get,this).filter(h=>null!=h).forEach(this._collectLayerViews("layerViews",
d));return d};k._filterLayerViews=function(d){const h=!this.groundLegendVisible&&"view.groundView.layerViews"===d;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===d||"view.basemapView.referenceLayerViews"===d))&&!h};k._collectLayerViews=function(d,h){const x=q=>{q&&q.forEach(C=>{h.push(C);x(C[d])});return h};return x};k._filterLayerViewsByLayerInfos=function(d){const h=this.layerInfos;return h&&h.length?h.some(x=>this._hasLayerInfo(x,d)):!0};k._hasLayerInfo=function(d,h){const x=
this._isLayerUIDMatching(d.layer,h.layer.uid);x&&(this._layerInfosByLayerViewId[h.uid]=d);return x};k._isLayerUIDMatching=function(d,h){return d&&(d.uid===h||this._hasLayerUID(d.layers,h))};k._hasLayerUID=function(d,h){return d&&d.some(x=>this._isLayerUIDMatching(x,h))};k._isLayerViewSupported=function(d){return m.includes(d.layer.declaredClass)?(this._layerViewByLayerId[d.layer.uid]=d,!0):!1};k._generateActiveLayerInfo=function(d){this._isLayerActive(d)?this._buildActiveLayerInfo(d):(this._handles.remove(d.uid),
this._handles.add(N.watch(()=>[d.legendEnabled,d.layer.legendEnabled],()=>this._layerActiveHandle(d)),d.uid))};k._layerActiveHandle=function(d){this._isLayerActive(d)&&(this._handles.remove(d.uid),this._buildActiveLayerInfo(d))};k._isLayerActive=function(d){return this.respectLayerVisibility?d.legendEnabled&&d.get("layer.legendEnabled"):!0};k._buildActiveLayerInfo=function(d){var h;const x=d.layer,q=d.uid;var C=this._layerInfosByLayerViewId[q];let T=this._activeLayerInfosByLayerViewId[q];T||(T=new Q({layer:x,
layerView:d,title:C&&void 0!==C.title&&C.layer.uid===x.uid?C.title:x.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:C&&C.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[q]=T);C=x.parent&&"uid"in x.parent&&this._layerViewByLayerId[null==(h=x.parent)?void 0:h.uid];T.parent=this._activeLayerInfosByLayerViewId[null==C?void 0:C.uid];if(!this._handles.has(q)){h=
N.watch(()=>x.title,G=>this._titleHandle(G,T));C=N.watch(()=>[x.opacity,"renderer"in x&&x.renderer,"pointSymbol"in x&&x.pointSymbol,"lineSymbol"in x&&x.lineSymbol,"polygonSymbol"in x&&x.polygonSymbol],()=>this._constructLegendElements(T));var X=N.when(()=>{var G;return!0===(null==(G=this.view)?void 0:G.stationary)},()=>this._scaleHandle(T),N.initial);const U=N.watch(()=>d._effectiveRenderer,()=>this._constructLegendElements(T)),f=N.watch(()=>"effect"in x&&x.effect,()=>this._constructLegendElements(T));
h=[h,C,X,U,f];this.respectLayerVisibility&&(C=N.watch(()=>d.legendEnabled,G=>this._legendEnabledHandle(G,T)),X=N.watch(()=>x.legendEnabled,G=>this._legendEnabledHandle(G,T)),h.push(C,X));this._handles.add(h,q)}T.isScaleDriven||this._constructLegendElements(T);this._addActiveLayerInfo(T)};k._titleHandle=function(d,h){h.title=d;this._constructLegendElements(h)};k._legendEnabledHandle=function(d,h){d?this._addActiveLayerInfo(h):this._removeActiveLayerInfo(h)};k._scaleHandle=function(d){(d.isScaleDriven||
d.hideLayersNotInCurrentView)&&this._constructLegendElements(d)};k._addActiveLayerInfo=function(d){const {layerView:h,layer:x}=d;if(this._isLayerActive(h)&&!this.activeLayerInfos.includes(d)){var q=d.parent;if(q)q.children.includes(d)||q.children.push(d),this._sortActiveLayerInfos(q.children);else{var C;q=null==(C=this.layerInfos)?void 0:C.some(T=>T.layer.uid===x.uid);x.parent&&"uid"in x.parent&&!q?this._activeLayerInfosWithNoParent.add(d):(this.activeLayerInfos.add(d),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const T=
[];this._activeLayerInfosWithNoParent.forEach(X=>{var U=X.layer.parent;U=U&&"uid"in U&&this._layerViewByLayerId[null==U?void 0:U.uid];if(U=this._activeLayerInfosByLayerViewId[null==U?void 0:U.uid])T.push(X),X.parent=U});T.length&&(this._activeLayerInfosWithNoParent.removeMany(T),T.forEach(X=>this._addActiveLayerInfo(X)))}}};k._removeActiveLayerInfo=function(d){const h=d.parent;h?h.children.remove(d):this.activeLayerInfos.remove(d)};k._constructLegendElements=function(d){var h;const x=d.layer;"featureCollections"in
x&&x.featureCollections?d.buildLegendElementsForFeatureCollections(x.featureCollections):"featureReduction"in x&&"binning"===(null==(h=x.featureReduction)?void 0:h.type)&&"renderer"in x.featureReduction?d.buildLegendElementsForRenderer(x.featureReduction.renderer):"renderer"in x&&x.renderer?d.buildLegendElementsForRenderer(x.renderer):"url"in x&&x.url?d.buildLegendElementsForTools():d.children.forEach(q=>this._constructLegendElements(q))};M._createClass(E,[{key:"state",get:function(){return this.get("view.ready")?
"ready":"disabled"}}]);return E}(V);B.__decorate([u.property({type:A})],z.prototype,"activeLayerInfos",void 0);B.__decorate([u.property()],z.prototype,"basemapLegendVisible",void 0);B.__decorate([u.property()],z.prototype,"groundLegendVisible",void 0);B.__decorate([u.property()],z.prototype,"hideLayersNotInCurrentView",void 0);B.__decorate([u.property()],z.prototype,"keepCacheOnDestroy",void 0);B.__decorate([u.property()],z.prototype,"respectLayerVisibility",void 0);B.__decorate([u.property()],z.prototype,
"layerInfos",void 0);B.__decorate([u.property({readOnly:!0})],z.prototype,"state",null);B.__decorate([u.property()],z.prototype,"view",void 0);return z=B.__decorate([S.subclass("esri.widgets.Legend.LegendViewModel")],z)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/Collection ../../../core/Handles ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S,Q,n,A,m,L,K,E,k,d,h,x,q,C,T,X,U,f,G,O,w,W,p,v,I,H,Y,la,va,ja,e,l,P){function ba(oa){return"esri.renderers.SimpleRenderer"===oa.declaredClass}function ka(oa){return"esri.renderers.ClassBreaksRenderer"===oa.declaredClass}function xa(oa){return"esri.renderers.UniqueValueRenderer"===oa.declaredClass}function ya(oa){return"esri.renderers.HeatmapRenderer"===oa.declaredClass}function ua(oa){return"esri.renderers.PointCloudClassBreaksRenderer"===oa.declaredClass}function za(oa){return"esri.renderers.PointCloudStretchRenderer"===
oa.declaredClass}function Z(oa){return"esri.renderers.PointCloudUniqueValueRenderer"===oa.declaredClass}function wa(oa){return"esri.renderers.DotDensityRenderer"===oa.declaredClass}function ha(oa){return"esri.renderers.PieChartRenderer"===oa.declaredClass}function na(oa){return"esri.layers.BuildingSceneLayer"===oa.declaredClass}function sa(oa){oa="authoringInfo"in oa&&(null==oa?void 0:oa.authoringInfo);return"univariate-color-size"===(null==oa?void 0:oa.type)}function Ba(oa){oa="authoringInfo"in oa&&
(null==oa?void 0:oa.authoringInfo);return"univariate-color-size"===(null==oa?void 0:oa.type)&&"above-and-below"===(null==oa?void 0:oa.univariateTheme)}const ta=S.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),Ea=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Ga=new F.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Ka={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],
u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},Ia=new l({size:6,outline:{color:[128,128,128,.5],width:.5}}),Oa=new P({style:"solid"}),Pa=new l({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ha={};N=function(oa){function Ja(b){b=oa.call(this,b)||this;b._handles=new D;b._hasColorRamp=!1;b._hasOpacityRamp=!1;b._hasSizeRamp=!1;b._webStyleSymbolCache=new Map;
b._dotDensityUrlCache=new Map;b._scaleDrivenSizeVariable=null;b._hasClusterSizeVariable=!1;b.children=new ca;b.layerView=null;b.layer=null;b.legendElements=[];b.parent=null;b.hideLayersNotInCurrentView=!1;b.keepCacheOnDestroy=!1;b.respectLayerVisibility=!0;b.sublayerIds=[];b.title=null;b.view=null;return b}B._inheritsLoose(Ja,oa);var ea=Ja.prototype;ea.initialize=function(){const b=()=>this.notifyChange("ready");this._handles.add([A.on(()=>this.children,"change",a=>{const {added:c,removed:g}=a,r=
this._handles;c.forEach(t=>{const J=`activeLayerInfo-ready-watcher-${t.layer.uid}`;r.add(A.watch(()=>t.ready,b,A.initial),J)});g.forEach(t=>r.remove(t.layer.uid));b()})]);this.keepCacheOnDestroy||(Ha={})};ea.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(Ha=null)};ea.buildLegendElementsForFeatureCollections=function(){var b=B._asyncToGenerator(function*(a){if(this.hideLayersNotInCurrentView&&
!(yield this._isLayerInCurrentView()))this.legendElements=[],this.notifyChange("ready");else{a=Array.from(a,c=>{if("esri.layers.FeatureLayer"===c.declaredClass)return this._getRendererLegendElements(c.renderer,{title:c.title});if(c.featureSet&&c.featureSet.features.length){var g=c.layerDefinition,r=g&&g.drawingInfo;r=r&&U.fromJSON(r.renderer);g=Ga.read(g.geometryType);return r?this._getRendererLegendElements(r,{title:c.name,geometryType:g}):(ta.warn("drawingInfo not available!"),null)}return null});
try{const c=[];yield n.eachAlways(a).then(g=>{g.forEach(({value:r})=>r&&c.push(...r))});this.legendElements=c;this.notifyChange("ready")}catch(c){ta.warn("error while building legend for layer!",c)}}});return function(a){return b.apply(this,arguments)}}();ea.buildLegendElementsForRenderer=function(){var b=B._asyncToGenerator(function*(a){try{this.legendElements=(this.hideLayersNotInCurrentView?yield this._isLayerInCurrentView():1)?yield this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(c){ta.warn("error while building legend for layer!",
c)}});return function(a){return b.apply(this,arguments)}}();ea.buildLegendElementsForTools=function(){var b=B._asyncToGenerator(function*(){var a=this;const c=this.layer;if("esri.layers.VoxelLayer"===c.declaredClass)this._constructLegendElementsForVoxellayer();else if("esri.layers.WMTSLayer"===c.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===c.declaredClass)yield this._constructLegendElementsForWMSSublayers();else if(na(c))yield this._constructLegendElementsForBuildingSceneLayer();
else if("esri.layers.MapImageLayer"===c.declaredClass||"esri.layers.TileLayer"===c.declaredClass||na(c))yield this._constructLegendElementsForSublayers();else{this._handles.remove("imageryLayers-watcher");var g="default";if("esri.layers.ImageryLayer"===c.declaredClass){var r,t;g=(null==c?void 0:null==(r=c.renderingRule)?void 0:r.functionName)||"default";r=null!=(t=c.bandIds)&&t.length?c.bandIds.join(""):"###";g=g+"_"+r}yield this._getLegendLayers(`${c.uid}-${g}`).then(function(){var J=B._asyncToGenerator(function*(R){a.legendElements=
[];a.notifyChange("ready");R=R.map(function(){var fa=B._asyncToGenerator(function*(pa){if("esri.layers.ImageryLayer"===c.declaredClass||"esri.layers.ImageryTileLayer"===c.declaredClass){const qa=A.watch(()=>["renderingRule"in c&&c.renderingRule,c.bandIds],()=>n.debounce(B._asyncToGenerator(function*(){Ha["default"]=null;c.renderer?yield a.buildLegendElementsForRenderer(c.renderer):yield a.buildLegendElementsForTools()}))());a._handles.add(qa,"imageryLayers-watcher")}(pa=a._generateSymbolTableElementForLegendLayer(pa))&&
pa.infos.length&&("esri.layers.ImageryLayer"===c.declaredClass&&(pa.title=c.title),a.legendElements.push(pa));a.notifyChange("ready")});return function(pa){return fa.apply(this,arguments)}}());yield n.eachAlways(R)});return function(R){return J.apply(this,arguments)}}()).catch(J=>{ta.warn("Request to server for legend has failed!",J)})}});return function(){return b.apply(this,arguments)}}();ea._isLayerInCurrentView=function(){var b=B._asyncToGenerator(function*(){const a=this.layer,c=this.layerView,
g=c&&"createQuery"in c&&"queryFeatureCount"in c;if(!(g||c&&"createQuery"in a&&"queryFeatureCount"in a))return!0;yield A.whenOnce(()=>!c.updating);const r=g?"createQuery"in c&&c.createQuery():"createQuery"in a&&a.createQuery();r.geometry=this.view.extent;return 0!==(g?"queryFeatureCount"in c&&(yield c.queryFeatureCount(r)):"queryFeatureCount"in a&&(yield a.queryFeatureCount(r)))});return function(){return b.apply(this,arguments)}}();ea._getParentLayerOpacity=function(b){let a=1;const c=b.parent;c&&
"uid"in c&&(a=this._getParentLayerOpacity(c));return b.opacity*a};ea._isGroupActive=function(){const b=this.children;return b.length?b.some(a=>a.ready):!1};ea._isScaleDrivenSizeVariable=function(b){if(b&&"size"!==b.type)return!1;const a=b.minSize,c=b.maxSize;return"object"===typeof a&&a?this._isScaleDrivenSizeVariable(a):"object"===typeof c&&c?this._isScaleDrivenSizeVariable(c):!!b.expression||Ea.test(b.valueExpression)};ea._isLayerScaleDriven=function(b){if("minScale"in b&&0<b.minScale||"maxScale"in
b&&0<b.maxScale)return!0;if("sublayers"in b&&b.sublayers)return b.sublayers.some(c=>this._isLayerScaleDriven(c));const a=b.parent;if(!1===b.loaded&&a&&"esri.layers.MapImageLayer"===a.declaredClass&&"source"in b&&b.source&&"map-layer"===b.source.type)for(const c of a.sourceJSON.layers)if(c.id===b.source.mapLayerId&&(0<c.minScale||0<c.maxScale))return!0;return!1};ea._constructLegendElementsForVoxellayer=function(){var b=B._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("voxel-style-watcher");
const a=this.layer;this._handles.add(A.watch(()=>a.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");var c=Q.unwrap(a.getVariableStyle(null));const g=[];if(c){var r;if(null!=(r=c.uniqueValues)&&r.length){const J=[];c.uniqueValues.forEach(R=>{R.enabled&&J.push({label:R.label||`${R.value}`,value:R.value,symbol:new P({color:R.color,outline:null})})});J.length&&g.push({type:"symbol-table",title:c.label,infos:J})}else if(c.transferFunction){const {colorStops:J,
stretchRange:R}=c.transferFunction;r=J.toArray().reverse();const fa=R.map((qa,aa)=>`${0===aa?ja.SPECIAL_CHARS_LESS_THAN:ja.SPECIAL_CHARS_GREATER_THAN} ${e.formatNumberLabel(qa)}`).reverse(),pa=r.map(qa=>({color:qa.color,value:null,label:null}));pa[0].label=fa[0];pa[pa.length-1].label=fa[1];g.push({type:"color-ramp",title:c.label,infos:pa,preview:p.renderColorRampPreviewHTML(r.map(qa=>qa.color))})}}const t=a.opacity;c=g.reduce((J,R)=>J.concat(this._getAllInfos(R)),[]).filter(J=>!(null==J||!J.symbol)).map(J=>
this._getSymbolPreview(J,t));yield n.eachAlways(c);this.legendElements=g;this.notifyChange("ready")});return function(){return b.apply(this,arguments)}}();ea._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");const b=this.layer.activeLayer;this._handles.add(A.watch(()=>{const {layer:a}=this;return a&&"activeLayer"in a&&a.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(b.styleId&&b.styles){let a=
null;b.styles.some(c=>b.styleId===c.id?(a=c.legendUrl,!0):!1);a&&(this.legendElements=[{type:"symbol-table",title:b.title,infos:[{src:a,opacity:this.opacity}]}])}this.notifyChange("ready")};ea._constructLegendElementsForWMSSublayers=function(){var b=B._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");const a=this.layer;let c=null;if(a.customParameters||a.customLayerParameters)c={...a.customParameters,...a.customLayerParameters};this._handles.add(A.watch(()=>
{const {layer:g}=this;return g&&"sublayers"in g&&g.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=yield this._generateLegendElementsForWMSSublayers(a.sublayers,c);this.notifyChange("ready")});return function(){return b.apply(this,arguments)}}();ea._generateLegendElementsForWMSSublayers=function(){var b=B._asyncToGenerator(function*(a,c){const g=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");
a=a.toArray();for(const r of a)a=A.watch(()=>[r.title,r.visible,r.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),this._handles.add(a,"wms-sublayers-watcher"),(!this.respectLayerVisibility||r.visible&&r.legendEnabled)&&(a=yield this._generateSymbolTableElementForWMSSublayer(r,c))&&a.infos.length&&g.unshift(a);return g});return function(a,c){return b.apply(this,arguments)}}();ea._generateSymbolTableElementForWMSSublayer=function(){var b=B._asyncToGenerator(function*(a,c){return!a.legendUrl&&
a.sublayers?(c=(yield this._generateLegendElementsForWMSSublayers(a.sublayers,c)).filter(g=>g),{type:"symbol-table",title:a.title,infos:c}):this._generateSymbolTableElementForLegendUrl(a,c)});return function(a,c){return b.apply(this,arguments)}}();ea._generateSymbolTableElementForLegendUrl=function(){var b=B._asyncToGenerator(function*(a,c){var g;let r=a.legendUrl;if(r){var t={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};c&&(r=L.addQueryParameters(r,c));c=null;a=null==(g=a.layer)?
void 0:g.opacity;try{if(c=(yield da(r,{responseType:"image"})).data)c.style.opacity=a}catch{}t.infos.push({src:r,preview:c,opacity:a});return t}});return function(a,c){return b.apply(this,arguments)}}();ea._getLegendLayers=function(b,a){const c=Ha&&Ha[b];return c?Promise.resolve(c):this._legendRequest(a).then(g=>{g=g.layers;return Ha[b]=g})};ea._legendRequest=function(b){var a=this.layer;b={f:"json",dynamicLayers:b};if("esri.layers.ImageryLayer"===a.declaredClass){var c=a.exportImageServiceParameters.renderingRule;
c&&(b.renderingRule=JSON.stringify(c.rasterFunctionDefinition||c.toJSON()));a.bandIds&&(b.bandIds=a.bandIds.join());if(a.raster||a.viewId||a.customParameters){const {raster:g,viewId:r,customParameters:t}=a;b={raster:g,viewId:r,...b,...t}}}c=a.url.replace(/(\/)+$/,"");"version"in a&&10.01<=a.version?(a=c.indexOf("?"),c=-1<a?c.substring(0,a)+"/legend"+c.substring(a):c+"/legend"):(a=c.toLowerCase().indexOf("/rest/"),a=c.substring(0,a)+c.substring(a+5,c.length),c="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+
encodeURI(a)+"\x26returnbytes\x3dtrue");return da(c,{query:b}).then(g=>g.data)};ea._constructLegendElementsForBuildingSceneLayer=function(){var b=B._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(A.watch(()=>a.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(c){ta.warn("Request to server for legend has failed!",
c)}});return function(){return b.apply(this,arguments)}}();ea._generateLegendElementsForBuildingSublayers=function(){var b=B._asyncToGenerator(function*(a,c){let g=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const t of a)if(a=A.watch(()=>["renderer"in t&&t.renderer,t.opacity,t.title,t.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||
t.visible){a=t&&null!=t.opacity?t.opacity:null;var r=null!=a?a*c:c;"building-group"===t.type?(a={type:"symbol-table",title:t.title,infos:[]},r=yield this._generateLegendElementsForBuildingSublayers(t.sublayers,r),a.infos.push(...r),g=[a,...g]):t.renderer&&(g=[...yield this._getRendererLegendElements(t.renderer,{title:t.title,opacity:r,sublayer:t}),...g])}return g.filter(t=>!!t&&("infos"in t?0<t.infos.length:!0))});return function(a,c){return b.apply(this,arguments)}}();ea._constructLegendElementsForSublayers=
function(){var b=B._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(A.watch(()=>a.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(c){ta.warn("Request to server for legend has failed!",c)}});return function(){return b.apply(this,arguments)}}();ea._generateLegendElementsForSublayers=
function(){var b=B._asyncToGenerator(function*(a,c,g){const r=this.layer;let t=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!g&&this.sublayerIds&&this.sublayerIds.length&&(a=this.sublayerIds.map(J=>r.findSublayerById(J)).filter(Boolean));for(const J of a)if(a=A.watch(()=>[J.renderer,J.opacity,J.title,J.visible,J.legendEnabled],()=>this._constructLegendElementsForSublayers()),this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||
J.visible&&J.legendEnabled&&this._isSublayerInScale(J))a=J&&null!=J.opacity?J.opacity:null,a=null!=a?a*c:c,J.renderer&&!J.sublayers&&J.originIdOf("renderer")>x.OriginId.SERVICE?(yield J.load(),t=[...yield this._getRendererLegendElements(J.renderer,{title:J.title,opacity:a,sublayer:J}),...t]):(a=yield this._generateSymbolTableElementForSublayer(J,a,g))&&t.unshift(a);return t.filter(J=>!!J&&("infos"in J?0<J.infos.length:!0))});return function(a,c,g){return b.apply(this,arguments)}}();ea._generateSymbolTableElementForSublayer=
function(){var b=B._asyncToGenerator(function*(a,c,g){if(!g){g=new Map;var r=this.layer,t=a.source;let J=null;if(t&&("map-layer"!==t.type||t.mapLayerId!==a.id||t.gdbVersion&&t.gdbVersion!==("gdbVersion"in r&&r.gdbVersion))||a.originIdOf("renderer")>x.OriginId.SERVICE||a.originIdOf("labelingInfo")>x.OriginId.SERVICE||a.originIdOf("labelsVisible")>x.OriginId.SERVICE)t=new T.ExportImageParameters({layer:this.layer}),J=t.hasDynamicLayers?t.dynamicLayers:null,t.destroy();(yield this._getLegendLayers(J||
`${r.uid}-default`,J)).forEach(R=>g.set(R.layerId,R))}r=g.get(a.id);return(!r||null!=r&&r.subLayerIds&&r.defaultVisibility)&&a.sublayers?(c=yield this._generateLegendElementsForSublayers(a.sublayers,c,g),{type:"symbol-table",title:a.title,infos:c}):this._generateSymbolTableElementForLegendLayer(r,a,c)});return function(a,c,g){return b.apply(this,arguments)}}();ea._generateSymbolTableElementForLegendLayer=function(b,a,c){var g;if(!b||!b.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(b,
a))return null;var r=null==a?void 0:a.renderer;let t=(null==a?void 0:a.title)||b.layerName;r&&(!a||(null==a?void 0:a.originIdOf("renderer"))>x.OriginId.SERVICE)&&(r=(null==a?void 0:a.title)||this._getRendererTitle(r,a))&&(t&&"string"!==typeof r&&"title"in r&&(r.title=t),t=r);const J={type:"symbol-table",title:t,legendType:b.legendType?b.legendType:null,infos:[]},R=a?this._sanitizeLegendForSublayer(b.legend.slice(),a):b.legend;0<(null==(g=b.legendGroups)?void 0:g.length)?b.legendGroups.forEach(fa=>
{var pa;const qa={type:"symbol-table",title:fa.heading,legendType:b.legendType?b.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(R.filter(aa=>aa.groupId===fa.id),b.layerId,c)};0<(null==(pa=qa.infos)?void 0:pa.length)&&J.infos.push(qa)}):J.infos=this._generateSymbolTableElementInfosForLegendLayer(R,b.layerId,c);return 0<J.infos.length?J:null};ea._generateSymbolTableElementInfosForLegendLayer=function(b,a,c){return b.map(g=>{let r=g.url;if(g.imageData&&0<g.imageData.length)r=
`data:image/png;base64,${g.imageData}`;else if(0!==r.indexOf("http"))r=y.addTokenParameter(`${this.layer.url}/${a}/images/${r}`);else return null;return{label:g.label,src:r,opacity:null==c?this.opacity:c,width:g.width,height:g.height}}).filter(g=>!!g)};ea._isSublayerInScale=function(b){const a=b.minScale||0;b=b.maxScale||0;return 0<a&&a<this.scale||b>this.scale?!1:!0};ea._isLegendLayerInScale=function(b,a){a=a||this.layer;let c=null,g=null,r=!0;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?
(0===b.minScale&&a.tileInfo&&(c=a.tileInfo.lods[0].scale),0===b.maxScale&&a.tileInfo&&(g=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(c=Math.min(a.minScale,b.minScale)||a.minScale||b.minScale,g=Math.max(a.maxScale,b.maxScale));if(0<c&&c<this.scale||g>this.scale)r=!1;return r};ea._sanitizeLegendForSublayer=function(b,a){if("version"in this.layer&&10.1>this.layer.version||0===b.length)return b;a=a.renderer;let c=null,g=null;b.some(r=>r.values)&&b.some((r,t)=>{r.values||(c=t,g=r,g.label||(g.label=
"others"));return null!=g});a?"unique-value"===a.type?g&&(b.splice(c,1),b.push(g)):"class-breaks"===a.type&&(g&&b.splice(c,1),b.reverse(),g&&b.push(g)):g&&(b.splice(c,1),b.push(g));return b};ea._getRendererLegendElements=function(){var b=B._asyncToGenerator(function*(a,c={}){var g=this.view;g=ba(a)||ka(a)||xa(a)||ya(a)||wa(a)||ha(a)?"2d"===g.type||f.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===a.type||"raster-shaded-relief"===a.type||ua(a)||za(a)||Z(a)||"vector-field"===
a.type||"flow"===a.type;return g?ua(a)||za(a)||Z(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?this._constructPointCloudRendererLegendElements(a,c):wa(a)?this._constructDotDensityRendererLegendElements(a):ha(a)?this._constructPieChartRendererLegendElements(a):this._constructRendererLegendElements(a,c):(ta.warn(`Renderer of type '${a.type}' not supported!`),[])});return function(a){return b.apply(this,arguments)}}();ea._getPointCloudRendererTitle=function(b){return b.legendOptions&&
b.legendOptions.title||b.field};ea._constructPointCloudRendererLegendElements=function(b,a={}){a=a.title;const c=[];let g=null;var r=null;if(ua(b))g={type:"symbol-table",title:a||this._getPointCloudRendererTitle(b),infos:[]},b.colorClassBreakInfos.forEach(t=>{g.infos.unshift({label:t.label||t.minValue+" - "+t.maxValue,value:[t.minValue,t.maxValue],symbol:this._getAppliedCloneSymbol(Ia,t.color)})});else if(za(b)){r=b.stops;let t=null;if(r.length&&(1===r.length&&(t=r[0].color),!t)){const J=r[0].value,
R=r[r.length-1].value;null!=J&&null!=R&&(t=H.getColorFromPointCloudStops(J+(R-J)/2,r))}g={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Ia,t||Ia.color)}]};r=H.getRampStopsForPointCloud(b.stops);r={type:"color-ramp",title:a||this._getPointCloudRendererTitle(b),infos:r,preview:p.renderColorRampPreviewHTML(r.map(J=>J.color))}}else Z(b)&&(g={type:"symbol-table",title:a||this._getPointCloudRendererTitle(b),infos:[]},b.colorUniqueValueInfos.forEach(t=>{g.infos.push({label:t.label||
t.values.join(", "),value:t.values.join(", "),symbol:this._getAppliedCloneSymbol(Ia,t.color)})}));g&&g.infos.length&&c.push(g);r&&r.infos.length&&c.push(r);a=c.reduce((t,J)=>t.concat(J.infos),[]).filter(t=>!!t.symbol).map(t=>this._getSymbolPreview(t,this.opacity,{symbolConfig:{applyColorModulation:!!b.colorModulation}}));return n.eachAlways(a).then(()=>c)};ea._getElementInfoForDotDensity=function(b,a){const {backgroundColor:c,outline:g,dotSize:r}=b;var t=this.effectList;t=null==t?void 0:t.effects.map(R=>
R.toJSON());t=C.effectFunctionsFromJSON(t);t=r+"-"+a+"-"+c+"-"+(g&&JSON.stringify(g.toJSON()))+"-"+t;const J=this._dotDensityUrlCache;b=J.has(t)?J.get(t):p.renderDotDensityPreviewHTML(b,a);J.set(t,b);a=W.renderSymbol([[{shape:{type:"image",x:0,y:0,width:b.width,height:b.height,src:b.src},fill:null,stroke:null,offset:[0,0]}]],[b.width,b.height],{effectView:this.effectList});return{opacity:1,src:b.src,preview:a,width:b.width,height:b.height}};ea._constructDotDensityRendererLegendElements=function(b){const a=
b.calculateDotValue(this.view.scale),c={type:"symbol-table",title:{value:a&&Math.round(a),unit:b.legendOptions&&b.legendOptions.unit||""},infos:[]};b.attributes.forEach(g=>{const r=this._getElementInfoForDotDensity(b,g.color);r.label=g.label||g.valueExpressionTitle||g.field;c.infos.push(r)});return Promise.resolve([c])};ea._constructPieChartRendererLegendElements=function(){var b=B._asyncToGenerator(function*(a){var c,g,r;const t=this.layer.opacity,J=[],R=a.outline;a.attributes.forEach(qa=>{const aa=
new l({color:qa.color,outline:R});J.push({label:qa.label||qa.valueExpressionTitle||qa.field,symbol:aa})});var fa=J.length?[...J]:[];null!=(c=a.othersCategory)&&c.color&&0!==(null==(g=a.othersCategory)?void 0:g.threshold)&&(c=new l({color:a.othersCategory.color,outline:R}),J.push({label:a.othersCategory.label||"Others",symbol:c}));null!=(r=a.defaultColor)&&r.a&&(r=new l({color:a.defaultColor,outline:R}),J.push({label:a.defaultLabel,symbol:r}));r=(yield this._getVisualVariableLegendElements(a,this.layer))||
[];if(J.length){var pa;r.unshift({type:"symbol-table",title:null,infos:J});fa=fa.filter(qa=>"Others"!==qa.label).map(qa=>qa.symbol.color).filter(Boolean);fa=p.renderPieChartPreviewHTML(fa,{holePercentage:a.holePercentage,backgroundColor:null==(pa=a.backgroundFillSymbol)?void 0:pa.color,effectList:this.effectList,outline:R});r.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(a,this.layer),infos:J,preview:fa})}a=r.reduce((qa,aa)=>qa.concat(this._getAllInfos(aa)),[]).filter(qa=>!(null==qa||
!qa.symbol)&&!(null!=qa&&qa.preview)).map(qa=>this._getSymbolPreview(qa,t,{effectList:this.effectList}));yield n.eachAlways(a);return r});return function(a){return b.apply(this,arguments)}}();ea._constructRendererLegendElements=function(){var b=B._asyncToGenerator(function*(a,c={}){const {title:g,sublayer:r}=c,t=r||this.layer;a=yield this._loadRenderer(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const J=(yield this._getVisualVariableLegendElements(a,
t))||[],R={type:"symbol-table",title:g||this._getRendererTitle(a,t),infos:[]};let fa=null,pa=!1;const qa=new Set;if("flow"!==a.type||this._hasSizeRamp)if(sa(a)){var aa=g,ia=Ba(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",Aa=J.findIndex(ma=>"color-ramp"===ma.type);Aa=-1!==Aa?J.splice(Aa,1)[0]:null;var ra=J.findIndex(ma=>"size-ramp"===ma.type);ra=-1!==ra?J.splice(ra,1)[0]:null;var Ca=[];Aa&&(aa=Aa.title,Ca.push(Aa));ra&&(aa=ra.title,Ca.push(ra));0<Ca.length&&J.push({type:ia,title:aa,
infos:Ca})}else if(ya(a))aa=Y.getHeatmapRampStops(a),J.push({type:"heatmap-ramp",title:g||(null==(ra=a.legendOptions)?void 0:ra.title),infos:aa,preview:p.renderColorRampPreviewHTML(aa.map(ma=>ma.color),{effectList:this.effectList})});else if(xa(a)){if((ia=a&&a.authoringInfo)&&"relationship"===ia.type){const {focus:ma,numClasses:Da,field1:La,field2:Ma}=ia;if(Da&&La&&Ma){Aa=[La,Ma];ia=la.getRotationAngleForFocus(ma)||0;for(aa of Aa){const {field:Qa,normalizationField:Na,label:Ra}=aa;Aa=Ra||{field:this._getFieldAlias(Qa,
t),normField:Na&&this._getFieldAlias(Na,t)};ra=Pa.clone();ra.angle=ia;R.infos.push({label:Aa,symbol:ra});qa.add(ra);ia+=90}aa=la.getRelationshipRampElement({focus:ma,numClasses:Da,infos:a.uniqueValueInfos});J.unshift(aa)}}else{const ma=a.field;a.uniqueValueInfos.forEach(Da=>{Da.symbol&&R.infos.push({label:Da.label||this._getDomainName(ma,Da.value,t)||Da.value,value:Da.value,symbol:Da.symbol})})}a.defaultSymbol&&(R.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),pa=!0)}else if(ka(a))fa=
this._isUnclassedRenderer(a),fa&&this._hasSizeRamp||(a.classBreakInfos.forEach(ma=>{ma.symbol&&R.infos.unshift({label:ma.label||(fa?null:ma.minValue+" - "+ma.maxValue),value:[ma.minValue,ma.maxValue],symbol:ma.symbol})}),fa&&(R.title=null),this._updateInfosforClassedSizeRenderer(a,R.infos)),a.defaultSymbol&&!fa&&(R.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),pa=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===
this.layer.declaredClass)aa=this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===aa.type?J.push(aa):R.infos=aa;else{aa=this.layer;a.statistics&&a.statistics.length&&(ia=null!=a.statistics[0].min?a.statistics[0].min:a.statistics[0][0],Aa=null!=a.statistics[0].max?a.statistics[0].max:a.statistics[0][1]);ra=[];ra=Q.unwrap(aa.renderingRule?yield aa.generateRasterInfo(aa.renderingRule):aa.serviceRasterInfo);const ma=ra.keyProperties.BandProperties;Ca=Ka[aa.rasterInfo.pixelType.toLowerCase()];
1===ra.bandCount?(ia=null!=ia?ia:ra.statistics?ra.statistics[aa.bandIds[0]].min:Ca[0],Aa=null!=Aa?Aa:ra.statistics?ra.statistics[aa.bandIds[0]].max:Ca[1],ia||Aa?J.push(this._getStretchLegendElements(a,{min:ia,max:Aa})):this._getServerSideLegend()):aa.bandIds&&1===aa.bandIds.length?(ia=null!=ia?ia:ra.statistics?ra.statistics[aa.bandIds[0]].min:Ca[0],Aa=null!=Aa?Aa:ra.statistics?ra.statistics[aa.bandIds[0]].max:Ca[1],ia||Aa?J.push(this._getStretchLegendElements(a,{min:ia,max:Aa})):this._getServerSideLegend()):
3<=ra.bandCount?ma&&ma.length>=ra.bandCount?aa.bandIds&&3===aa.bandIds.length?(ra=aa.bandIds.map(Da=>ma[Da].BandName),R.infos=this._createSymbolTableElementMultiBand(ra)):"lerc"===aa.format?(ra=[0,1,2].map(Da=>ma[Da].BandName),R.infos=this._createSymbolTableElementMultiBand(ra)):this._getServerSideLegend():"lerc"===aa.format?(ra=["band1","band2","band3"],R.infos=this._createSymbolTableElementMultiBand(ra)):this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(ma=>
{R.infos.push({label:ma.label,value:ma.value,symbol:this._getAppliedCloneSymbol(Oa,ma.color)})});else if(ba(a)){aa=a.symbol;switch(c.geometryType){case "point":aa="pointSymbol"in t&&t.pointSymbol;break;case "polyline":aa="lineSymbol"in t&&t.lineSymbol;break;case "polygon":aa="polygonSymbol"in t&&t.polygonSymbol}a.symbol&&!this._hasSizeRamp&&R.infos.push({label:a.label,symbol:aa})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),R.title=a.attributeField,aa=a.getClassBreakInfos(),
null!=aa&&aa.length?aa.forEach(ma=>{R.infos.push({label:ma.minValue+" - "+ma.maxValue,symbol:ma.symbol})}):R.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):"raster-shaded-relief"===a.type&&J.push(this._getStretchLegendElements(a,{min:0,max:255}));else aa=yield ja.getSymbolForFlowRenderer(a),R.infos.push({label:null,symbol:aa});const Fa=a.defaultSymbol;!Fa||pa||ba(a)||fa&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||J.push({type:"symbol-table",infos:[{label:a.defaultLabel||
"others",symbol:Fa}]});R.infos.length&&J.unshift(R);const Sa=null==c.opacity?this.opacity:c.opacity,Ta=this._isTallSymbol("visualVariables"in a&&a.visualVariables),Ua="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;c=J.reduce((ma,Da)=>ma.concat(this._getAllInfos(Da)),[]).filter(ma=>!(null==ma||!ma.symbol)).map(ma=>this._getSymbolPreview(ma,Sa,{isDefault:ma.symbol===Fa,applyScaleDrivenSize:!qa.has(ma.symbol),symbolConfig:{isTall:Ta,isSquareFill:Ua},
effectList:qa.has(ma.symbol)?null:this.effectList}));a=null;yield n.eachAlways(c);return J});return function(a){return b.apply(this,arguments)}}();ea._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};ea._getAllInfos=function(b){const a=null==b?void 0:b.infos;return a?a.reduce((c,g)=>c.concat(this._getAllInfos(g)),[]):[b]};ea._constructTileImageryStretchRendererElements=function(b){function a(pa){var qa;const aa=(null!=r&&null!=(qa=r.bandIds)&&qa.length?r.bandIds:
Array.from(Array(Math.min(t.bandCount,3)).keys())).map(ia=>pa&&pa[ia]&&pa[ia].BandName||"band"+(ia+1));3>aa.length?aa.push(aa[1]):3<aa.length&&aa.splice(3);return aa}var c,g;const r=this.layer,t=r.rasterInfo,J=t.bandCount||b.statistics.length;var R,fa=[];fa=t.keyProperties&&t.keyProperties.BandProperties;(R=null!=b&&null!=(c=b.statistics)&&c.length?b.statistics:null==t?void 0:t.statistics)?(c=void 0!==R[0].min?R[0].min:R[0][0],R=R[0].max||R[0][1]):(R=Ka[r.rasterInfo.pixelType.toLowerCase()],c=R[0],
R=R[1]);r.hasStandardTime()&&(c=r.getStandardTimeValue(c),R=r.getStandardTimeValue(R));if(1===t.bandCount||1===(null==(g=r.bandIds)?void 0:g.length))return this._getStretchLegendElements(b,{min:c,max:R});fa=fa&&fa.length>=J?a(fa):a();return this._createSymbolTableElementMultiBand(fa)};ea._getStretchLegendElements=function(b,a){b=H.getStrectchRampStops(b.colorRamp,a);return{type:"stretch-ramp",title:"",infos:b,preview:p.renderColorRampPreviewHTML(b.map(c=>c.color))}};ea._getSizeLegendElement=function(){var b=
B._asyncToGenerator(function*(a,c,g,r){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(c):a,infos:yield va.getRampStops(g,c,yield ja.getMedianColor(g),this.scale,this.view.type,r)}});return function(a,c,g,r){return b.apply(this,arguments)}}();ea._createSymbolTableElementMultiBand=function(b){const a=[],c=["red","green","blue"];b.forEach((g,r)=>{var t;a.push({label:{colorName:c[r],bandName:g},src:ja.RGB_IMG_SOURCE[r],opacity:null!=(t=this.opacity)?t:1})});return a};
ea._updateInfosforClassedSizeRenderer=function(b,a){const c=b.authoringInfo&&"class-breaks-size"===b.authoringInfo.type,g=b.classBreakInfos.some(r=>v.isVolumetricSymbol(r.symbol));if(c&&g){const r=va.REAL_WORLD_MAX_SIZE;b=b.classBreakInfos.length;const t=(r-va.REAL_WORLD_MIN_SIZE)/(1<b?b-1:b);a.forEach((J,R)=>{J.size=r-t*R})}};ea._isTallSymbol=function(b){let a=!1,c=!1;if(b)for(let g=0;g<b.length&&(!a||!c);g++){const r=b[g];"size"===r.type&&("height"===r.axis&&(a=!0),"width-and-depth"===r.axis&&(c=
!0))}return a&&c};ea._getSymbolPreview=function(){var b=B._asyncToGenerator(function*(a,c,g){var r=null!=g&&g.isDefault||null!=a.size||!this._hasSizeRamp?a.size:m.px2pt(w.SymbolSizeDefaults.size);this._scaleDrivenSizeVariable&&null!=g&&g.applyScaleDrivenSize&&({getSize:r}=yield new Promise((t,J)=>M(["../../../renderers/visualVariables/support/visualVariableUtils"],t,J)),r=r(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:
null}));return p.renderPreviewHTML(a.symbol,{size:r,opacity:c,scale:!1,symbolConfig:null==g?void 0:g.symbolConfig,effectView:null==g?void 0:g.effectList}).then(t=>{a.preview=t;return a}).catch(()=>{a.preview=null;return a})});return function(a,c,g){return b.apply(this,arguments)}}();ea._loadRenderer=function(){var b=B._asyncToGenerator(function*(a){var c,g;const r=[];var t=this.layer;a=a.clone();this._hasClusterSizeVariable=!1;const J="visualVariables"in a&&(null==(c=a.visualVariables)?void 0:c.some(fa=>
"size"===fa.type&&"outline"!==fa.target&&!Ea.test(fa.valueExpression)));if(a&&"visualVariables"in a&&!J&&"featureReduction"in t&&"cluster"===(null==(g=t.featureReduction)?void 0:g.type)&&(c=Q.unwrap(I.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view)))){t=t.featureReduction;if("clusterMinSize"in t&&"clusterMaxSize"in t){const {clusterMinSize:fa,clusterMaxSize:pa}=t;c.legendOptions=new G({showLegend:fa!==pa})}a.visualVariables=(a.visualVariables||[]).concat([c]);this._hasClusterSizeVariable=
!0}const R=yield ja.getMedianColor(a);if(ka(a)||xa(a))t=(a.classBreakInfos||a.uniqueValueInfos).map(fa=>this._fetchSymbol(fa.symbol,R).then(pa=>{fa.symbol=pa}).catch(()=>{fa.symbol=null})),Array.prototype.push.apply(r,t);r.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:R).then(fa=>{this._applySymbolToRenderer(a,fa,ba(a))}).catch(()=>{this._applySymbolToRenderer(a,null,ba(a))}));return n.eachAlways(r).then(()=>a)});return function(a){return b.apply(this,arguments)}}();ea._applySymbolToRenderer=
function(b,a,c){c?b.symbol=a:b.defaultSymbol=a};ea._fetchSymbol=function(){var b=B._asyncToGenerator(function*(a,c){if(!a)throw Error();if("web-style"===a.type){const g=this._webStyleSymbolCache;try{const r=yield"2d"===this.view.type?a.fetchCIMSymbol({cache:g}):a.fetchSymbol({cache:g});return this._getAppliedCloneSymbol(r,c)}catch{throw ta.warn("Fetching web-style failed!"),Error();}}return this._getAppliedCloneSymbol(a,c)});return function(a,c){return b.apply(this,arguments)}}();ea._getAppliedCloneSymbol=
function(b,a){if(!b||!a)return b;b=b.clone();const c=a&&a.toRgba();b.type.includes("3d")?this._applyColorTo3dSymbol(b,c):"cim"===b.type?O.applyCIMSymbolColor(b,a):b.color&&(b.color=new V(c||b.color));return b};ea._applyColorTo3dSymbol=function(b,a){a&&b.symbolLayers.forEach(c=>{c&&(c.material||(c.material={}),c.material.color=new V(a))})};ea._getVisualVariableLegendElements=function(){var b=B._asyncToGenerator(function*(a,c){var g=this;if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===
a.type)return null;var r=a.visualVariables,t=[];const J=[],R=[];for(const aa of r)"color"===aa.type?t.push(aa):"size"===aa.type?J.push(aa):"opacity"===aa.type&&R.push(aa);r=[...t,...J,...R];let fa;if(0===t.length&&ka(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var pa=(pa=a.classBreakInfos[0])&&pa.symbol;0===t.length&&ba(a)&&(pa=a.symbol);pa&&(pa.type.includes("3d")?(t=pa.symbolLayers.getItemAt(0),"water"===t.type?Q.isSome(t.color)&&(fa=t.color):Q.isSome(t.material)&&Q.isSome(t.material.color)&&
(fa=t.material.color)):pa.url||(fa=pa.color));const qa=this.effectList;return(yield Promise.all(r.map(function(){var aa=B._asyncToGenerator(function*(ia){if(!ia.legendOptions||!1!==ia.legendOptions.showLegend){const ra="flow"===a.type?ia.field:g._getRampTitle(ia,c);let Ca=null;var Aa="getField"in c&&c.getField&&c.getField(ia.field);Aa=Aa&&X.isDateField(Aa);"color"===ia.type?(ia=yield H.getRampStops(ia,null,Aa),Ca={type:"color-ramp",title:ra,infos:ia,preview:p.renderColorRampPreviewHTML(ia.map(Fa=>
Fa.color),{effectList:qa})},g._hasColorRamp||(g._hasColorRamp=!(null==Ca.infos||!Ca.infos.length))):"size"===ia.type&&"outline"!==ia.target?Ea.test(ia.valueExpression)?g._hasClusterSizeVariable||(g._scaleDrivenSizeVariable=ia):(Ca=yield g._getSizeLegendElement(ra,ia,a,Aa),g._hasSizeRamp||(g._hasSizeRamp=!(null==Ca.infos||!Ca.infos.length))):"opacity"===ia.type&&(ia=yield H.getRampStops(ia,fa,Aa),Ca={type:"opacity-ramp",title:ra,infos:ia,preview:p.renderColorRampPreviewHTML(ia.map(Fa=>Fa.color),{effectList:qa})},
g._hasOpacityRamp||(g._hasOpacityRamp=!(null==Ca.infos||!Ca.infos.length)));return Ca&&Ca.infos?Ca:null}});return function(ia){return aa.apply(this,arguments)}}()))).filter(aa=>!!aa)});return function(a,c){return b.apply(this,arguments)}}();ea._getDomainName=function(b,a,c){return b&&"function"!==typeof b?(c=(b="getField"in c&&c.getField&&c.getField(b))&&"getFieldDomain"in c&&c.getFieldDomain?c.getFieldDomain(b.name):null)&&"coded-value"===c.type?c.getName(a):null:null};ea._getClusterTitle=function(b){var a=
this.layer;b=b.field;if("featureReduction"in a&&a.featureReduction&&"cluster"===a.featureReduction.type&&(a=a.featureReduction,a=(a="popupTemplate"in a&&a.popupTemplate)&&a.fieldInfos))for(const c of a)if(c.fieldName===b)return"cluster_count"===b?c.label||{showCount:!0}:c.label;return{showCount:!0}};ea._getRampTitle=function(b,a){let c=b.field,g=b.normalizationField,r=!1,t=!1,J=!1;var R=null;c="function"===typeof c?null:c;g="function"===typeof g?null:g;R=b.legendOptions&&b.legendOptions.title;if(null==
R)if(b.valueExpressionTitle)R=b.valueExpressionTitle;else{if("renderer"in a&&a.renderer&&"authoringInfo"in a.renderer&&a.renderer.authoringInfo&&a.renderer.authoringInfo.visualVariables)for(b=a.renderer.authoringInfo.visualVariables,R=0;R<b.length;R++){const fa=b[R];if("color"===fa.type){if("ratio"===fa.style){r=!0;break}if("percent"===fa.style){t=!0;break}if("percent-of-total"===fa.style){J=!0;break}}}R={field:c&&this._getFieldAlias(c,a),normField:g&&this._getFieldAlias(g,a),ratio:r,ratioPercent:t,
ratioPercentTotal:J}}return R};ea._getRendererTitle=function(b,a){if(b.legendOptions&&b.legendOptions.title)return b.legendOptions.title;if(b.valueExpressionTitle)return b.valueExpressionTitle;let c=b.field,g=null,r=null;ka(b)&&(g=b.normalizationField,r="percent-of-total"===b.normalizationType);c="function"===typeof c?null:c;g="function"===typeof g?null:g;b=null;if(c||g)b={field:c&&this._getFieldAlias(c,a),normField:g&&this._getFieldAlias(g,a),normByPct:r};return b};ea._getFieldAlias=function(b,a){var c=
"popupTemplate"in a&&a.popupTemplate;c=c&&c.fieldInfos;let g=null;c&&c.some(t=>b===t.fieldName?(g=t,!0):!1);c=null;"getField"in a&&a.getField?c=a.getField(b):"fieldsIndex"in a&&a.fieldsIndex&&(c=a.fieldsIndex.get(b));a=g||c;let r=null;a&&(r=g&&g.label||c&&c.alias||"name"in a&&a.name||"fieldName"in a&&a.fieldName);return r};ea._isUnclassedRenderer=function(b){const a=b.visualVariables;let c=!1;ka(b)&&b.classBreakInfos&&1===b.classBreakInfos.length&&a&&(c=b.field?a.some(g=>!(!g||b.field!==g.field||
(b.normalizationField||g.normalizationField)&&b.normalizationField!==g.normalizationField)):!!a.length);return c};B._createClass(Ja,[{key:"effectList",get:function(){const b=this.layer;let a=null;"effect"in b&&b.effect&&(a=new q.EffectView,a.effect=b.effect,a.end(),a.scale=this.scale);return a}},{key:"opacity",get:function(){var b;const a=this.layer.opacity,c=null==(b=this.parent)?void 0:b.opacity;b=(b=this.layer.parent)&&"uid"in b?this._getParentLayerOpacity(b):null;return null!=c?c*a:null!=b?b*
a:a}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},{key:"scale",get:function(){return this.view&&this.view.scale}},{key:"isScaleDriven",get:function(){var b=this.layer;if(null===b)return!1;if("effect"in b&&b.effect&&Array.isArray(b.effect)||"featureReduction"in b&&b.featureReduction&&"cluster"===b.featureReduction.type)return!0;if("renderer"in b&&b.renderer){if("dot-density"===b.renderer.type)return!0;const a=b.get("renderer.valueExpression");
if(Ea.test(a))return!0;if(b=b.get("renderer.visualVariables"))return b.some(c=>this._isScaleDrivenSizeVariable(c))}return this._isLayerScaleDriven(this.layer)}},{key:"version",get:function(){return this._get("version")+1}}]);return Ja}(u);z.__decorate([K.property()],N.prototype,"children",void 0);z.__decorate([K.property({readOnly:!0})],N.prototype,"effectList",null);z.__decorate([K.property()],N.prototype,"layerView",void 0);z.__decorate([K.property()],N.prototype,"layer",void 0);z.__decorate([K.property()],
N.prototype,"legendElements",void 0);z.__decorate([K.property({readOnly:!0})],N.prototype,"opacity",null);z.__decorate([K.property()],N.prototype,"parent",void 0);z.__decorate([K.property({readOnly:!0,dependsOn:[]})],N.prototype,"ready",null);z.__decorate([K.property()],N.prototype,"hideLayersNotInCurrentView",void 0);z.__decorate([K.property()],N.prototype,"keepCacheOnDestroy",void 0);z.__decorate([K.property()],N.prototype,"respectLayerVisibility",void 0);z.__decorate([K.property({readOnly:!0})],
N.prototype,"scale",null);z.__decorate([K.property()],N.prototype,"sublayerIds",void 0);z.__decorate([K.property({readOnly:!0})],N.prototype,"isScaleDriven",null);z.__decorate([K.property()],N.prototype,"title",void 0);z.__decorate([K.property({readOnly:!0,dependsOn:["ready"],value:0})],N.prototype,"version",null);z.__decorate([K.property()],N.prototype,"view",void 0);return N=z.__decorate([h.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],N)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S){function Q(m){m=F.parse(m)||[];var L=(L=m[0])?"type"in L:!1;return L?[{scale:-1,effects:m}]:m}function n(m,L,K){var E,k,d,h;return null!=(E=m[0])&&E.effects&&null!=(k=L[0])&&k.effects?(-1===(null==(d=m[0])?void 0:d.scale)||-1===(null==(h=L[0])?void 0:h.scale))&&(1<m.length||1<L.length)&&0>=K?!1:S.canInterpolateEffects(m[0].effects,L[0].effects):!0}function A(m,L,K){var E,k;const d=m.length>L.length?m:L;m=m.length>L.length?L:m;const h=m[m.length-1];L=null!=(E=null==
h?void 0:h.scale)?E:K;E=null!=(k=null==h?void 0:h.effects)?k:[];for(k=m.length;k<d.length;k++)m.push({scale:L,effects:[...E]});for(k=0;k<d.length;k++)m[k].scale=-1===m[k].scale?K:m[k].scale,d[k].scale=-1===d[k].scale?K:d[k].scale,S.normalizeEffects(m[k].effects,d[k].effects)}M.EffectView=function(m){function L(E){E=m.call(this,E)||this;E._from=null;E._to=null;E._final=null;E._current=[];E._time=0;E.duration=y("mapview-transitions-duration");E.effects=[];return E}B._inheritsLoose(L,m);var K=L.prototype;
K.canTransitionTo=function(E){try{return 0<this.scale&&n(this._current,Q(E),this.scale)}catch{return!1}};K.transitionStep=function(E,k){this._applyTimeTransition(E);this._updateForScale(k)};K.end=function(){this._applyTimeTransition(this.duration)};K._transitionTo=function(E){0<this.scale&&n(this._current,E,this.scale)?(this._final=E,this._to=da.clone(E),A(this._current,this._to,this.scale),this._from=da.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=E);this._set("effects",
this._current[0]?da.clone(this._current[0].effects):[])};K._applyTimeTransition=function(E){if(this._to&&this._from&&this._current&&this._final){this._time+=E;E=Math.min(1,this._time/this.duration);for(let d=0;d<this._current.length;d++){const h=this._current[d],x=this._from[d],q=this._to[d];var k=x.scale;h.scale=k+(q.scale-k)*E;for(k=0;k<h.effects.length;k++)h.effects[k].interpolate(x.effects[k],q.effects[k],E)}1===E&&(this._current=this._final,this._set("effects",this._current[0]?da.clone(this._current[0].effects):
[]),this._from=this._to=this._final=null)}};K._updateForScale=function(E){this._set("scale",E);if(0!==this._current.length){var k=this._current,d=this._current.length-1,h,x=1;if(1===k.length||E>=k[0].scale)var q=h=k[0].effects;else if(E<=k[d].scale)q=h=k[d].effects;else for(let C=0;C<d;C++){const T=k[C],X=k[C+1];if(T.scale>=E&&X.scale<=E){x=(E-T.scale)/(X.scale-T.scale);h=T.effects;q=X.effects;break}}for(E=0;E<this.effects.length;E++)this.effects[E].interpolate(h[E],q[E],x)}};B._createClass(L,[{key:"effect",
set:function(E){const k=this._get("effect");E=E||"";if(k!==E){this._set("effect",E);try{this._transitionTo(Q(E))}catch(d){this._transitionTo([]),N.getLogger(this.declaredClass).warn("Invalid Effect",{effect:E,error:d})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(E){this._updateForScale(E)}},{key:"transitioning",get:function(){return null!==this._to}}]);return L}(V);z.__decorate([u.property()],M.EffectView.prototype,"_to",void 0);
z.__decorate([u.property()],M.EffectView.prototype,"duration",void 0);z.__decorate([u.property({value:""})],M.EffectView.prototype,"effect",null);z.__decorate([u.property({readOnly:!0})],M.EffectView.prototype,"effects",void 0);z.__decorate([u.property({readOnly:!0})],M.EffectView.prototype,"hasEffects",null);z.__decorate([u.property({value:0})],M.EffectView.prototype,"scale",null);z.__decorate([u.property({readOnly:!0})],M.EffectView.prototype,"transitioning",null);M.EffectView=z.__decorate([D.subclass("esri.layers.effects.EffectView")],
M.EffectView);M.canInterpolateEffectStops=n;M.convertEffectToStops=Q;M.normalizeEffectStops=A;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/sql ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S,Q,n,A){const m={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};M.ExportImageParameters=function(L){function K(k){k=L.call(this,k)||this;k.floors=null;k.scale=0;return k}B._inheritsLoose(K,L);var E=K.prototype;E.destroy=function(){this.layer=null};E.toJSON=
function(){var k=this.layer;k={dpi:k.dpi,format:k.imageFormat,transparent:k.imageTransparency,gdbVersion:k.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?k.dynamicLayers=this.dynamicLayers:k={...k,layers:this.layers,layerDefs:this.layerDefs};return k};B._createClass(K,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const k=this.visibleSublayers.map(d=>{const h=n.getLayerFloorFilterClause(this.floors,d);return d.toExportImageJSON(h)});return k.length?JSON.stringify(k):
null}},{key:"hasDynamicLayers",get:function(){return this.layer&&A.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}},{key:"layer",set:function(k){this._get("layer")!==k&&(this._set("layer",k),this.handles.remove("layer"),k&&this.handles.add([k.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),k.on("sublayer-update",d=>this.notifyChange(m[d.propertyName]))],"layer"))}},{key:"layers",get:function(){const k=this.visibleSublayers;return k?k.length?
"show:"+k.map(d=>d.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var k;const d=!(null==(k=this.floors)||!k.length);k=this.visibleSublayers.filter(h=>null!=h.definitionExpression||d&&null!=h.floorInfo);return k.length?JSON.stringify(k.reduce((h,x)=>{var q=n.getLayerFloorFilterClause(this.floors,x);q=N.sqlAnd(q,x.definitionExpression);da.isSome(q)&&(h[x.id]=q);return h},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const k=this.layer;k&&(k.commitProperty("dpi"),k.commitProperty("imageFormat"),k.commitProperty("imageTransparency"),k.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const k=[];if(!this.layer)return k;var d=this.layer.sublayers;const h=x=>{const q=this.scale,C=0===x.minScale||q<=x.minScale,T=0===x.maxScale||q>=x.maxScale;x.visible&&(0===q||C&&T)&&(x.sublayers?x.sublayers.forEach(h):k.unshift(x))};d&&d.forEach(h);
d=this._get("visibleSublayers");return!d||d.length!==k.length||d.some((x,q)=>k[q]!==x)?k:d}}]);return K}(y.HandleOwnerMixin(V));z.__decorate([u.property({readOnly:!0})],M.ExportImageParameters.prototype,"dynamicLayers",null);z.__decorate([u.property()],M.ExportImageParameters.prototype,"floors",void 0);z.__decorate([u.property({readOnly:!0})],M.ExportImageParameters.prototype,"hasDynamicLayers",null);z.__decorate([u.property()],M.ExportImageParameters.prototype,"layer",null);z.__decorate([u.property({readOnly:!0})],
M.ExportImageParameters.prototype,"layers",null);z.__decorate([u.property({readOnly:!0})],M.ExportImageParameters.prototype,"layerDefs",null);z.__decorate([u.property({type:Number})],M.ExportImageParameters.prototype,"scale",void 0);z.__decorate([u.property(Q.combinedViewLayerTimeExtentProperty)],M.ExportImageParameters.prototype,"timeExtent",void 0);z.__decorate([u.property({readOnly:!0})],M.ExportImageParameters.prototype,"version",null);z.__decorate([u.property({readOnly:!0})],M.ExportImageParameters.prototype,
"visibleSublayers",null);M.ExportImageParameters=z.__decorate([S.subclass("esri.layers.mixins.ExportImageParameters")],M.ExportImageParameters);Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(M){function B(z,V){if(null==z||!z.length)return null;z=z.filter(y=>""!==y).map(y=>`'${y}'`);z.push("''");return`${V} IN (${z.join(",")}) OR ${V} IS NULL`}M.getFloorFilterClause=function(z){var V;
const y=z.layer;return"floorInfo"in y&&null!=(V=y.floorInfo)&&V.floorField&&"floors"in z.view?B(z.view.floors,y.floorInfo.floorField):null};M.getLayerFloorFilterClause=function(z,V){var y;return"floorInfo"in V&&null!=(y=V.floorInfo)&&y.floorField?B(z,V.floorInfo.floorField):null};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/has","../../core/Error","../../core/maybe",
"../../symbols/support/symbolConversion"],function(M,B,z,V,y){function da(D){return V.isNone(D)||"simple"===D.type||"unique-value"===D.type||"class-breaks"===D.type||"dictionary"===D.type||"heatmap"===D.type}function N(D,F){if(!F)return null;F=Array.isArray(F)?F:[F];if(0<F.length){const S=F.map(n=>n.details.symbol.type||n.details.symbol.declaredClass).filter(n=>!!n);S.sort();const Q=[];S.forEach((n,A)=>{0!==A&&n===S[A-1]||Q.push(n)});return new z("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${Q.join(", ")}) which are not supported in 3D`,
{renderer:D,symbolErrors:F})}return null}function u(D){const F=D.uniqueValueInfos.map(Q=>y.to3D(Q.symbol).error).filter(Q=>!!Q),S=y.to3D(D.defaultSymbol);S.error&&F.unshift(S.error);return N(D,F)}function ca(D){const F=D.classBreakInfos.map(Q=>y.to3D(Q.symbol).error).filter(Q=>!!Q),S=y.to3D(D.defaultSymbol);S.error&&F.unshift(S.error);return N(D,F)}M.isSupportedRenderer3D=da;M.validateTo3D=function(D){if(V.isNone(D))return null;if(!da(D))return new z("renderer-conversion-3d:unsupported-renderer",
`Unsupported renderer of type '${D.type||D.declaredClass}'`,{renderer:D});switch(D.type){case "simple":return N(D,y.to3D(D.symbol).error);case "unique-value":return u(D);case "class-breaks":return ca(D)}return null};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(M,B){const z=(V,y)=>{V=V.featuresTilingScheme.getClosestInfoForScale(V.scale).level;
return null!=y&&y.levels?y.levels[V]:null};M.getClusterSizeVariable=function(V,y){if(!(V&&"visualVariables"in V&&V.visualVariables))return null;V=V.visualVariables.find(da=>"size"===da.type);return(y=z(y,V))?new B({field:V.field,minSize:y[2].size,minDataValue:y[2].value,maxSize:y[3].size,maxDataValue:y[3].value}):null};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang",
"../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(M,B,z,V){function y(D){if(D){var {type:F}=D;return F.includes("3d")?V.getSymbolLayerFill(D.symbolLayers.getItemAt(0)):"simple-line"===F||"simple-marker"===D.type&&("x"===D.style||"cross"===D.style)?(D=z.getStroke(D))&&D.color:z.getFill(D)}}function da(D,F){const S=F.HH.label,Q=F.LL.label,n=F.HL.label;F=F.LH.label;switch(D){case "HH":return{top:S,bottom:Q,left:n,right:F};case "HL":return{top:n,bottom:F,left:Q,
right:S};case "LL":return{top:Q,bottom:S,left:F,right:n};case "LH":return{top:F,bottom:n,left:S,right:Q};default:return{top:S,bottom:Q,left:n,right:F}}}function N(D){let F=u[D];D&&null==F&&(F=u.HH);return F||0}const u={HH:315,HL:45,LL:135,LH:225},ca={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};M.getRelationshipRampColors2D=function(D,F){const S=[],Q=D.length**
.5;D=B.clone(D);var n=(F||"HH").split("");F=n[0];for(n="H"===n[1];D.length;){const A=[];for(;A.length<Q;)A.push(D.shift());n&&A.reverse();S.push(A)}"L"===F&&S.reverse();return S};M.getRelationshipRampElement=function(D){const {focus:F,infos:S,numClasses:Q}=D;var n=ca[Q];const A={};S.forEach(m=>{A[m.value]={label:m.label,fill:y(m.symbol)}});D=[];for(let m=0;m<Q;m++){const L=[];for(let K=0;K<Q;K++)L.push(A[n[m][K]].fill);D.push(L)}n=da(F,A);return{type:"relationship-ramp",numClasses:Q,focus:F,colors:D,
labels:n,rotation:N(F)}};M.getRotationAngleForFocus=N;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S,Q,n,A,m,L){function K(e){const l=e.outline;var P=u.isSome(e.material)?e.material.color:null;P=u.isSome(P)?P.toHex():null;if(u.isNone(l)||"pattern"in l&&u.isSome(l.pattern)&&"style"===l.pattern.type&&"none"===l.pattern.style)return"fill"===e.type&&"#ffffff"===P?{color:"#bdc3c7",width:.75}:null;e=D.pt2px(l.size)||0;return{color:"rgba("+(u.isSome(l.color)?l.color.toRgba():"255,255,255,1")+")",width:Math.min(e,Y),style:"pattern"in l&&u.isSome(l.pattern)&&"style"===l.pattern.type?
F.dekebabifyLineStyle(l.pattern.style):null,join:"butt",cap:"patternCap"in l?l.patternCap:"butt"}}function E(e,l){var P=l&&l.resource;P=P&&P.href;if(e.thumbnail&&e.thumbnail.url)return Promise.resolve(e.thumbnail.url);if(P&&"object"!==l.type)return Promise.resolve(m.getIconHref(e,l));const ba=z.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return e.styleOrigin&&(e.styleOrigin.styleName||e.styleOrigin.styleUrl)?L.resolveWebStyleSymbol(e.styleOrigin,{portal:e.styleOrigin.portal},"webRef").catch(ka=>
ka).then(ka=>{var xa;return(null==ka?void 0:null==(xa=ka.thumbnail)?void 0:xa.url)||ba}):Promise.resolve(ba)}function k(e,l=1){const P=e.a;e=V.toHSV(e);const {r:ba,g:ka,b:xa}=V.toRGB({h:e.h,s:e.s/l,v:100-(100-e.v)/l});return[ba,ka,xa,P]}function d(e){return"water"===e.type?u.isNone(e.color)?null:e.color:u.isNone(e.material)||u.isNone(e.material.color)?null:e.material.color}function h(e,l=0){var P=d(e);if(!P){if("fill"===e.type)return null;l=n.adjustColorComponentBrightness(F.defaultThematicColor.r,
l);return[l,l,l,100]}e=P.toRgba();for(P=0;3>P;P++)e[P]=n.adjustColorComponentBrightness(e[P],l);return e}function x(e,l){return q.apply(this,arguments)}function q(){q=B._asyncToGenerator(function*(e,l){e=e.style;return"none"===e?null:{type:"pattern",x:0,y:0,src:yield F.getPatternUrlWithColor(z.getAssetUrl(`esri/symbols/patterns/${e}.png`),l.toCss(!0)),width:5,height:5}});return q.apply(this,arguments)}function C(e){return e.outline?K(e):{color:"rgba(0, 0, 0, 1)",width:1.5}}function T(e,l){e=d(e);
if(!e)return null;let P;P="rgba("+(n.adjustColorComponentBrightness(e.r,l)+",");P+=n.adjustColorComponentBrightness(e.g,l)+",";P+=n.adjustColorComponentBrightness(e.b,l)+",";return P+e.a+");"}function X(e,l){l=T(e,l);if(!l)return{};if("pattern"in e&&u.isSome(e.pattern)&&"style"===e.pattern.type&&"none"===e.pattern.style)return null;const P=Math.min(e.size?D.pt2px(e.size):.75,Y);return{color:l,width:P,style:"pattern"in e&&u.isSome(e.pattern)&&"style"===e.pattern.type?F.dekebabifyLineStyle(e.pattern.style):
null,cap:"cap"in e?e.cap:null,join:"join"in e?"miter"===e.join?D.pt2px(2):e.join:null}}function U(e,l,P){P*=.75;return{type:"linear",x1:P?.25*P:0,y1:P?.5*P:0,x2:P||4,y2:P?.5*P:4,colors:[{color:e,offset:0},{color:l,offset:1}]}}function f(e){const l=e.depth,P=e.height;return(e=e.width)&&l&&P&&e===l&&e<P}function G(e,l,P){const ba=[];if(!e)return ba;switch(e.type){case "icon":switch(e.resource&&e.resource.primitive||S.defaultPrimitive){case "circle":ba.push({shape:{type:"circle",cx:0,cy:0,r:.5*l},fill:h(e,
0),stroke:K(e)});break;case "square":ba.push({shape:{type:"path",path:[{command:"M",values:[0,l]},{command:"L",values:[0,0]},{command:"L",values:[l,0]},{command:"L",values:[l,l]},{command:"Z",values:[]}]},fill:h(e,0),stroke:K(e)});break;case "triangle":ba.push({shape:{type:"path",path:[{command:"M",values:[0,l]},{command:"L",values:[.5*l,0]},{command:"L",values:[l,l]},{command:"Z",values:[]}]},fill:h(e,0),stroke:K(e)});break;case "cross":ba.push({shape:{type:"path",path:[{command:"M",values:[.5*l,
0]},{command:"L",values:[.5*l,l]},{command:"M",values:[0,.5*l]},{command:"L",values:[l,.5*l]}]},stroke:C(e)});break;case "x":ba.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[l,l]},{command:"M",values:[l,0]},{command:"L",values:[0,l]}]},stroke:C(e)});break;case "kite":ba.push({shape:{type:"path",path:[{command:"M",values:[0,.5*l]},{command:"L",values:[.5*l,0]},{command:"L",values:[l,.5*l]},{command:"L",values:[.5*l,l]},{command:"Z",values:[]}]},fill:h(e,0),stroke:K(e)})}break;
case "object":switch(e.resource&&e.resource.primitive||Q.defaultPrimitive){case "cone":var ka=h(e,0);e=h(e,-.6);e=U(ka,e,P?va:l);l=n.getConeShapes(l,P);ba.push({shape:l[0],fill:e});ba.push({shape:l[1],fill:e});break;case "inverted-cone":P=h(e,0);e=h(e,-.6);e=U(P,e,l);l=n.getInvertedConeShapes(l);ba.push({shape:l[0],fill:e});ba.push({shape:l[1],fill:P});break;case "cube":l=n.getCubeShapes(l,P);ba.push({shape:l[0],fill:h(e,0)});ba.push({shape:l[1],fill:h(e,-.3)});ba.push({shape:l[2],fill:h(e,-.5)});
break;case "cylinder":{ka=h(e,0);const xa=h(e,-.6);ka=U(ka,xa,P?va:l);l=n.getCylinderShapes(l,P);ba.push({shape:l[0],fill:ka});ba.push({shape:l[1],fill:ka});ba.push({shape:l[2],fill:h(e,0)});break}case "diamond":l=n.getDiamondShapes(l);ba.push({shape:l[0],fill:h(e,-.3)});ba.push({shape:l[1],fill:h(e,0)});ba.push({shape:l[2],fill:h(e,-.3)});ba.push({shape:l[3],fill:h(e,-.7)});break;case "sphere":P=h(e,0);e=h(e,-.6);e=U(P,e);e.x1=0;e.y1=0;e.x2=.25*l;e.y2=.25*l;ba.push({shape:{type:"circle",cx:0,cy:0,
r:.5*l},fill:e});break;case "tetrahedron":l=n.getTetrahedronShapes(l),ba.push({shape:l[0],fill:h(e,-.3)}),ba.push({shape:l[1],fill:h(e,0)}),ba.push({shape:l[2],fill:h(e,-.6)})}}return ba}function O(e){return(e="number"===typeof(null==e?void 0:e.size)?null==e?void 0:e.size:null)?D.pt2px(e):null}function w(e,l){const P=O(l),ba=l&&l.maxSize?D.pt2px(l.maxSize):null,ka=l&&l.disableUpsampling,xa=e.symbolLayers,ya=[];let ua=0,za=0;const Z=xa.getItemAt(xa.length-1);let wa;Z&&"icon"===Z.type&&(wa=Z.size&&
D.pt2px(Z.size));xa.forEach(ha=>{if("icon"===ha.type||"object"===ha.type){var na="icon"===ha.type?ha.size&&D.pt2px(ha.size):0,sa=P||na?Math.ceil(Math.min(P||na,ba||H)):I;if(ha&&ha.resource&&ha.resource.href){var Ba=E(e,ha).then(ta=>{const Ea=ha.get("material.color");var Ga="icon"===ha.type?"multiply":"tint";return A.tintImageWithColor(ta,sa,Ea,Ga,ka)}).then(ta=>{const Ea=ta.width,Ga=ta.height;ua=Math.max(ua,Ea);za=Math.max(za,Ga);return[{shape:{type:"image",x:0,y:0,width:Ea,height:Ga,src:ta.url},
fill:null,stroke:null}]});ya.push(Ba)}else{let ta=sa;"icon"===ha.type&&wa&&P&&(ta=na/wa*sa);na="tall"===(null==l?void 0:l.symbolConfig)||(null==l?void 0:null==(Ba=l.symbolConfig)?void 0:Ba.isTall)||("object"===ha.type?f(ha):!1);ua=Math.max(ua,na?va:ta);za=Math.max(za,ta);ya.push(Promise.resolve(G(ha,ta,na)))}}});return ca.eachAlways(ya).then(ha=>{const na=[];ha.forEach(sa=>{sa.value?na.push(sa.value):sa.error&&ja.warn("error while building swatchInfo!",sa.error)});return A.renderSymbol(na,[ua,za],
{node:l&&l.node,scale:!1,opacity:l&&l.opacity})})}function W(e,l){const P=e.symbolLayers,ba=[];e=m.isVolumetricSymbol(e);const ka=O(l),xa=(l&&l.maxSize?D.pt2px(l.maxSize):null)||Y;let ya=0,ua=0,za;P.forEach((Z,wa)=>{if(Z&&("line"===Z.type||"path"===Z.type)){var ha=[];switch(Z.type){case "line":var na=X(Z,0);if(u.isNone(na))break;var sa=na&&na.width||0;0===wa&&(za=sa);Z=Math.min(ka||sa,xa);wa=0===wa?Z:ka?sa/za*Z:Z;sa=wa>la/2?2*wa:la;ua=Math.max(ua,wa);ya=Math.max(ya,sa);na.width=wa;ha.push({shape:{type:"path",
path:[{command:"M",values:[0,.5*ua]},{command:"L",values:[ya,.5*ua]}]},stroke:na});break;case "path":na=Math.min(ka||I,xa);wa=h(Z,0);sa=h(Z,-.2);var Ba=T(Z,-.4);Ba=Ba?{color:Ba,width:1}:{};if("quad"===Z.profile){const ta=Z.width;Z=Z.height;Z=n.getPathSymbolShapes(ta&&Z?ta/Z:1,0===Z,0===ta);Ba={...Ba,join:"bevel"};ha.push({shape:Z[0],fill:sa,stroke:Ba});ha.push({shape:Z[1],fill:sa,stroke:Ba});ha.push({shape:Z[2],fill:wa,stroke:Ba})}else ha.push({shape:n.shapes.pathSymbol3DLayer[0],fill:sa,stroke:Ba}),
ha.push({shape:n.shapes.pathSymbol3DLayer[1],fill:wa,stroke:Ba});ya=ua=Math.max(ua,na)}ba.push(ha)}});return Promise.resolve(A.renderSymbol(ba,[ya,ua],{node:l&&l.node,scale:e,opacity:l&&l.opacity}))}function p(e,l){return v.apply(this,arguments)}function v(){v=B._asyncToGenerator(function*(e,l){const P="mesh-3d"===e.type;e=e.symbolLayers;var ba=O(l);const ka=l&&l.maxSize?D.pt2px(l.maxSize):null;ba=ba||I;const xa=[];let ya=0,ua=0;var za=!1;for(let Ba=0;Ba<e.length;Ba++){var Z=e.getItemAt(Ba);const ta=
[];if(!P||"fill"===Z.type){var wa=n.shapes.fill[0];switch(Z.type){case "fill":var ha=K(Z);za=Math.min(ba,ka||H);ya=Math.max(ya,za);ua=Math.max(ua,za);za=!0;var na=h(Z,0),sa="pattern"in Z&&Z.pattern;Z=d(Z);!P&&u.isSome(sa)&&"style"===sa.type&&"solid"!==sa.style&&Z&&(na=yield x(sa,Z));ta.push({shape:wa,fill:na,stroke:ha});break;case "line":Z=X(Z,0);if(u.isNone(Z))break;Z={stroke:Z,shape:wa};ya=Math.max(ya,I);ua=Math.max(ua,I);ta.push(Z);break;case "extrude":wa={join:"round",width:1,...X(Z,-.4)};ha=
h(Z,0);Z=h(Z,-.2);na=Math.min(ba,ka||H);sa=n.getExtrudeSymbolShapes(na);wa.width=1;ta.push({shape:sa[0],fill:Z,stroke:wa});ta.push({shape:sa[1],fill:Z,stroke:wa});ta.push({shape:sa[2],fill:ha,stroke:wa});Z=.7*I+.5*na;ya=Math.max(ya,I);ua=Math.max(ua,Z);break;case "water":za=d(Z),Z=k(za),wa=k(za,2),ha=k(za,3),na=n.getWaterSymbolShapes(),za=!0,ta.push({shape:na[0],fill:Z}),ta.push({shape:na[1],fill:wa}),ta.push({shape:na[2],fill:ha}),Z=Math.min(ba,ka||H),ya=Math.max(ya,Z),ua=Math.max(ua,Z)}xa.push(ta)}}return A.renderSymbol(xa,
[ya,ua],{node:l&&l.node,scale:za,opacity:l&&l.opacity})});return v.apply(this,arguments)}const I=n.SymbolSizeDefaults.size,H=n.SymbolSizeDefaults.maxSize,Y=n.SymbolSizeDefaults.maxOutlineSize,la=n.SymbolSizeDefaults.lineWidth,va=n.SymbolSizeDefaults.tallSymbolWidth,ja=N.getLogger("esri.symbols.support.previewSymbol3D");M.getPatternDescriptor=x;M.getSizeFromOptions=O;M.getSymbolLayerFill=h;M.previewSymbol3D=function(e,l){if(0===e.symbolLayers.length)return Promise.reject(new da("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(e.type){case "point-3d":return w(e,l);case "line-3d":return W(e,l);case "polygon-3d":case "mesh-3d":return p(e,l)}return Promise.reject(new da("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S){function Q(A,m,L,K,E){var k=A.data;const d=L&&y.isSome(L.portal)?L.portal:N.getDefault(),h={portal:d,url:da.urlToObject(A.baseUrl),origin:"portal-item"};k=k.items.find(X=>X.name===m);if(!k)return Promise.reject(new V("symbolstyleutils:symbol-name-not-found",`The symbol name '${m}' could not be found`,{symbolName:m}));let x=u.fromJSON(F.symbolUrlFromStyleItem(k,K),h),q=k.thumbnail&&k.thumbnail.href;const C=k.thumbnail&&k.thumbnail.imageData;z.isDevEnvironment()&&
(x=z.adjustStaticAGOUrl(x),q=z.adjustStaticAGOUrl(q));const T={portal:d,url:da.urlToObject(da.removeFile(x)),origin:"portal-item"};return F.requestJSON(x,E).then(X=>{X="cimRef"===K?F.makeCIMSymbolRef(X.data):X.data;if((X=ca.fromJSON(X,T))&&B.isSymbol3D(X)){if(q){const U=u.fromJSON(q,h);X.thumbnail=new S.Thumbnail({url:U})}else C&&(X.thumbnail=new S.Thumbnail({url:`data:image/png;base64,${C}`}));A.styleUrl?X.styleOrigin=new D({portal:L.portal,styleUrl:A.styleUrl,name:m}):A.styleName&&(X.styleOrigin=
new D({portal:L.portal,styleName:A.styleName,name:m}))}return X})}function n(A,m,L){const K=F.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,A.name),E=y.isSome(m.portal)?m.portal:N.getDefault();return F.requestJSON(K,L).then(k=>{k=F.makeCIMSymbolRef(k.data);return ca.fromJSON(k,{portal:E,url:da.urlToObject(da.removeFile(K)),origin:"portal-item"})})}M.fetchSymbolFromStyle=Q;M.resolveWebStyleSymbol=function(A,m,L,K){return A.name?A.styleName&&"Esri2DPointSymbolsStyle"===A.styleName?n(A,m,K):F.fetchStyle(A,
m,K).then(E=>Q(E,A.name,m,L,K)):Promise.reject(new V("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S,Q){function n(p,v){const I=p.length-1;return p.map((H,Y)=>ca.createStopLabel(H,Y,I,v))}function A(){A=z._asyncToGenerator(function*(p,v,I,H,Y,la){var va,ja,e=v.legendOptions;e=e&&e.customValues;const l=yield K(p,I);var P=null!=v.minSize&&null!=v.maxSize;I=v.stops&&1<v.stops.length;var ba=!!v.target;if(l&&(e||P||I&&!ba)){var ka=u.isVolumetricSymbol(l),xa=null,ya=P=null;P=ka&&!I?da.round([v.minDataValue,v.maxDataValue]):e||(yield x(v,l,H,Y));e=null==p?void 0:p.authoringInfo;
var ua=(ba="univariate-color-size"===(null==e?void 0:e.type))&&"above-and-below"===(null==e?void 0:e.univariateTheme);!P&&I&&(P=v.stops.map(ha=>ha.value),xa=v.stops.some(ha=>!!ha.label),"flow"===p.type&&(P=da.round(P)),xa&&(ya=v.stops.map(ha=>ha.label)));ka&&2<(null==(va=P)?void 0:va.length)&&!ua&&(P=[P[0],P[P.length-1]]);if(!P)return null;ba&&5!==(null==(ja=P)?void 0:ja.length)&&(P=C({minSize:P[0],maxSize:P[P.length-1]}));var za=ka?m(p,P):null,Z=u.getSymbolOutlineSize(l),wa=xa?null:n(P,la);return(yield Promise.all(P.map(function(){var ha=
z._asyncToGenerator(function*(na,sa){const Ba=ka?za[sa]:yield U(v,l,na,H,Y),ta=G(ua&&"class-breaks"===p.type?L(p,sa):l,Ba);return{value:na,symbol:ta,label:xa?ya[sa]:wa[sa],size:Ba,outlineSize:Z}});return function(na,sa){return ha.apply(this,arguments)}}()))).reverse()}});return A.apply(this,arguments)}function m(p,v){p=null==p?void 0:p.authoringInfo;const I="univariate-color-size"===(null==p?void 0:p.type);let H=[12,30];if(I){const Y=v[0],la=v[v.length-1];H=v.map(va=>12+(va-Y)/(la-Y)*18)}I&&"below"===
(null==p?void 0:p.univariateTheme)&&H.reverse();return H}function L(p,v){const I=p.classBreakInfos,H=I.length;v=2>H||!(2<=v)?I[0].symbol.clone():I[H-1].symbol.clone();p.visualVariables.some(Y=>"color"===Y.type)&&(v.type.includes("3d")?d(v):h(v));return v}function K(p,v){return E.apply(this,arguments)}function E(){E=z._asyncToGenerator(function*(p,v){if("flow"===p.type)return ca.getSymbolForFlowRenderer(p,v);if("pie-chart"===p.type){var I;return new S({color:null,outline:null!=(I=p.outline)&&I.width?
p.outline:new Q})}let H=I=null;"simple"===p.type?I=p.symbol:"class-breaks"===p.type?(I=(p=p.classBreakInfos)&&p[0]&&p[0].symbol,H=1<p.length):"unique-value"===p.type&&(I=(p=p.uniqueValueInfos)&&p[0]&&p[0].symbol,H=1<p.length);if(!I||k(I))return null;I=I.clone();if(v||H)I.type.includes("3d")?d(I):h(I);return I});return E.apply(this,arguments)}function k(p){return p?y.isSymbol3D(p)?p.symbolLayers?p.symbolLayers.some(v=>v&&"fill"===v.type):!1:p.type.includes("fill"):!1}function d(p){"line-3d"===p.type?
p.symbolLayers.forEach(v=>{v.material={color:W}}):p.symbolLayers.forEach(v=>{"icon"!==v.type||v.resource&&v.resource.href?v.material={color:w}:(v.material={color:O},v.outline={color:W,size:1.5})})}function h(p){const v=F.isDarkTheme();if("cim"===p.type)N.applyCIMSymbolColor(p,new V(w));else if(p.type.includes("line"))p.color=W;else if(p.color=v?W:O,"simple-marker"===p.type)if(p.outline){var I,H;"#ffffff"===(null==(I=p.outline)?void 0:null==(H=I.color)?void 0:H.toHex())&&(p.outline.color=W)}else p.outline=
{color:W,width:1.5}}function x(p,v,I,H){return q.apply(this,arguments)}function q(){q=z._asyncToGenerator(function*(p,v,I,H){const Y=(yield new Promise((ja,e)=>M(["../../../renderers/visualVariables/support/visualVariableUtils"],ja,e))).getSizeRangeAtScale(p,I,H),la=Y&&C(Y);if(Y||la){var va=la.map(ja=>{{const e=Y.minSize,l=Y.maxSize,P=p.minDataValue,ba=p.maxDataValue;let ka=null;ja=ka=ja<=e?P:ja>=l?ba:(ja-e)/(l-e)*(ba-P)+P}return ja});va=da.round(va);for(let ja=1;ja<va.length-1;ja++){const e=yield T(p,
v,va[ja],va[ja-1],I,H);e&&(va[ja]=e[0],la[ja]=e[1])}return va}});return q.apply(this,arguments)}function C(p){const v=p.minSize;p=(p.maxSize-v)/4;const I=[];for(let H=0;5>H;H++)I.push(v+p*H);return I}function T(p,v,I,H,Y,la){return X.apply(this,arguments)}function X(){X=z._asyncToGenerator(function*(p,v,I,H,Y,la){const va=yield U(p,v,I,Y,la);H=yield U(p,v,H,Y,la);var ja=da.numDigits(I),e=ja.fractional,l=ja.integer;let P=ja=null;0<I&&1>I&&(ja=10**e,I*=ja,l=da.numDigits(I).integer);for(e=l-1;0<=e;e--){var ba=
10**e;l=Math.floor(I/ba)*ba;ba*=Math.ceil(I/ba);null!=ja&&(l/=ja,ba/=ja);let ka=(l+ba)/2;[,ka]=da.round([l,ka,ba],{indexes:[1]});const xa=yield U(p,v,l,Y,la),ya=yield U(p,v,ba,Y,la),ua=yield U(p,v,ka,Y,la),za=da.percentChange(va,xa,H,null),Z=da.percentChange(va,ya,H,null),wa=da.percentChange(va,ua,H,null);let ha=20>=za.previous,na=20>=Z.previous;ha&&na&&(za.previous<=Z.previous?(ha=!0,na=!1):(na=!0,ha=!1));ha?P=[l,xa]:na?P=[ba,ya]:20>=wa.previous&&(P=[ka,ua]);if(P)break}return P});return X.apply(this,
arguments)}function U(p,v,I,H,Y){return f.apply(this,arguments)}function f(){f=z._asyncToGenerator(function*(p,v,I,H,Y){const {getSize:la}=yield new Promise((va,ja)=>M(["../../../renderers/visualVariables/support/visualVariableUtils"],va,ja));return la(p,I,{scale:H,view:Y,shape:"simple-marker"===v.type?v.style:null})});return f.apply(this,arguments)}function G(p,v){p=p.clone();if(y.isSymbol3D(p))u.isVolumetricSymbol(p)||p.symbolLayers.forEach(I=>{"fill"!==I.type&&(I.size=v)});else if("esri.symbols.SimpleMarkerSymbol"===
p.declaredClass)p.size=v;else if("esri.symbols.PictureMarkerSymbol"===p.declaredClass){const I=p.width,H=p.height;p.height=v;p.width=I/H*v}else"esri.symbols.SimpleLineSymbol"===p.declaredClass?p.width=v:"esri.symbols.TextSymbol"===p.declaredClass&&p.font&&(p.font.size=v);return p}const O=[255,255,255],w=[200,200,200],W=[128,128,128];B.REAL_WORLD_MAX_SIZE=30;B.REAL_WORLD_MIN_SIZE=12;B.getRampStops=function(p,v,I,H,Y,la){return A.apply(this,arguments)};Object.defineProperties(B,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../core/maybe ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(M,B,z,V,y,da,N){M.formatDateLabel=function(u){return V.formatDate(new Date(u),da.timelineDateFormatOptions)};M.formatNumberLabel=function(u){const ca=Math.floor(Math.log10(Math.abs(u)))+1;return y.formatNumber(u,
{notation:1E6<=Math.abs(u)?"compact":"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>ca||6<ca?4:ca})};M.getDeviationValues=function(u,ca,D){if(z.isNone(ca)||z.isNone(u))return[];const F=[];for(let S=-1*D;S<=D;S++)0!==S&&F.push(ca+S*u);return F};M.getDynamicPathForSizeStops=function(u){const {max:ca,min:D,padding:F,pathHeight:S,pathWidth:Q,stops:n}=u,A=ca-D;let m=`M0 0 L${Q} 0 `,L;u=3===n.length?[n[0],n[1],n[2]]:[n[0],n[2],n[4]];const K=Math.min.apply(Math,u.map(k=>k.size)),E=Math.max(Math.abs(u[0].size-
u[1].size),Math.abs(u[2].size-u[1].size));u.reverse();u.forEach(({size:k,value:d},h)=>{d=Math.round(S-(d-D)/A*S);L=Math.round((k-K)/E*100)/100*Q;0===L&&(L=F*Q);0===h&&(m+=`L${L} 0 `);m+=`L${L} ${d} `});return m+=`L${L} ${S} L0 ${S} L0 0 Z`};M.getFillFromColor=function(u){return u instanceof B?u.toCss(!0):B.fromString(u).toCss(!0)};M.getPathForSizeStops=function(u){const {bottomValue:ca,bottomWidth:D,max:F,min:S,pathHeight:Q,pathWidth:n,topValue:A,topWidth:m}=u;u=m*n;const L=D*n,K=F-S;return`M${u} 0 L${u} ${Math.round(Q-
(A-S)/K*Q)} L${L} ${Math.round(Q-(ca-S)/K*Q)} L${L} ${Q} L0 ${Q} L0 0 Z`};M.getSizesFromVariable=function(u){let ca=u.maxSize;u=u.minSize;ca instanceof N&&(ca=ca.stops[0].size);u instanceof N&&(u=u.stops[0].size);return[ca,u]};M.getStopChanges=function(u,ca,D){const F=D.length-1,S=D[0],Q=D[F]-S,n=ca-u,A=[];for(let m=1;m<F;m++)A.push({index:m,value:(D[m]-S)/Q*n+u});A.unshift({index:0,value:u});A.push({index:F,value:ca});return A};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/Handles ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S,Q,n,A,m,L,K,E,k,d,h,x){var q;(function(T){T.Auto="auto";T.Stack="stack";T.SideBySide="side-by-side"})(q||(q={}));const C=window.devicePixelRatio;z=function(T){function X(f,G){f=T.call(this,f,G)||this;f._handles=new V;f._hasIndicators=!1;f._selectedSectionName=null;f._sectionNames=[];f._sectionMap=new Map;f.activeLayerInfos=null;f.headingLevel=3;f.layout=q.Stack;f.messages=null;f.messagesCommon=null;f.type="card";f.view=null;return f}M._inheritsLoose(X,T);var U=X.prototype;
U.initialize=function(){this.own(y.watch(()=>this.activeLayerInfos,f=>{this._handles.removeAll();this._watchForSectionChanges(f)}))};U.destroy=function(){this._handles.destroy();this._handles=null};U.render=function(){this._hasIndicators=this.layout===q.Auto&&768>=this.view.container.clientWidth||this.layout===q.Stack;var f=this.activeLayerInfos;f=f&&f.toArray().map(w=>this._renderLegendForLayer(w)).filter(w=>!!w);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||
(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const G=this._sectionNames.length;var O=this._sectionNames.map((w,W)=>{W=x.substitute(this.messagesCommon.pagination.pageText,{index:W+1,total:G});return d.tsx("div",{key:w,role:"tab",id:w,"aria-label":W,"aria-controls":`${w}-panel`,"aria-selected":(this._selectedSectionName===w).toString(),tabIndex:this._selectedSectionName===w?0:-1,title:W,onclick:this._selectSection,onkeydown:this._focusSection,
bind:this,class:this.classes("esri-legend--card__carousel-indicator",{["esri-legend--card__carousel-indicator--activated"]:this._selectedSectionName===w}),"data-section-name":w})});O=this._hasIndicators&&1<G?d.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation",role:"tablist"},O):null;f=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):f&&f.length?f:null;return d.tsx("div",{class:this.classes("esri-legend--card",{["esri-legend--stacked"]:this._hasIndicators})},
f?f:d.tsx("div",{class:"esri-legend--card__message"},this.messages.noLegend),O)};U._selectSection=function(f){if(f=f.target.getAttribute("data-section-name"))this._selectedSectionName=f};U._focusSection=function(f){switch(f.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(f);break;case "Enter":case " ":this._selectSection(f)}};U._switchSectionOnArrowPress=function(f){const G=f.key,O="ArrowLeft"===G?-1:1;f=f.target.getAttribute("data-section-name");f=this._sectionNames.indexOf(f);
const w=this._sectionNames;let W=null;-1!==f&&(w[f+O]?W=document.getElementById(w[f+O]):"ArrowLeft"===G?W=document.getElementById(w[w.length-1]):"ArrowRight"===G&&(W=document.getElementById(w[0])),W&&W.focus())};U._watchForSectionChanges=function(f){this._generateSectionNames();f&&(f.forEach(G=>{const O=`activeLayerInfo-${G.layer.uid}-version-change`;this._handles.remove(O);this._watchForSectionChanges(G.children);this._handles.add(y.watch(()=>G.version,()=>this._generateSectionNames()),O)}),this._handles.remove("activeLayerInfos-collection-change"),
this._handles.add(f.on("change",()=>this._watchForSectionChanges(f)),"activeLayerInfos-collection-change"))};U._generateSectionNames=function(){this._sectionNames.length=0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};U._getSectionName=function(f,G,O){return`${this.id}${f.uid}-type-${G.type}-${O}`};U._generateSectionNamesForActiveLayerInfo=function(f){f.children.forEach(this._generateSectionNamesForActiveLayerInfo,
this);f.legendElements&&f.legendElements.forEach((G,O)=>{this._sectionNames.push(this._getSectionName(f.layer,G,O))})};U._renderLegendForLayer=function(f){if(!f.ready)return null;if(f.children.length){var G=f.children.map(O=>this._renderLegendForLayer(O)).toArray();return d.tsx("div",{key:f.layer.uid,class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},d.tsx("div",{class:"esri-legend--card__service-caption-container"},f.title),G)}{if((G=f.legendElements)&&!G.length)return null;
const O=G.some(w=>"relationship-ramp"===w.type);G=G.map((w,W)=>this._renderLegendForElement(w,f,W,O)).filter(w=>!!w);return G.length?d.tsx("div",{key:f.layer.uid,class:this.classes("esri-legend--card__service",{["esri-legend--card__group-layer-child"]:!!f.parent})},d.tsx("div",{class:"esri-legend--card__service-caption-container"},d.tsx("div",{class:"esri-legend--card__service-caption-text"},f.title)),d.tsx("div",{class:"esri-legend--card__service-content"},G)):null}};U._renderLegendForElement=function(f,
G,O,w=!1){var W="color-ramp"===f.type,p="opacity-ramp"===f.type,v="size-ramp"===f.type;const I=G.layer;var H=null;"string"===typeof f.title?H=f.title:f.title&&(H=f.title,W=L.getTitle(this.messages,H,W||p),H=H.title?`${H.title} (${W})`:W);O=this._getSectionName(I,f,O);W=this._hasIndicators?d.tsx("div",null,d.tsx(K.Heading,{level:this.headingLevel,class:"esri-legend--card__carousel-title"},G.title),d.tsx(K.Heading,{level:K.incrementHeadingLevel(this.headingLevel),class:"esri-legend--card__layer-caption"},
H)):H?d.tsx(K.Heading,{level:this.headingLevel,class:"esri-legend--card__layer-caption"},H):null;H=G.effectList;p=null;"symbol-table"===f.type?(v=f.infos.map((Y,la)=>this._renderLegendForElementInfo(Y,G,f.legendType,la)).filter(Y=>!!Y),v.length&&(p=d.tsx("div",{class:this.classes({["esri-legend--card__label-container"]:!(v[0].properties.classes&&v[0].properties.classes["esri-legend--card__symbol-row"])&&!w,["esri-legend--card__relationship-label-container"]:w})},v))):"color-ramp"===f.type||"opacity-ramp"===
f.type||"heatmap-ramp"===f.type?p=this._renderLegendForRamp(f,I.opacity,H):v?p=this._renderSizeRamp(f,I.opacity):"pie-chart-ramp"===f.type?p=this._renderPieChartRamp(f):"relationship-ramp"===f.type?p=A.renderRelationshipRamp(f,this.id,I.opacity,H):"univariate-above-and-below-ramp"===f.type?p=this._renderUnivariateAboveAndBelowRamp(f,I.opacity,H):"univariate-color-size-ramp"===f.type&&(p=this._renderUnivariateColorSizeRamp(f,I.opacity,H));if(!p)return null;w=d.tsx("div",{key:O,class:"esri-legend--card__section",
id:`${O}-panel`,role:"tabpanel","aria-labelledby":O,tabIndex:0},[W,p]);this._sectionMap.set(O,w);return w};U._renderPieChartRamp=function(f){return d.tsx("div",{class:"esri-legend--card__pie-chart-ramp-preview",bind:f.preview,afterCreate:L.attachToNode})};U._renderUnivariateAboveAndBelowRamp=function(f,G,O){const {sizeRampElement:w,colorRampElement:W}=m.getUnivariateAboveAndBelowRampElements(f,G,"horizontal");if(!w)return null;f=m.getUnivariateSizeRampSize(w,"full",!0,"horizontal");var p=m.getUnivariateColorRampSize(w,
"above",!0,"horizontal"),v=m.getUnivariateColorRampSize(w,"below",!0,"horizontal");p=m.getUnivariateColorRampPreview(W,{width:p,height:12,rampAlignment:"horizontal",opacity:G,type:"above",effectList:O});G=m.getUnivariateColorRampPreview(W,{width:v,height:12,rampAlignment:"horizontal",opacity:G,type:"below",effectList:O});O=m.getUnivariateColorRampMargin(w,"card");v=w.infos.map(Y=>Y.label);const I=v.length-1;v=v.map((Y,la)=>0===la||la===I?d.tsx("div",{key:la},Y):null);const H={marginTop:"3px",display:"flex"};
h.isRTL(this.container)?H.marginRight=`${O}px`:H.marginLeft=`${O}px`;f={width:`${f}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return d.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},d.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},w.infos.map((Y,la)=>d.tsx("div",{key:la,class:"esri-legend--card__symbol",
bind:Y.preview,afterCreate:L.attachToNode}))),p?d.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:H,key:"color-ramp-preview"},d.tsx("div",{bind:p,afterCreate:L.attachToNode}),d.tsx("div",{bind:G,afterCreate:L.attachToNode})):null,d.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},d.tsx("div",{class:"esri-legend__ramp-labels",styles:f},v)))};U._renderUnivariateColorSizeRamp=function(f,G,O){const {sizeRampElement:w,colorRampElement:W}=m.getUnivariateColorSizeRampElements(f,
"horizontal");if(!w)return null;f=m.getUnivariateSizeRampSize(w,"full",!1,"horizontal");var p=m.getUnivariateColorRampSize(w,"full",!1,"horizontal");G=m.getUnivariateColorRampPreview(W,{width:p,height:12,rampAlignment:"horizontal",opacity:G,type:"full",effectList:O});const v=m.getUnivariateColorRampMargin(w,"card"),I=w.infos.length-1;O=w.infos.map((H,Y)=>0===Y||Y===I?d.tsx("div",{key:Y},H.label):null);p={marginTop:"3px",display:"flex"};h.isRTL(this.container)?p.marginRight=`${v}px`:p.marginLeft=`${v}px`;
f={width:`${f}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return d.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},d.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},w.infos.map((H,Y)=>d.tsx("div",{key:Y,class:"esri-legend--card__symbol",bind:H.preview,afterCreate:L.attachToNode}))),d.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",
styles:p,key:"color-ramp-preview"},d.tsx("div",{bind:G,afterCreate:L.attachToNode})),d.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},d.tsx("div",{class:"esri-legend__ramp-labels",styles:f},O)))};U._renderLegendForElementInfo=function(f,G,O,w){var W=G.layer;if(f.type)return this._renderLegendForElement(f,G,w);O=L.isImageryStretchedLegend(W,O);if(f.preview){var p;if(!f.symbol||!f.symbol.type.includes("simple-fill")){if(!f.label)return d.tsx("div",{key:w,bind:f.preview,afterCreate:L.attachToNode});
G={["esri-legend--card__symbol-cell"]:this._hasIndicators};return d.tsx("div",{key:w,class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__symbol-row"]:this._hasIndicators})},d.tsx("div",{class:this.classes(G),bind:f.preview,afterCreate:L.attachToNode}),d.tsx("div",{class:this.classes("esri-legend--card__image-label",{["esri-legend--card__label-cell"]:this._hasIndicators})},L.getTitle(this.messages,f.label,!1)||""))}let I=O=255,H=255,Y=0,la=255,va=255,ja=255,e=0;const l=f.symbol.color&&
f.symbol.color.a,P=f.symbol.outline&&f.symbol.outline.color&&f.symbol.outline.color.a;l&&(O=f.symbol.color.r,I=f.symbol.color.g,H=f.symbol.color.b,Y=f.symbol.color.a*W.opacity);P&&(la=f.symbol.outline.color.r,va=f.symbol.outline.color.g,ja=f.symbol.outline.color.b,e=f.symbol.outline.color.a*W.opacity);var v=(W=null!=(v=null==(p=f.symbol.color)?void 0:p.isBright)?v:!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";G={background:l?`rgba(${O}, ${I}, ${H}, ${Y})`:"none",color:W?"black":"white",textShadow:`-1px -1px 0 ${v},\n                                              1px -1px 0 ${v},\n                                              -1px 1px 0 ${v},\n                                              1px 1px 0 ${v}`,
border:P?`1px solid rgba(${la}, ${va}, ${ja}, ${e})`:"none",filter:Q.getCSSFilterFromEffectList(G.effectList)};return d.tsx("div",{key:w,class:"esri-legend--card__layer-row"},d.tsx("div",{class:"esri-legend--card__label-element",styles:G}," ",f.label," "))}if(f.src)return G=this._renderImage(f,W,O),d.tsx("div",{key:w,class:"esri-legend--card__layer-row"},G,d.tsx("div",{class:"esri-legend--card__image-label"},f.label||""))};U._renderImage=function(f,G,O){const {label:w,src:W,opacity:p}=f;O={["esri-legend--card__imagery-layer-image--stretched"]:O,
["esri-legend--card__symbol"]:!O};G={opacity:`${null!=p?p:G.opacity}`};return d.tsx("img",{alt:L.getTitle(this.messages,w,!1),src:W,border:0,width:f.width,height:f.height,class:this.classes(O),styles:G})};U._renderSizeRampLines=function(f){f=f.infos;var G=f[0],O=f[f.length-1],w=G.symbol;f=this._hasIndicators;G=da.pt2px(G.size+G.outlineSize)*C;O=da.pt2px(O.size+O.outlineSize)*C;const W=f?G:G+50*C,p=f?G/2+50*C:G;var v;w?w.type.includes("3d")?(v=w.symbolLayers&&w.symbolLayers.length)?(v=w.symbolLayers.getItemAt(v-
1).get("resource.primitive"),v="triangle"===v||"cone"===v||"tetrahedron"===v):v=void 0:v="triangle"===w.style:v=void 0;if(w)if(w.type.includes("3d")){var I=w.symbolLayers&&w.symbolLayers.length;I?(w=w.symbolLayers.getItemAt(I-1),w=w.resource&&w.resource.primitive,w="circle"===w||"cross"===w||"kite"===w||"sphere"===w||"cube"===w||"diamond"===w):w=void 0}else w=w.style,w="circle"===w||"diamond"===w||"cross"===w;else w=void 0;I=document.createElement("canvas");I.width=W;I.height=p;I.style.width=`${I.width/
C}px`;I.style.height=`${I.height/C}px`;const H=I.getContext("2d");if(f){H.beginPath();var Y=W/2-O/2;H.moveTo(0,0);H.lineTo(Y,p);Y=W/2+O/2;H.moveTo(W,0);H.lineTo(Y,p)}else H.beginPath(),H.moveTo(0,p/2-O/2),H.lineTo(W,0),H.moveTo(0,p/2+O/2),H.lineTo(W,p);H.strokeStyle="#ddd";H.stroke();return d.tsx("div",{bind:I,afterCreate:L.attachToNode,styles:f?{display:"flex",marginTop:`-${v?0:w?G/2:0}px`,marginBottom:`-${v?O:w?O/2:0}px`}:{display:"flex",marginRight:`-${v?0:w?G/2:0}px`,marginLeft:`-${v?0:w?O/2:
0}px`}})};U._renderSizeRamp=function(f,G){var O=f.infos;const w=O[0].label,W=O[O.length-1].label;let p=O[0].preview;O=O[O.length-1].preview;const v=this._hasIndicators,I={"flex-direction":v?"column":"row-reverse"};p&&(p=p.cloneNode(!0),p.style.display="flex");O&&(O=O.cloneNode(!0),O.style.display="flex");G={opacity:null!=G?`${G}`:""};return d.tsx("div",{class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__size-ramp-row"]:v})},d.tsx("div",{class:"esri-legend--card__ramp-label"},
v?w:W),d.tsx("div",{class:"esri-legend--card__size-ramp-container",styles:I},d.tsx("div",{bind:p,afterCreate:L.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:G}),this._renderSizeRampLines(f),d.tsx("div",{bind:O,afterCreate:L.attachToNode,class:"esri-legend--card__size-ramp-container",styles:G})),d.tsx("div",{class:"esri-legend--card__ramp-label"},v?W:w))};U._renderLegendForRamp=function(f,G,O){var w=f.infos;const W="heatmap-ramp"===f.type,p=w.length-1;var v=2<p&&!W?25*p:100,I=v+
20;const H=w.slice(0).reverse();H.forEach((va,ja)=>{va.offset=W?va.ratio:ja/p});const Y=H.length-1;f=(f=0!==H.length%2&&H[H.length/2|0])&&d.tsx("div",{class:"esri-legend--card__interval-separators-container"},d.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),d.tsx("div",{class:"esri-legend--card__ramp-label"},f.label));const la=w[w.length-1].label;w=w[0].label;v=S.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:H[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,
y:0,width:v,height:25},fill:{type:"linear",x1:10,y1:0,x2:v+10,y2:0,colors:H},stroke:{width:0}},{shape:{type:"path",path:`M${v+10} 0 L${I} ${12.5} L${v+10} ${25} Z`},fill:H[Y].color,stroke:{width:0}}]],I,25);({messages:I}=this);G={filter:Q.getCSSFilterFromEffectList(O),opacity:null==G?null:`${G}`};return d.tsx("div",{class:"esri-legend--card__layer-row",styles:{justifyContent:"center"}},d.tsx("div",{class:"esri-legend--card__ramp-label"},W?I[la]:la),d.tsx("div",{class:"esri-legend--card__symbol-container"},
d.tsx("div",{styles:G},v),f),d.tsx("div",{class:"esri-legend--card__ramp-label"},W?I[w]:w))};return X}(n);B.__decorate([N.property()],z.prototype,"activeLayerInfos",void 0);B.__decorate([N.property()],z.prototype,"headingLevel",void 0);B.__decorate([N.property()],z.prototype,"layout",void 0);B.__decorate([N.property(),k.messageBundle("esri/widgets/Legend/t9n/Legend")],z.prototype,"messages",void 0);B.__decorate([N.property(),k.messageBundle("esri/t9n/common")],z.prototype,"messagesCommon",void 0);
B.__decorate([N.property({readOnly:!0})],z.prototype,"type",void 0);B.__decorate([N.property()],z.prototype,"view",void 0);B.__decorate([E.accessibleHandler()],z.prototype,"_selectSection",null);return z=B.__decorate([F.subclass("esri.widgets.Legend.styles.Card")],z)})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(M,
B,z,V,y){function da(ca,D,F){const S=`${F}_arrowStart`;F=`${F}_arrowEnd`;ca="left"===ca;const Q={markerStart:null,markerEnd:null};switch(D){case "HL":ca?Q.markerStart=`url(#${F})`:Q.markerEnd=`url(#${S})`;break;case "LL":Q.markerStart=`url(#${F})`;break;case "LH":ca?Q.markerEnd=`url(#${S})`:Q.markerStart=`url(#${F})`;break;default:Q.markerEnd=`url(#${S})`}return Q}function N(ca,D,F,S,Q=60){const {focus:n,numClasses:A,colors:m,rotation:L}=ca;ca=!!n;const K=Math.sqrt(Q**2+Q**2)+(ca?0:5),E=[],k=[];var d=
[],h=(Q||75)/A;for(var x=0;x<A;x++){var q=x*h;for(var C=0;C<A;C++){var T=C*h;const X=B.generateFillAttributes(m[x][C]),U=B.generateStrokeAttributes(null);T={type:"rect",x:T,y:q,width:h,height:h};E.push(B.renderDef(X));k.push(B.renderShape(T,X.fill,U,null));d.push(B.getBoundingBox(T))}}h=null;ca||(h="margin: -15px -15px -18px -15px");x=da("left",n,D);q=da("right",n,D);C=B.computeBBox(d);d=B.getTransformMatrix(C,K,K,0,!1,L,!1);C=B.getTransformMatrix(C,K,K,0,!1,ca?-45:null,!1);F={filter:z.getCSSFilterFromEffectList(S),
opacity:null==F?null:`${F}`};return y.tsx("div",{styles:F,class:ca?u.diamondMidColRamp:u.squareTableCell},y.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:K,height:K,style:h},y.tsx("defs",null,y.tsx("marker",{id:`${D}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},y.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),y.tsx("marker",{id:`${D}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",
markerUnits:"strokeWidth",orient:"auto"},y.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),E),y.tsx("g",{transform:d},k),y.tsx("g",{transform:C},y.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":x.markerStart,"marker-end":x.markerEnd,x1:-10,y1:Q-15,x2:-10,y2:15}),y.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":q.markerStart,"marker-end":q.markerEnd,x1:15,y1:Q+10,x2:Q-15,y2:Q+10}))))}const u={diamondContainer:"esri-relationship-ramp--diamond__container",
diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",
squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};M.renderRelationshipRamp=function(ca,D,F,S){const {focus:Q,labels:n}=ca,A=!!Q;ca=N(ca,D,F,S);D={justifyContent:"center"};
F=V.isRTL();return A?y.tsx("div",{class:u.diamondContainer,styles:D},y.tsx("div",{class:u.diamondLeftCol},F?n.right:n.left),y.tsx("div",{class:u.diamondMidCol},y.tsx("div",{class:u.diamondMidColLabel},n.top),ca,y.tsx("div",{class:u.diamondMidColLabel},n.bottom)),y.tsx("div",{class:u.diamondRightCol},F?n.left:n.right)):y.tsx("div",{class:u.squareTable},y.tsx("div",{class:u.squareTableRow},y.tsx("div",{class:V.classes(u.squareTableCell,u.squareTableLabel,u.squareTableLabelRightBottom)},F?n.top:n.left),
y.tsx("div",{class:u.squareTableCell}),y.tsx("div",{class:V.classes(u.squareTableCell,u.squareTableLabel,u.squareTableLabelLeftBottom)},F?n.left:n.top)),y.tsx("div",{class:u.squareTableRow},y.tsx("div",{class:u.squareTableCell}),ca,y.tsx("div",{class:u.squareTableCell})),y.tsx("div",{class:u.squareTableRow},y.tsx("div",{class:V.classes(u.squareTableCell,u.squareTableLabel,u.squareTableLabelRightTop)},F?n.right:n.bottom),y.tsx("div",{class:u.squareTableCell}),y.tsx("div",{class:V.classes(u.squareTableCell,
u.squareTableLabel,u.squareTableLabelLeftTop)},F?n.bottom:n.right)))};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),function(M,B,z,V,y,da,N){function u(n="vertical"){return"vertical"===
n?N.tsx("svg",{height:"4",width:"10"},N.tsx("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):N.tsx("svg",{height:"10",width:"10"},N.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function ca(n,A="vertical"){const m=document.createElement("div");m.style.height="20px";m.className=Q.univariateAboveAndBelowSymbol;null!=n&&(m.style.opacity=n.toString());S.append(m,u.bind(null,A));return m}function D(n,A,m="vertical",
L){n.infos.forEach((K,E)=>{if(L&&2===E)K.preview=ca(A,m);else{E=B.pt2px(K.size)+("horizontal"===m?20:10);const k="div"===K.preview.tagName.toLowerCase(),d=k?K.preview:document.createElement("div");d.className=Q.univariateAboveAndBelowSymbol;"horizontal"===m?d.style.width=`${E}px`:d.style.height=`${E}px`;k||d.appendChild(K.preview);K.preview=d}})}function F(n,A,m,L="vertical"){let K=0;n=n.infos;const E=Math.floor(n.length/2);var k="full"===A||"above"===A?0:E;for(A="full"===A||"below"===A?n.length-
1:E;k<=A;k++)if(m&&k===E)K+="horizontal"===L?10:20;else{const d=B.pt2px(n[k].size)+("horizontal"===L?20:10);K+=d}return Math.round(K)}const S=V.createProjector(),Q={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};M.getUnivariateAboveAndBelowRampElements=function(n,A,m="vertical"){var L=n.infos;n=L.find(({type:k})=>"size-ramp"===k);L=L.find(({type:k})=>"color-ramp"===k);n&&(n={...n},n.infos=[...n.infos],D(n,A,m,!0));L&&(L={...L},L.infos=
[...L.infos]);if("horizontal"===m){var K,E;null==(K=n)?void 0:K.infos.reverse();null==(E=L)?void 0:E.infos.reverse()}return{sizeRampElement:n,colorRampElement:L}};M.getUnivariateColorRampMargin=function(n,A="classic"){n=n.infos;return"classic"===A?(B.pt2px(n[0].size)+10)/2:(B.pt2px(n[0].size)-B.pt2px(n[n.length-1].size))/2};M.getUnivariateColorRampPreview=function(n,A){if(!n)return null;n=n.infos.map(m=>m.color);n=y.renderColorRampPreviewHTML("full"===A.type?n:"above"===A.type?n.slice(0,3):n.slice(2,
5),{width:A.width,height:A.height,align:A.rampAlignment,effectList:A.effectList});n.className=Q.colorRamp;null!=A.opacity&&(n.style.opacity=A.opacity.toString());return n};M.getUnivariateColorRampSize=function(n,A,m,L="vertical"){const K=F(n,A,m,L);n=n.infos;var E=Math.floor(n.length/2);const k="full"===A||"above"===A?0:E;E="full"===A||"below"===A?n.length-1:E;m=m?"vertical"===L?20:10:0;L="vertical"===L?10*("full"===A?2:1):20*("full"===A?2:1);return Math.round(K-(B.pt2px("full"===A?n[k].size+n[E].size:
"above"===A?n[k].size:n[E].size)/2+m/2+L/2))};M.getUnivariateColorSizeRampElements=function(n,A="vertical"){var m=n.infos;n=m.find(({type:E})=>"size-ramp"===E);m=m.find(({type:E})=>"color-ramp"===E);n&&(n={...n},n.infos=[...n.infos],D(n,null,A,!1));m&&(m={...m},m.infos=[...m.infos]);if("horizontal"===A){var L,K;null==(L=n)?void 0:L.infos.reverse();null==(K=m)?void 0:K.infos.reverse()}return{sizeRampElement:n,colorRampElement:m}};M.getUnivariateSizeRampSize=F;Object.defineProperties(M,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../intl/substitute"],function(M,B,z){M.attachToNode=function(V){V.appendChild(this)};M.getTitle=function(V,y,da){if(y){if("string"===typeof y||"number"===typeof y)return y;if("value"in y||"unit"in y)return z.substitute(V.dotValue,y);if("colorName"in y||"bandName"in y)return V[y.colorName]+": "+(V[y.bandName]||y.bandName);if("showCount"in y)return y.showCount?V.clusterCountTitle:
null;var N=null;da?N=y.ratioPercentTotal?"showRatioPercentTotal":y.ratioPercent?"showRatioPercent":y.ratio?"showRatio":y.normField?"showNormField":y.field?"showField":null:da||(N=y.normField?"showNormField":y.normByPct?"showNormPct":y.field?"showField":null);return N?z.substitute("showField"===N?"{field}":V[N],{field:y.field,normField:y.normField}):null}};M.isImageryStretchedLegend=function(V,y){return!!(y&&"Stretched"===y&&10.3<=V.version&&"esri.layers.ImageryLayer"===V.declaredClass)};M.isRendererTitle=
function(V,y){return!y};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(M,B,z,V,y,da,N,u,ca,D,F,S,Q,n,A,m,L){const K={display:"flex",alignItems:"flex-start"},E={marginLeft:"3px"},k={display:"table-cell",verticalAlign:"middle"};z=function(d){function h(q,C){q=d.call(this,q,C)||this;q.activeLayerInfos=null;q.headingLevel=3;q.messages=null;q.type="classic";return q}M._inheritsLoose(h,d);var x=h.prototype;x.render=function(){var q=this.activeLayerInfos;q=q&&q.toArray().map(C=>this._renderLegendForLayer(C)).filter(C=>!!C);return m.tsx("div",null,q&&q.length?q:m.tsx("div",
{class:"esri-legend__message"},this.messages.noLegend))};x._renderLegendForLayer=function(q){if(!q.ready)return null;var C=!!q.children.length;const T=`${"esri-legend__"}${q.layer.uid}-version-${q.version}`,X=q.title?Q.Heading({level:this.headingLevel,class:this.classes("esri-widget__heading","esri-legend__service-label")},q.title):null;if(C)return C=q.children.map(U=>this._renderLegendForLayer(U)).toArray(),m.tsx("div",{key:T,class:this.classes("esri-legend__service","esri-legend__group-layer")},
X,C);if((C=q.legendElements)&&!C.length)return null;C=C.map(U=>this._renderLegendForElement(U,q.layer,q.effectList)).filter(U=>!!U);return C.length?m.tsx("div",{key:T,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!q.parent}),tabIndex:0},X,m.tsx("div",{class:"esri-legend__layer"},C)):null};x._renderLegendForElement=function(q,C,T,X){var U="color-ramp"===q.type,f="opacity-ramp"===q.type;const G="size-ramp"===q.type;let O=null;if("symbol-table"===q.type||G){var w=q.infos.map(p=>
this._renderLegendForElementInfo(p,C,T,G,q.legendType)).filter(p=>!!p);w.length&&(O=m.tsx("div",{class:"esri-legend__layer-body"},w))}else"color-ramp"===q.type||"opacity-ramp"===q.type||"heatmap-ramp"===q.type||"stretch-ramp"===q.type?O=this._renderLegendForRamp(q,C.opacity):"relationship-ramp"===q.type?O=D.renderRelationshipRamp(q,this.id,C.opacity,T):"pie-chart-ramp"===q.type?O=this._renderPieChartRamp(q):"univariate-above-and-below-ramp"===q.type?O=this._renderUnivariateAboveAndBelowRamp(q,C.opacity,
T):"univariate-color-size-ramp"===q.type&&(O=this._renderUnivariateColorSizeRamp(q,C.opacity,T));if(!O)return null;w=q.title;var W=null;"string"===typeof w?W=w:w&&(W=S.getTitle(this.messages,w,U||f),W=S.isRendererTitle(w,U||f)&&w.title?`${w.title} (${W})`:W);U=X?"esri-legend__layer-child-table":"esri-legend__layer-table";f=W?m.tsx("div",{class:"esri-legend__layer-caption"},W):null;return m.tsx("div",{class:this.classes(U,{["esri-legend__layer-table--size-ramp"]:G||!X})},f,O)};x._renderPieChartRamp=
function(q){return m.tsx("div",{bind:q.preview,afterCreate:S.attachToNode})};x._renderUnivariateAboveAndBelowRamp=function(q,C,T){const {sizeRampElement:X,colorRampElement:U}=F.getUnivariateAboveAndBelowRampElements(q,C);if(!X)return null;var f=F.getUnivariateColorRampSize(X,"above",!0);q=F.getUnivariateColorRampSize(X,"below",!0);const G=F.getUnivariateColorRampPreview(U,{width:12,height:f,rampAlignment:"vertical",opacity:C,type:"above",effectList:T});C=F.getUnivariateColorRampPreview(U,{width:12,
height:q,rampAlignment:"vertical",opacity:C,type:"below",effectList:T});var O=F.getUnivariateColorRampMargin(X);const w=X.infos.map(H=>H.label);T=w.map((H,Y)=>{const la=2===Y;return 0===Y?m.tsx("div",{key:Y,class:H?G?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},H):la?m.tsx("div",null):null});const W=w.length-1,p=Math.floor(w.length/2),v=w.map((H,Y)=>{const la=Y===W;return Y===p||la?m.tsx("div",{key:Y,class:H?G?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":
null},H):null}),I={display:"table-cell",verticalAlign:"middle"};O={marginTop:`${O}px`};f={height:`${f}px`};q={height:`${q}px`};return m.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:K},m.tsx("div",{class:"esri-legend__layer-body"},X.infos.map((H,Y)=>m.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},m.tsx("div",{class:"esri-legend__symbol",styles:I,bind:H.preview,afterCreate:S.attachToNode}),G||0!==Y%2?null:m.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},
w[Y])))),G?m.tsx("div",{styles:O,key:"color-ramp-preview"},m.tsx("div",{styles:E},m.tsx("div",{styles:k},m.tsx("div",{class:"esri-legend__ramps",bind:G,afterCreate:S.attachToNode})),m.tsx("div",{styles:k},m.tsx("div",{class:"esri-legend__ramp-labels",styles:f},T))),m.tsx("div",{styles:E},m.tsx("div",{styles:k},m.tsx("div",{class:"esri-legend__ramps",bind:C,afterCreate:S.attachToNode})),m.tsx("div",{styles:k},m.tsx("div",{class:"esri-legend__ramp-labels",styles:q},v)))):null)};x._renderUnivariateColorSizeRamp=
function(q,C,T){const {sizeRampElement:X,colorRampElement:U}=F.getUnivariateColorSizeRampElements(q);if(!X)return null;var f=F.getUnivariateColorRampMargin(X);q=F.getUnivariateColorRampSize(X,"full",!1);C=F.getUnivariateColorRampPreview(U,{width:12,height:q,rampAlignment:"vertical",opacity:C,type:"full",effectList:T});const G=X.infos.length-1;T=X.infos.map((w,W)=>0===W||W===G?m.tsx("div",{key:W,class:w.label?U?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},w.label):
null);const O={display:"table-cell",verticalAlign:"middle"};f={marginTop:`${f}px`};q={height:`${q}px`};return m.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:K},m.tsx("div",{class:"esri-legend__layer-body"},X.infos.map(w=>m.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},m.tsx("div",{class:"esri-legend__symbol",styles:O,bind:w.preview,afterCreate:S.attachToNode})))),m.tsx("div",{styles:f,key:"color-ramp-preview"},m.tsx("div",{styles:E},m.tsx("div",
{styles:k},m.tsx("div",{class:"esri-legend__ramps",bind:C,afterCreate:S.attachToNode})),m.tsx("div",{styles:k},m.tsx("div",{class:"esri-legend__ramp-labels",styles:q},T)))))};x._renderLegendForRamp=function(q,C){const T=q.infos,X="heatmap-ramp"===q.type,U="stretch-ramp"===q.type,f=q.preview;f.className=`${"esri-legend__color-ramp"} ${"opacity-ramp"===q.type?"esri-legend__opacity-ramp":""}`;null!=C&&(f.style.opacity=C.toString());q=T.map(G=>m.tsx("div",{class:G.label?"esri-legend__ramp-label":null},
X?this.messages[G.label]||G.label:U?this._getStretchStopLabel(G):G.label));C={height:f.style.height};return m.tsx("div",{class:"esri-legend__layer-row"},m.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},m.tsx("div",{class:"esri-legend__ramps",bind:f,afterCreate:S.attachToNode})),m.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},m.tsx("div",{class:"esri-legend__ramp-labels",styles:C},q)))};x._getStretchStopLabel=function(q){return q.label?
this.messages[q.label]+": "+("string"===typeof q.value?q.value:L.formatNumber(q.value,{style:"decimal",notation:q.value.toString().includes("e")?"scientific":"standard"})):""};x._renderLegendForElementInfo=function(q,C,T,X,U){if(q.type)return this._renderLegendForElement(q,C,T,!0);T=null;U=S.isImageryStretchedLegend(C,U);q.preview?T=m.tsx("div",{class:"esri-legend__symbol",bind:q.preview,afterCreate:S.attachToNode}):q.src&&(T=this._renderImage(q,C,U));if(!T)return null;C={["esri-legend__imagery-layer-info--stretched"]:U};
return m.tsx("div",{class:"esri-legend__layer-row"},m.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",{["esri-legend__imagery-layer-info--stretched"]:U,["esri-legend__size-ramp"]:!U&&X})},T),m.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",C)},S.getTitle(this.messages,q.label,!1)||""))};x._renderImage=function(q,C,T){const {label:X,src:U,opacity:f}=q;T={["esri-legend__imagery-layer-image--stretched"]:T,["esri-legend__symbol"]:!T};
C={opacity:`${null!=f?f:C.opacity}`};return m.tsx("img",{alt:S.getTitle(this.messages,X,!1),src:U,border:0,width:q.width,height:q.height,class:this.classes(T),styles:C})};return h}(ca);B.__decorate([V.property()],z.prototype,"activeLayerInfos",void 0);B.__decorate([V.property()],z.prototype,"headingLevel",void 0);B.__decorate([V.property(),A.messageBundle("esri/widgets/Legend/t9n/Legend")],z.prototype,"messages",void 0);B.__decorate([V.property({readOnly:!0})],z.prototype,"type",void 0);return z=
B.__decorate([u.subclass("esri.widgets.Legend.styles.Classic")],z)})},"widgets/Legend/_build-generate_module":function(){define(["dojo/i18n!./nls/strings"],function(){})},"*now":function(M){M(['dojo/i18n!*preload*widgets/Legend/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define(["dojo/_base/declare","jimu/BaseWidget","esri/widgets/Legend"],function(M,B,z){return M([B],{name:"Legend",baseClass:"jimu-widget-legend",templateString:"\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d'legendDiv'\x3e\x3c/div\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);this.legend=new z({container:this.legendDiv,view:this.sceneView})},destroy:function(){this.legend&&this.legend.destroy();this.inherited(arguments)}})});