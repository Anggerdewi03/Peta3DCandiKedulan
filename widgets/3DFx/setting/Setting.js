// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/3DFx/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/3DFx/setting/Setting.html":'\x3cdiv style\x3d"width:100%;height:100%;"\x3e\r\n  \x3c!-- Viz Settings --\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv class\x3d"label" style\x3d"padding-top:0px;font-weight: bold;"\x3e\r\n      ${nls.viz_settings}\r\n    \x3c/div\x3e\r\n    \x3chr /\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv class\x3d"col-1-4"\x3e\r\n      \x3cspan class\x3d"label"\x3e${nls.viz_type}: \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-3-4"\x3e\r\n      \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"vizType"\x3e\r\n        \x3coption value\x3d"Bounce" selected\x3d"selected"\x3e${nls.bounce}\x3c/option\x3e\r\n        \x3coption value\x3d"PointExtrude" selected\x3d"selected"\x3e${nls.point_extrusion}\x3c/option\x3e\r\n        \x3coption value\x3d"Pulse" selected\x3d"selected"\x3e${nls.pulse}\x3c/option\x3e\r\n        \x3c!--\x3coption value\x3d"GridSurface" selected\x3d"selected"\x3e${nls.grid_surface}\x3c/option\x3e--\x3e\r\n        \x3coption value\x3d"Fireball" selected\x3d"selected"\x3e${nls.fireball}\x3c/option\x3e\r\n        \x3coption value\x3d"JetTrail" selected\x3d"selected"\x3e${nls.jet_trail}\x3c/option\x3e\r\n        \x3coption value\x3d"AreaExtrude" selected\x3d"selected"\x3e${nls.area_extrusion}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:15px"\x3e\r\n    \x3cdiv class\x3d"col-2-3"\x3e\r\n      \x3cdiv class\x3d"col-1-2"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"showPercent" title\x3d"${nls.show_percent}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.show_percent}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-1-2 jettrail-endpoints-container"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"showJetTrailEndPoints" title\x3d"${nls.show_jettrail_end_points}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.show_jettrail_end_points}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"cycleColors" title\x3d"${nls.cycle_colors}" /\x3e\r\n      \x3cspan class\x3d"label"\x3e${nls.cycle_colors}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:15px"\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cspan class\x3d"label" data-dojo-attach-point\x3d"maxHeightLabel"\x3e${nls.max_height}: \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cspan class\x3d"label" data-dojo-attach-point\x3d"maxWidthLabel"\x3e${nls.max_width}: \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cspan class\x3d"label"\x3e${nls.interval}: \x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:0px"\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"maxHeight" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"maxWidth" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"interval" /\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cbr/\x3e\r\n  \x3c!-- Layer Settings --\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"layerSection"\x3e\r\n    \x3cdiv class\x3d"jimu-r-row"\x3e\r\n      \x3cdiv class\x3d"label" style\x3d"padding-top:10px;font-weight: bold;"\x3e\r\n        ${nls.layer_settings}\r\n      \x3c/div\x3e\r\n      \x3chr /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-r-row"\x3e\r\n      \x3cdiv class\x3d"col-1-4"\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.viz_layer}: \x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-3-4"\x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"vizLayer"\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top: 10px"\x3e\r\n      \x3cdiv class\x3d"col-1-4"\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.display_field}: \x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-3-4"\x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"displayField"\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cdiv class\x3d"btn-add-section" data-dojo-attach-point\x3d"btnAdd"\x3e\r\n        \x3cspan class\x3d"btn-add-label"\x3e${nls.add_field}\x3c/span\x3e\r\n        \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr/\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"table" data-dojo-type\x3d"jimu/dijit/SimpleTable" data-dojo-props\x3d\'fields:[\r\n    {name:"field",title:"${nls.field}","class":"label",type:"empty"},\r\n    {name:"label",title:"${nls.label}","class":"label",type:"empty"},\r\n    {name:"actions",title:"${nls.actions}","class":"actions",type:"actions",actions:["up","down","delete"]}]\'\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/3DFx/setting/css/style.css":".jimu-widget-viz-setting .btn-add-section {display: inline-block; overflow: hidden; height: 24px; margin-left: 1px; margin-bottom: 3px; cursor: pointer; font-size: 13px; color: #538ec8; margin-top: 8px;}.jimu-widget-viz-setting .btn-add-section .btn-add-icon {float: left; height: 100%; width: 14px; background-repeat: no-repeat; background-position: center center; background-image: url(images/add.png);}.jimu-widget-viz-setting .btn-add-section .btn-add-label {float: left; height: 100%; line-height: 24px; vertical-align: middle; margin-right: 7px; text-decoration: underline;}.jimu-widget-viz-setting .label-disabled {color: #6e6e6e;}",
"*now":function(l){l(['dojo/i18n!*preload*widgets/3DFx/setting/nls/Setting*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/Deferred dojo/promise/all dojo/dom-class dojo/dom-style dojo/on dojo/query dojo/store/Memory dijit/form/Select dijit/form/ValidationTextBox dijit/_WidgetsInTemplateMixin esri/request jimu/BaseWidgetSetting jimu/dijit/Message jimu/dijit/LoadingShelter jimu/dijit/SimpleTable".split(" "),function(l,g,e,q,u,v,h,m,n,p,w,x,y,z,r,A,t,B){function C(a){var b=[],c=[],d=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle",
"esriFieldTypeDouble"],f="lat latitude y ycenter latitude83 latdecdeg POINT-Y lon lng long longitude x xcenter longitude83 longdecdeg POINT-X alt altitude z POINT-Z zcenter altitude83 altdecdeg".split(" ");g.forEach(a,function(k){b.push(k.name);var D=k.name.toLowerCase();-1<d.indexOf(k.type)&&-1===f.indexOf(D)&&c.push(k.name)});return{displayFields:b,vizFields:c}}function E(a,b){return r({url:a,content:e.mixin({f:"json"},{}),handleAs:"json",callbackParamName:"callback"}).then(function(c){c._ssl&&
(delete c._ssl,a=a.replace(/^http:/i,"https:"));if("Feature Layer"===c.type){var d={};e.mixin(d,C(c.fields));b(null,d)}else b("3DFx widget can only accecpt a feature service.")},function(c){console.log(c);b("3DFx widget can only accecpt a valid feature service.")})}function F(a){var b=new u;e.isString(a)?E(a,function(c,d){c?b.reject(c):b.resolve(d)}):b.reject("3DFx widget can only accecpt a feature service url now.");return b}return l([A,z],{baseClass:"jimu-widget-viz-setting",postCreate:function(){this.inherited(arguments);
this.layers=[];this.fldOptions=[];this._selectedLyrId=null;this.loadingCover=new B({hidden:!0});this.loadingCover.placeAt(this.domNode);this.loadingCover.startup()},startup:function(){this.inherited(arguments);this._processLayers();this._postProcessLayers()},_processLayers:function(){var a=this.sceneView.map,b,c,d=a.layers.toArray();for(b=d.length-1;0<=b;b--)if("esri.layers.FeatureLayer"===d[b].declaredClass&&"show"===d[b].listMode)this.layers.push(a.findLayerById(d[b].id));else if("esri.layers.GroupLayer"===
d[b].declaredClass){var f=d[b].layers.toArray();for(c=0;c<f.length;c++)"esri.layers.FeatureLayer"===f[c].declaredClass&&"show"===f[c].listMode&&this.layers.push(a.findLayerById(f[c].id))}},_postProcessLayers:function(){this.own(n(this.vizType,"change",e.hitch(this,this._changeVizType)));this.own(n(this.vizLayer,"change",e.hitch(this,this._changeVizLayer)));this.own(n(this.btnAdd,"click",e.hitch(this,this._addRow)));this.config.vizType&&(this.vizType.value!=this.config.vizType?this.vizType.set("value",
e.trim(this.config.vizType)):this._changeVizType())},_changeVizType:function(){this._refreshVizSetting();if(0===this.layers.length)m.set(this.layerSection,"display","none"),this.loadingCover.hide(),new t({message:this.nls.no_layers});else{this._refreshLayerList();var a=!1,b=this.vizLayer.getOptions();if(this.config.vizLayer){var c=this.config.vizLayer.id;for(var d=0;d<b.length;d++)if(b[d].value===c){a=!0;break}}a&&c?this.vizLayer.set("value",e.trim(c)):b&&b[0]&&this.vizLayer.set("value",e.trim(b[0].value))}},
_refreshVizSetting:function(){this._refreshVizSettingStates();this.config.showPercent&&this.showPercent.set("value",!0);this.config.showJetTrailEndPoints&&this.showJetTrailEndPoints.set("value",!0);this.config.cycleColors&&this.cycleColors.set("value",!0);this.config.maxHeight&&this.maxHeight.set("value",this.config.maxHeight);this.config.maxWidth&&this.maxWidth.set("value",this.config.maxWidth);this.config.interval&&this.interval.set("value",this.config.interval)},_refreshVizSettingStates:function(){var a=
this.vizType.value||this.config.vizType,b=p(".jettrail-endpoints-container",this.domNode)[0];b&&("JetTrail"==a?m.set(b,"display","block"):m.set(b,"display","none"));switch(a){case "Fireball":case "JetTrail":h.add(this.maxWidthLabel,"label-disabled");h.add(this.maxHeightLabel,"label-disabled");this.maxWidth.set("disabled",!0);this.maxHeight.set("disabled",!0);this.maxWidth.set("readOnly",!0);this.maxHeight.set("readOnly",!0);break;case "Bounce":case "AreaExtrude":h.add(this.maxWidthLabel,"label-disabled");
h.remove(this.maxHeightLabel,"label-disabled");this.maxWidth.set("disabled",!0);this.maxHeight.set("disabled",!1);this.maxWidth.set("readOnly",!0);this.maxHeight.set("readOnly",!1);break;case "Pulse":h.remove(this.maxWidthLabel,"label-disabled");h.add(this.maxHeightLabel,"label-disabled");this.maxWidth.set("disabled",!1);this.maxHeight.set("disabled",!0);this.maxWidth.set("readOnly",!1);this.maxHeight.set("readOnly",!0);break;default:h.remove(this.maxWidthLabel,"label-disabled"),h.remove(this.maxHeightLabel,
"label-disabled"),this.maxWidth.set("disabled",!1),this.maxHeight.set("disabled",!1),this.maxWidth.set("readOnly",!1),this.maxHeight.set("readOnly",!1)}},_refreshLayerList:function(){this.vizLayer.removeOption(this.vizLayer.getOptions());this.vizLayer._set("value",null);this.vizLayer._lastValueReported=null;this.vizLayer._setDisplay("");var a=null,b=this.vizType.value;if(b)switch(b){case "Fireball":case "JetTrail":a="polyline";break;case "PointExtrude":case "Pulse":case "Bounce":a="point";break;case "AreaExtrude":a=
"polygon"}a&&g.forEach(this.layers,e.hitch(this,function(c){a==c.geometryType&&(c={label:c.title,value:e.trim(c.id)},this.vizLayer.addOption(c))}))},_getLayerById:function(a){var b=g.filter(this.layers,function(c){return c.id===a});return 0<b.length?b[0]:null},_changeVizLayer:function(){var a=this._getLayerById(this.vizLayer.value);a&&a.id===this._selectedLyrId||(this._selectedLyrId=a.id,this.loadingCover.show(),this.displayField.removeOption(this.displayField.getOptions()),this.displayField._set("value",
null),this.displayField._lastValueReported=null,this.displayField._setDisplay(""),this.table.clear(),this._setFields(a))},_setFields:function(a){var b=[];this.fldOptions=[];var c=a.url;"number"===typeof a.layerId&&(c+="/"+a.layerId);v([r({url:c+"/query",content:e.mixin({f:"json"},{returnGeometry:!1,returnCountOnly:!0,where:"1\x3d1"}),handleAs:"json",callbackParamName:"callback"}),F(c)]).then(function(d){e.isObject(d[0])&&(400<d[0].count?(this.showPercent.set("value",!1),this.showPercent.set("disabled",
!0),this.showPercent.set("title",this.nls.show_percentage_limited)):(this.showPercent.set("disabled",!1),this.showPercent.set("title","")));e.isObject(d[1])&&(g.forEach(d[1].displayFields,e.hitch(this,function(f){b.push(this._getFieldOption(a,f))}.bind(this))),g.forEach(d[1].vizFields,e.hitch(this,function(f){this.fldOptions.push(this._getFieldOption(a,f))}.bind(this))),d=new w({idProperty:"label",data:b}),this.displayField.set("labelAttr","label"),this.displayField.setStore(d),this._refreshFields());
this.loadingCover.hide()}.bind(this),function(d){console.warn(d);this.loadingCover.hide()}.bind(this))},_refreshFields:function(){var a=!1;if(this.config.vizLayer&&this.config.vizLayer.id===this.vizLayer.value){var b=this.displayField.getOptions();if(this.config.displayField){var c=this.config.displayField;for(var d=0;d<b.length;d++)if(b[d].value===c){a=!0;break}}g.forEach(this.config.vizFields,e.hitch(this,function(f){this._populateTableRow(f)}))}a&&c?this.displayField.set("value",e.trim(c)):b&&
b[0]&&this.displayField.set("value",e.trim(b[0].value))},_getFieldOption:function(a,b){var c={label:b,value:b};a.popupTemplate&&a.popupTemplate.fieldInfos instanceof Array&&g.some(a.popupTemplate.fieldInfos,function(d){if(d.fieldName===b)return c.label=d.label,!0});return c},_populateTableRow:function(a){var b=this._addRow();b&&(b.selectField.set("value",a.field),b.labelText.set("value",a.label))},_addRow:function(){var a=this.table.addRow({});if(a.success&&a.tr)return a=a.tr,this._addField(a),this._addLabel(a),
a},_addField:function(a){var b=e.clone(this.fldOptions),c=p(".simple-table-cell",a)[0];c&&(q.setStyle(c,"verticalAlign","middle"),b=new x({style:{width:"100%",height:"30px"},options:b}),b.placeAt(c),b.startup(),a.selectField=b)},_addLabel:function(a){var b=p(".simple-table-cell",a)[1];q.setStyle(b,"verticalAlign","middle");var c=new y({style:{width:"100%",height:"30px"}});c.placeAt(b);c.startup();a.labelText=c},_validateVizType:function(){var a=!1;if(this.vizLayer.value){var b=this._getLayerById(this.vizLayer.value).geometryType;
switch(this.vizType.value){case "Fireball":case "JetTrail":"polyline"===b&&(a=!0);break;case "PointExtrude":case "Bounce":case "Pulse":"point"===b&&(a=!0);break;case "AreaExtrude":"polygon"===b&&(a=!0)}}a||(console.log(this.vizType),new t({message:this.vizType.attr("displayedValue")+": "+this.nls.viz_not_supported}));return a},getConfig:function(){this.config.vizType=e.trim(this.vizType.value);this.config.showPercent=this.showPercent.checked;this.config.showJetTrailEndPoints=this.showJetTrailEndPoints.checked;
this.config.cycleColors=this.cycleColors.checked;this.config.maxHeight=this.maxHeight.value;this.config.maxWidth=this.maxWidth.value;this.config.interval=this.interval.value;if(0<this.layers.length){if(!this._validateVizType())return!1;var a=this._getLayerById(this.vizLayer.value),b=a.url;"number"===typeof a.layerId&&(b+="/"+a.layerId);this.config.vizLayer={id:a.id,url:b};this.config.displayField=e.trim(this.displayField.value);var c=[];a=this.table.getRows();g.forEach(a,function(d){var f=e.trim(d.selectField.value),
k=d.selectField.attr("displayedValue");d=e.trim(d.labelText.value);c.push({field:f,alias:k,label:d})});this.config.vizFields=c}return this.config.vizLayer&&this.config.vizFields&&0!==this.config.vizFields.length?this.config:!1}})});