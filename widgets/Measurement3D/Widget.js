// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Measurement3D/ButtonGroup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/query dojo/dom-class dojo/on dijit/_WidgetBase".split(" "),function(e,f,k,I,p,d,v){return e([v],{baseClass:"jimu-button-group",CSS:{ACTIVE:"jimu-state-active"},buttons:[],activeButton:null,postCreate:function(){this.inherited(arguments);this._initUI()},buttonClicked:function(m){if(this.activeButton===m)p.remove(m,this.CSS.ACTIVE),this.activeButton=null;else{var a=I("*",this.domNode);
k.forEach(a,function(n){p.remove(n,this.CSS.ACTIVE)},this);p.add(m,this.CSS.ACTIVE);this.activeButton=m}this.onChange(this.activeButton)},getActiveButton:function(){return this.activeButton},getActiveButtonValue:function(){var m=this.getActiveButton();return m&&m.getAttribute("data-value")},_initUI:function(){k.forEach(this.buttons,function(m){this._createButton(m)},this)},_createButton:function(m){var a=document.createElement("button");a.type="button";a.title=m.label;a.setAttribute("data-value",
m.value);m.icon&&a.appendChild(m.icon);a.appendChild(document.createTextNode(m.content||m.value));this.domNode.appendChild(a);this.own(d(a,"click",f.hitch(this,function(n){this.buttonClicked(n.target)})))},onChange:function(){}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(e,f,k,I,p){return e(p,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);
this.views||(this.views=[]);I.forEach(this.views,f.hitch(this,function(d){1===d.nodeType?(k.place(d,this.domNode),k.addClass(d,"view"),k.setStyle(d,"display","none")):d.domNode&&(k.place(d.domNode,this.domNode),k.addClass(d.domNode,"view"),k.setStyle(d.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var d="",v=this.getSelectedView();v&&(d=v.label);return d},
getViewByLabel:function(d){for(var v=0;v<this.views.length;v++)if(d===this.views[v].label)return this.views[v];return null},addView:function(d){this.views.push(d);1===d.nodeType?(k.place(d,this.domNode),k.addClass(d,"view")):d.domNode&&(k.place(d.domNode,this.domNode),k.addClass(d.domNode,"view"))},removeView:function(d){var v=this.views.length;this.views=I.filter(this.views,function(m){return d!==m});v!==this.views.length&&(1===d.nodeType?k.destroy(d):d.domNode&&d.destroyRecursive())},switchView:function(d){var v;
var m="number"===typeof d?this.views[d]:"string"===typeof d?this.getViewByLabel(d):d;this.views.forEach(f.hitch(this,function(a){a&&(1===a.nodeType?v=a:a.domNode&&(v=a.domNode),a===m?(k.setStyle(v,"display","block"),a.domNode&&!a._started&&(a.startup(),a._started=!0)):k.setStyle(v,"display","none"))}));this._currentView=m;this.onViewSwitch(m)},onViewSwitch:function(){}})})},"esri/widgets/DirectLineMeasurement3D":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/promiseUtils ../core/unitUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./DirectLineMeasurement3D/DirectLineMeasurement3DViewModel ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/jsxFactory ./support/widgetUtils".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z){d=function(w){function A(b,l){b=w.call(this,b,l)||this;b.view=null;b.visible=null;b.iconClass="esri-icon-measure-line";b.label=void 0;b.messages=null;b.messagesUnits=null;b.viewModel=new r;b.unitOptions=null;b.unit=null;return b}e._inheritsLoose(A,w);var c=A.prototype;c.render=function(){const {supported:b,active:l,state:g,measurement:H,unit:q}=this.viewModel;var B="disabled"===g;const C="measuring"===g||"measured"===g,{messages:x,messagesUnits:y}=this;var G=
l&&"ready"===g?h.tsx("section",{key:"esri-direct-line-measurement-3d__hint",class:"esri-direct-line-measurement-3d__hint"},h.tsx("p",{class:"esri-direct-line-measurement-3d__hint-text"},x.hint)):null;const E=b?null:h.tsx("section",{key:"esri-direct-line-measurement-3d__unsupported",class:"esri-direct-line-measurement-3d__panel--error"},h.tsx("p",null,x.unsupported));var J=(M,L,O)=>{switch(L.state){case "available":return h.tsx("div",{key:`${O}-enabled`,class:"esri-direct-line-measurement-3d__measurement-item"},
h.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},M),h.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-value"},L.text));case "unavailable":return h.tsx("div",{key:`${O}-disabled`,class:this.classes("esri-direct-line-measurement-3d__measurement-item","esri-direct-line-measurement-3d__measurement-item--disabled")},h.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},M))}};J=C?h.tsx("section",{key:"esri-direct-line-measurement-3d__measurement",
class:"esri-direct-line-measurement-3d__measurement"},J(x.direct,H.directDistance,"direct"),J(x.horizontal,H.horizontalDistance,"horizontal"),J(x.vertical,H.verticalDistance,"vertical")):null;var N=`${this.id}__units`,F=h.tsx("label",{class:"esri-direct-line-measurement-3d__units-label",for:N},x.unit);N=h.tsx("div",{class:"esri-direct-line-measurement-3d__units-select-wrapper"},h.tsx("select",{class:"esri-direct-line-measurement-3d__units-select esri-select",id:N,onchange:this._changeUnit,bind:this,
value:q},this.viewModel.unitOptions.map(M=>{var L;return h.tsx("option",{key:M,value:M},I.isMeasurementSystem(M)?y.systems[M]:null==(L=y.units[M])?void 0:L.pluralCapitalized)})));F=h.tsx("section",{key:"esri-direct-line-measurement-3d__units",class:"esri-direct-line-measurement-3d__units"},F,N);F=C?h.tsx("div",{key:"settings",class:"esri-direct-line-measurement-3d__settings"},F):null;B=!b||l&&!C?null:h.tsx("div",{class:"esri-direct-line-measurement-3d__actions"},h.tsx("button",{disabled:B,class:this.classes("esri-direct-line-measurement-3d__clear-button esri-button esri-button--primary",
B&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement,type:"button"},x.newMeasurement));G=this.visible?h.tsx("div",{class:"esri-direct-line-measurement-3d__container"},E,G,F,J,B):null;return h.tsx("div",{key:this,class:"esri-direct-line-measurement-3d esri-widget esri-widget--panel",role:"presentation"},G)};c._newMeasurement=function(){k.ignoreAbortErrors(this.viewModel.start())};c._changeUnit=function(b){b=b.target;if(b=b.options[b.selectedIndex])this.unit=b.value};e._createClass(A,
[{key:"analysis",get:function(){return this.viewModel.analysis},set:function(b){this.viewModel.analysis=b}}]);return A}(D);f.__decorate([p.aliasOf("viewModel.view")],d.prototype,"view",void 0);f.__decorate([p.aliasOf("viewModel.visible")],d.prototype,"visible",void 0);f.__decorate([p.aliasOf("viewModel.active")],d.prototype,"active",void 0);f.__decorate([a.property({constructOnly:!0,nonNullable:!0})],d.prototype,"analysis",null);f.__decorate([a.property()],d.prototype,"iconClass",void 0);f.__decorate([a.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],d.prototype,"label",void 0);f.__decorate([a.property(),t.messageBundle("esri/widgets/DirectLineMeasurement3D/t9n/DirectLineMeasurement3D")],d.prototype,"messages",void 0);f.__decorate([a.property(),t.messageBundle("esri/core/t9n/Units")],d.prototype,"messagesUnits",void 0);f.__decorate([a.property()],d.prototype,"uiStrings",void 0);f.__decorate([a.property({type:r})],d.prototype,"viewModel",void 0);f.__decorate([p.aliasOf("viewModel.unitOptions")],d.prototype,"unitOptions",void 0);
f.__decorate([p.aliasOf("viewModel.unit")],d.prototype,"unit",void 0);f.__decorate([u.accessibleHandler()],d.prototype,"_newMeasurement",null);f.__decorate([u.accessibleHandler()],d.prototype,"_changeUnit",null);return d=f.__decorate([n.subclass("esri.widgets.DirectLineMeasurement3D")],d)})},"esri/widgets/DirectLineMeasurement3D/DirectLineMeasurement3DViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../analysis/DirectLineMeasurementAnalysis ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../properties/defaultUnit ../../views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool ../support/InteractiveAnalysisViewModel".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u){v=function(t){function h(w){w=t.call(this,w)||this;w.analysis=null;w.supportedViewType="3d";w.unsupportedErrorMessage="DirectLineMeasurement3DViewModel is only supported in 3D views.";w._userUnit=null;w._userUnitOptions=null;return w}e._inheritsLoose(h,t);var z=h.prototype;z.constructAnalysis=function(){return new k};z.constructTool=function(){return new r({view:I.unwrap(this.view),analysis:this.analysis,analysisViewData:I.unwrap(this.analysisView),visible:this.visible})};
z._findSelectableUnit=function(w,A){const c=this.unitOptions;return c.includes(w)?w:A?this._findSelectableUnit(A):c[0]};z._filteredOrAllUnits=function(w){if(!w)return p.measurementLengthUnits.slice();w=w.filter(A=>p.measurementLengthUnits.includes(A));return 0===w.length?p.measurementLengthUnits.slice():w};e._createClass(h,[{key:"state",get:function(){return this.disabled||!this.ready?"disabled":I.isNone(this.tool)?"ready":this.tool.state}},{key:"measurement",get:function(){if(I.isNone(this.tool))return null;
const w={mode:"euclidean",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:null,state:"unavailable"},verticalDistance:{text:null,state:"unavailable"}},{analysisViewData:A}=this.tool;if(I.isNone(A))return w;const c=A.actualVisualizedMeasurement,b=I.isSome(A.result)?"available":"unavailable";switch(c){case "euclidean":return{mode:"euclidean",directDistance:{text:A.directLabelText,state:b},horizontalDistance:{text:A.horizontalLabelText,state:b},verticalDistance:{text:A.verticalLabelText,
state:b}};case "geodesic":return{mode:"geodesic",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:A.horizontalLabelText,state:b},verticalDistance:{text:A.verticalLabelText,state:b}};default:return w}}},{key:"unitOptions",get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(w){this._userUnitOptions=w;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}},{key:"unit",get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,
this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},set:function(w){this._userUnit=w?this._findSelectableUnit(w,this._userUnit):null;this.analysis.unit=w}}]);return h}(u.InteractiveAnalysisViewModel);f.__decorate([d.property({type:k})],v.prototype,"analysis",void 0);f.__decorate([d.property({readOnly:!0})],v.prototype,"state",null);f.__decorate([d.property({readOnly:!0})],v.prototype,"measurement",null);f.__decorate([d.property()],v.prototype,"unitOptions",null);f.__decorate([d.property()],
v.prototype,"unit",null);f.__decorate([d.property(D.defaultUnitPropertyMetadata)],v.prototype,"defaultUnit",void 0);f.__decorate([d.property()],v.prototype,"_userUnit",void 0);f.__decorate([d.property()],v.prototype,"_userUnitOptions",void 0);return v=f.__decorate([n.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],v)})},"esri/analysis/DirectLineMeasurementAnalysis":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Analysis ../core/maybe ../core/unitUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/Point".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r){k=function(u){function t(h){h=u.call(this,h)||this;h.type="direct-line-measurement";h.startPoint=null;h.endPoint=null;h.unit=null;h.nonEditableMessage="Assign start and end points to the analysis to allow editing.";return h}e._inheritsLoose(t,u);t.prototype.clear=function(){this.endPoint=this.startPoint=null};e._createClass(t,[{key:"extent",get:function(){if(I.isNone(this.startPoint))return null;const h=D.fromPoint(this.startPoint);I.isSome(this.endPoint)&&h.union(D.fromPoint(this.endPoint));
return h}},{key:"requiredPropertiesForEditing",get:function(){return[this.startPoint,this.endPoint]}}]);return t}(k);f.__decorate([d.property({type:["direct-line-measurement"]})],k.prototype,"type",void 0);f.__decorate([d.property({type:r})],k.prototype,"startPoint",void 0);f.__decorate([d.property({type:r})],k.prototype,"endPoint",void 0);f.__decorate([d.property()],k.prototype,"extent",null);f.__decorate([d.property({type:p.measurementLengthUnits,value:null})],k.prototype,"unit",void 0);f.__decorate([d.property({readOnly:!0})],
k.prototype,"requiredPropertiesForEditing",null);f.__decorate([d.property({readOnly:!0})],k.prototype,"nonEditableMessage",void 0);return k=f.__decorate([n.subclass("esri.analysis.DirectLineMeasurementAnalysis")],k)})},"esri/analysis/Analysis":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/Clonable ../core/Identifiable ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r){let u=0;k=function(t){function h(z){z=t.call(this,z)||this;z.id=`${Date.now().toString(16)}-analysis-${u++}`;z.title=null;return z}e._inheritsLoose(h,t);e._createClass(h,[{key:"parent",get:function(){return this._get("parent")},set:function(z){const w=this.parent;if(v.isSome(w))switch(w.type){case "line-of-sight":w.removeAnalysis(this);break;case "2d":case "3d":w.analyses.includes(this)&&w.analyses.remove(this)}this._set("parent",z)}},{key:"isEditable",get:function(){return this.requiredPropertiesForEditing.every(v.isSome)}}]);
return h}(d.JSONSupportMixin(I.ClonableMixin(p.IdentifiableMixin(k))));f.__decorate([m.property({type:String,constructOnly:!0,clonable:!1})],k.prototype,"id",void 0);f.__decorate([m.property({type:String})],k.prototype,"title",void 0);f.__decorate([m.property({constructOnly:!0})],k.prototype,"type",void 0);f.__decorate([m.property({clonable:!1,value:null})],k.prototype,"parent",null);f.__decorate([m.property({readOnly:!0})],k.prototype,"extent",void 0);f.__decorate([m.property({readOnly:!0})],k.prototype,
"isEditable",null);f.__decorate([m.property({readOnly:!0})],k.prototype,"requiredPropertiesForEditing",void 0);f.__decorate([m.property({readOnly:!0})],k.prototype,"nonEditableMessage",void 0);return k=f.__decorate([r.subclass("esri.analysis.Analysis")],k)})},"esri/properties/defaultUnit":function(){define(["exports","../core/unitUtils"],function(e,f){e.defaultUnitPropertyMetadata={readOnly:!0,get(){return f.getDefaultUnitForView(this.view)}};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec3f64 ../../../../../layers/graphics/hydratedFeatures ../../../analysis/support/measurementUtils ../../editingTools/dragEventPipeline3D ./DirectLineMeasurement3DView ../support/PickRequest ../../../support/ElevationProvider ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/IntersectorInterfaces ../../../../interactive/AnalysisToolBase ../../../../interactive/dragEventPipeline ../../../../support/screenUtils ../../../../../geometry/Point".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z,w,A,c,b,l,g,H,q,B){k=function(x){function y(E){E=x.call(this,E)||this;E._handles=new I;E._cachedPickRequest=null;E._isAnyPointerDown=!1;E.lineState="initial";E.analysisViewData=null;E.startPointSurfaceLocation=null;E.endPointSurfaceLocation=null;E.startManipulator=null;E.endManipulator=null;return E}e._inheritsLoose(y,x);var G=y.prototype;G.initialize=function(){const {view:E,analysis:J,analysisViewData:N,cursorPoint:F,visible:M}=this;this.measurementView=
new w.DirectLineMeasurement3DView({toolState:this,view:E,analysis:J,analysisViewData:N,cursorPoint:F,visible:M});this._intersector=b.newIntersector(this.view.state.viewingMode);this._intersector.options.store=l.StoreResults.MIN;const {start:L,end:O}=this.measurementView.createManipulators(),Q=(V,X,Z)=>H.createManipulatorDragEventPipeline(V,(ba,ja,ka)=>{const ia=z.hideManipulatorWhileDragging(ba);ja.next(ia).next(z.screenToMap3D(this.view)).next(ea=>"start"!==ea.action?ea:null).next(ea=>{const ha=
t.clonePoint(ea.mapEnd,new B);this.analysis[X]=ha;ba.location=ha;this[Z]=this._surfaceLocation(ha,ea.surfaceType)});ka.next(ia).next(H.resetProperties(this.analysis,[X])).next(H.resetProperties(this,[Z])).next(()=>{ba.location=p.unwrap(this.analysis[X])})}),Y=V=>V.events.on("grab-changed",()=>{this.lineState=L.grabbing||O.grabbing?"editing":"measured"});this._handles.add([Q(L,"startPoint","startPointSurfaceLocation"),Q(O,"endPoint","endPointSurfaceLocation"),Y(L),Y(O)]);this.manipulators.add(L);this.manipulators.add(O);
this.startManipulator=L;this.endManipulator=O;this._handles.add(d.watch(()=>this.state,V=>{"measured"===V&&this.finishToolCreation()},d.syncAndInitial))};G.destroy=function(){this.measurementView=p.destroyMaybe(this.measurementView);this._handles=p.destroyMaybe(this._handles)};G.onShow=function(){this.measurementView.show();this._updateManipulatorAvailability()};G.onHide=function(){this.measurementView.hide()};G.onInputEvent=function(E){switch(E.type){case "immediate-click":this._handleImmediateClick(E);
break;case "pointer-move":this._handlePointerMove(E);break;case "pointer-down":this._handlePointerDown();break;case "pointer-up":this._handlePointerUp()}this._updateManipulatorAvailability()};G._handlePointerMove=function(E){this._clearCachedPickRequest();const J=q.createScreenPointFromEvent(E);"mouse"===E.pointerType&&(this._hoverAt(J),"drawing"===this.lineState&&(this.endManipulator.events.emit("drag",{action:"update",start:J,screenPoint:J}),E.stopPropagation()))};G._handlePointerDown=function(){this._isAnyPointerDown=
!0};G._handlePointerUp=function(){this._isAnyPointerDown=!1};G._handleImmediateClick=function(E){this._clearCachedPickRequest();if(h.isPrimaryPointerAction(E)){var J=q.createScreenPointFromEvent(E),N=E.pointerType,F=!1;if(this.active)switch(this.lineState){case "initial":this.startManipulator.events.emit("drag",{action:"start",pointerType:N,start:J,screenPoint:J});this.startManipulator.events.emit("drag",{action:"end",start:J,screenPoint:J});p.isSome(this.analysis.startPoint)&&(this.startManipulator.interactive=
!1,this.endManipulator.interactive=!1,this.lineState="drawing",this.endManipulator.events.emit("drag",{action:"start",pointerType:N,start:J,screenPoint:J}),F=!0);break;case "drawing":this.endManipulator.events.emit("drag",{action:"update",start:J,screenPoint:J}),p.isSome(this.analysis.endPoint)&&(this.endManipulator.events.emit("drag",{action:"end",start:J,screenPoint:J}),this.startManipulator.interactive=!0,this.endManipulator.interactive=!0,this.lineState="measured",F=!0)}F&&E.stopPropagation();
"mouse"===E.pointerType&&this._hoverAt(J)}};G._hoverAt=function(E){const J=this._isAnyPointerDown&&"drawing"!==this.lineState&&"editing"!==this.lineState;(p.isNone(this.analysis.startPoint)||p.isNone(this.analysis.endPoint))&&this.active&&!J?(E=this._pick(E),p.isSome(E)&&(this.cursorPoint=E)):this.cursorPoint=null};G._pick=function(E){if(p.isSome(this._cachedPickRequest)&&p.isSome(this._cachedPickRequest.result)){var J=this._cachedPickRequest.screenPoint;if(J.x===E.x&&J.y===E.y)return this._cachedPickRequest.result.mapPoint}else this._cachedPickRequest=
new A.PickRequest(E);E=v.screenPointObjectToArray(E);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(E,this._intersector);E=C;if(!this._intersector.results.min.getIntersectionPoint(E))return null;J=this.view.renderCoordsHelper.fromRenderCoords(E,this.view.spatialReference);this._cachedPickRequest.result=new A.PickResult(E,J);return J};G._clearCachedPickRequest=function(){this._cachedPickRequest=null};G._surfaceLocation=function(E,J){return J===z.SurfaceType.GROUND?"on-the-surface":
E.z>=this._getElevation(E)?"above-the-surface":"below-the-surface"};G._updateManipulatorAvailability=function(){this.startManipulator.available=p.isSome(this.analysis.startPoint);this.endManipulator.available=p.isSome(this.analysis.endPoint)};G._getElevation=function(E){return this.view.basemapTerrain.ready?p.unwrapOr(c.getElevationAtPoint(this.view.elevationProvider,E),0):0};e._createClass(y,[{key:"state",get:function(){return p.isNone(this.analysis.startPoint)&&p.isNone(this.analysis.endPoint)?
"ready":this.validMeasurement&&"editing"!==this.lineState&&"drawing"!==this.lineState?"measured":"measuring"}},{key:"cursor",get:function(){return"ready"===this.state||"drawing"===this.lineState?"crosshair":null}},{key:"cursorPoint",set:function(E){this._set("cursorPoint",E);this.measurementView.cursorPoint=E}},{key:"validMeasurement",get:function(){return p.isSome(this.analysis.startPoint)&&p.isSome(this.analysis.endPoint)}}]);return y}(g.AnalysisToolBase);f.__decorate([m.property({readOnly:!0})],
k.prototype,"state",null);f.__decorate([m.property()],k.prototype,"lineState",void 0);f.__decorate([m.property({readOnly:!0})],k.prototype,"cursor",null);f.__decorate([m.property()],k.prototype,"cursorPoint",null);f.__decorate([m.property({constructOnly:!0})],k.prototype,"analysis",void 0);f.__decorate([m.property({constructOnly:!0})],k.prototype,"analysisViewData",void 0);f.__decorate([m.property()],k.prototype,"measurementView",void 0);f.__decorate([m.property({constructOnly:!0})],k.prototype,"view",
void 0);f.__decorate([m.property({readOnly:!0})],k.prototype,"validMeasurement",null);f.__decorate([m.property({value:null})],k.prototype,"startPointSurfaceLocation",void 0);f.__decorate([m.property({value:null})],k.prototype,"endPointSurfaceLocation",void 0);k=f.__decorate([r.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],k);const C=u.create();return k})},"esri/views/3d/analysis/support/measurementUtils":function(){define("exports ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/geometryEngine ../../../../geometry/Polygon ../../../../geometry/projection ../../../../geometry/SpatialReference ../../../../geometry/support/geodesicUtils ../../support/mathUtils".split(" "),
function(e,f,k,I,p,d,v,m,a){const n=k.create(),D=k.create(),r=k.create(),u=new p({rings:[[n,D,r]],spatialReference:v.WGS84}),t=k.create();e.bestFitPlane=function(h,z){if(3>h.length)throw Error("need at least 3 points to fit a plane");a.planeFromPoints(h[0],h[1],h[2],z)};e.boundingSphere=function(h,z){const w=z.center;f.set(w,0,0,0);for(var A=0;A<h.length;++A)f.add(w,w,h[A]);f.scale(w,w,1/h.length);A=0;for(let c=0;c<h.length;++c)A=Math.max(A,f.squaredDistance(w,h[c]));z.radius=Math.sqrt(A)};e.fitHemisphere=
function(h,z=null,w=!0){const A=(b,l)=>{if(0===l[0]&&0===l[1]&&0===l[2])return!1;for(let g=0;g<b.length;++g)if(-1E-6>f.dot(l,b[g]))return!1;return!0};if(0===h.length)return!1;if(1===h.length)return z&&f.copy(z,h[0]),!0;f.set(t,0,0,0);for(var c=0;c<h.length;++c)f.add(t,t,h[c]);f.normalize(t,t);if(A(h,t))return z&&f.copy(z,t),!0;if(!w)return!1;for(w=0;w<h.length;++w)for(c=0;c<h.length;++c)if(w!==c&&(f.cross(t,h[w],h[c]),f.normalize(t,t),A(h,t)))return z&&f.copy(z,t),!0;return!1};e.isPrimaryPointerAction=
function(h){return"mouse"!==h.pointerType||0===h.button};e.planePointDistance=function(h,z){return f.dot(h,z)+h[3]};e.segmentLengthEuclidean=function(h,z,w){return d.projectPointToVector(h,n,w)&&d.projectPointToVector(z,D,w)?f.distance(n,D):0};e.segmentLengthGeodesic=function(h,z){if(!d.projectPointToWGS84ComparableLonLat(h,n)||!d.projectPointToWGS84ComparableLonLat(z,D))return 0;h={distance:null};m.inverseGeodeticSolver(h,[n[0],n[1]],[D[0],D[1]]);return h.distance};e.segmentLengthGeodesicVector=
function(h,z,w){const A={distance:null};m.inverseGeodeticSolver(A,[h[0],h[1]],[z[0],z[1]],w);return A.distance};e.tangentFrame=function(h,z,w){Math.abs(h[0])>Math.abs(h[1])?f.set(z,0,1,0):f.set(z,1,0,0);f.cross(w,h,z);f.normalize(z,z);f.cross(z,w,h);f.normalize(w,w)};e.triangleAreaGeodesic=function(h,z,w,A){if(!d.projectVectorToWGS84ComparableLonLat(h,A,n)||!d.projectVectorToWGS84ComparableLonLat(z,A,D)||!d.projectVectorToWGS84ComparableLonLat(w,A,r))return 0;u.setPoint(0,0,n);u.setPoint(0,1,D);u.setPoint(0,
2,r);return Math.abs(I.geodesicArea(u,"square-meters"))};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(e,f,k,I,p,d,v,m,a,n){function D(c){if(!c)return null;if(d.isGeographic(c)&&c.wkid){var b=p.spheroids[c.wkid];if(b)return b}return c.wkt&&
((c=p.WKT_SPHEROID_REGEX.exec(c.wkt))&&2===c.length?(b=c[1].split(","),!b||3>b.length?c=null:(c=parseFloat(b[1]),b=parseFloat(b[2]),c=isNaN(c)||isNaN(b)?null:{a:c,f:0===b?0:1/b})):c=null,c)?c:null}function r(c){c=D(c||n.WGS84);if("b"in c&&"eSq"in c&&"radius"in c)return c;const b=c.a*(1-c.f);return Object.assign(c,{b,eSq:1-(b/c.a)**2,radius:(2*c.a+b)/3,densificationRatio:1E4/((2*c.a+b)/3)})}function u(c){return 0>c?c+360:c}function t(c,b,l){const {a:g,eSq:H}=r(l);l=Math.sqrt(H);const q=Math.sin(b[1]*
p.toRadians);b=g*b[0]*p.toRadians;l=0<H?g*(1-H)*(q/(1-H*q*q)-1/(2*l)*Math.log((1-l*q)/(1+l*q)))*.5:g*q;c[0]=b;c[1]=l;return c}function h(c){return null!==D(c)}function z(c,b){if("polyline"!==c.type&&"polygon"!==c.type)throw new k("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:l}=c;if(!h(l))throw new k("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var g="polyline"===c.type?c.paths:
c.rings;const H=[],q=[0,0],B={distance:null};for(const y of g){g=[];H.push(g);g.push([y[0][0],y[0][1]]);var C=y[0][0],x=y[0][1];let G,E;for(let J=0;J<y.length-1;J++){G=y[J+1][0];E=y[J+1][1];if(C===G&&x===E)continue;const N=[C,x];A(B,[C,x],[G,E],l);const {azimuth:F,distance:M}=B;C=M/b;if(1<C){for(x=1;x<=C-1;x++)w(q,N,F,x*b,l),g.push(q.slice(0));w(q,N,F,(M+Math.floor(C-1)*b)/2,l);g.push(q.slice(0))}w(q,N,F,M,l);g.push(q.slice(0));C=q[0];x=q[1]}}return"polyline"===c.type?new v({paths:H,spatialReference:l}):
new m({rings:H,spatialReference:l})}function w(c,b,l,g,H){const q=b[0]*p.toRadians;b=b[1]*p.toRadians;l*=p.toRadians;const {a:B,b:C,f:x}=r(H);H=Math.sin(l);l=Math.cos(l);var y=(1-x)*Math.tan(b);b=1/Math.sqrt(1+y*y);const G=y*b,E=Math.atan2(y,l);y=b*H;const J=y*y;var N=1-J,F=N*(B*B-C*C)/(C*C);const M=1+F/16384*(4096+F*(-768+F*(320-175*F))),L=F/1024*(256+F*(-128+F*(74-47*F)));F=g/(C*M);let O=2*Math.PI,Q,Y,V,X;for(;1E-12<Math.abs(F-O);)V=Math.cos(2*E+F),Q=Math.sin(F),Y=Math.cos(F),X=L*Q*(V+L/4*(Y*(-1+
2*V*V)-L/6*V*(-3+4*Q*Q)*(-3+4*V*V))),O=F,F=g/(C*M)+X;g=G*Q-b*Y*l;N=x/16*N*(4+x*(4-3*N));g=Math.atan2(G*Y+b*Q*l,(1-x)*Math.sqrt(J+g*g))/p.toRadians;c[0]=(q+(Math.atan2(Q*H,b*Y-G*Q*l)-(1-N)*x*y*(F+N*Q*(V+N*Y*(-1+2*V*V)))))/p.toRadians;c[1]=g;return c}function A(c,b,l,g){var H=b[0]*p.toRadians;b=b[1]*p.toRadians;var q=l[0]*p.toRadians;l=l[1]*p.toRadians;const {a:B,b:C,f:x,radius:y}=r(g),G=q-H;var E=Math.atan((1-x)*Math.tan(b)),J=Math.atan((1-x)*Math.tan(l));g=Math.sin(E);E=Math.cos(E);const N=Math.sin(J);
J=Math.cos(J);let F=1E3,M=G,L,O,Q;let Y,V,X;do{var Z=Math.sin(M);var ba=Math.cos(M);Q=Math.sqrt(J*Z*J*Z+(E*N-g*J*ba)*(E*N-g*J*ba));if(0===Q)return c.distance=0,c.azimuth=void 0,c.reverseAzimuth=void 0,c;ba=g*N+E*J*ba;Y=Math.atan2(Q,ba);V=E*J*Z/Q;O=1-V*V;Z=ba-2*g*N/O;isNaN(Z)&&(Z=0);X=x/16*O*(4+x*(4-3*O));L=M;M=G+(1-X)*x*V*(Y+X*Q*(Z+X*ba*(-1+2*Z*Z)))}while(1E-12<Math.abs(M-L)&&0<--F);if(0===F)return g=Math.acos(Math.sin(b)*Math.sin(l)+Math.cos(b)*Math.cos(l)*Math.cos(q-H))*y,H=q-H,c.azimuth=Math.atan2(Math.sin(H)*
Math.cos(l),Math.cos(b)*Math.sin(l)-Math.sin(b)*Math.cos(l)*Math.cos(H))/p.toRadians,c.distance=g,c.reverseAzimuth=void 0,c;H=O*(B*B-C*C)/(C*C);b=H/1024*(256+H*(-128+H*(74-47*H)));q=Math.atan2(E*Math.sin(M),E*N*Math.cos(M)-g*J);c.azimuth=Math.atan2(J*Math.sin(M),E*N-g*J*Math.cos(M))/p.toRadians;c.distance=C*(1+H/16384*(4096+H*(-768+H*(320-175*H))))*(Y-b*Q*(Z+b/4*(ba*(-1+2*Z*Z)-b/6*Z*(-3+4*Q*Q)*(-3+4*Z*Z))));c.reverseAzimuth=q/p.toRadians;return c}e.directGeodeticSolver=w;e.geodesicAreas=function(c,
b="square-meters"){if(c.some(q=>!h(q.spatialReference)))throw new k("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const l=[];for(var g=0;g<c.length;g++){var H=c[g];const {radius:q,densificationRatio:B}=r(H.spatialReference);l.push(z(H,q*B))}c=[];g=[0,0];H=[0,0];for(let q=0;q<l.length;q++){const {rings:B,spatialReference:C}=l[q];let x=0;for(let y=0;y<B.length;y++){const G=B[y];t(g,G[0],C);t(H,G[G.length-1],C);let E=H[0]*g[1]-g[0]*H[1];for(let J=
0;J<G.length-1;J++)t(g,G[J+1],C),t(H,G[J],C),E+=H[0]*g[1]-g[0]*H[1];x+=E}x=I.convertUnit(x,"square-meters",b);c.push(x/-2)}return c};e.geodesicDensify=z;e.geodesicDistance=function(c,b,l="meters"){if(!c||!b)throw new k("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!c.spatialReference||!b.spatialReference)throw new k("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!d.equals(c.spatialReference,b.spatialReference))throw new k("geodesic-distance:invalid-parameters",
"spatial references of input parameters do not match");const {spatialReference:g}=c;if(!h(g))throw new k("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(c.x===b.x&&c.y===b.y)return{distance:0,azimuth:0,reverseAzimuth:0};const H={distance:null};A(H,[c.x,c.y],[b.x,b.y],g);H.distance=I.convertUnit(H.distance,"meters",l);H.azimuth=u(H.azimuth);H.reverseAzimuth=u(H.reverseAzimuth);return H};e.geodesicLengths=function(c,b="meters"){if(!c)throw new k("geodesic-lengths:invalid-geometries",
"the input geometries type is not supported");if(c.some(H=>!h(H.spatialReference)))throw new k("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const l=[];for(let H=0;H<c.length;H++){var g=c[H];const {spatialReference:q}=g;g="polyline"===g.type?g.paths:g.rings;let B=0;for(let C=0;C<g.length;C++){const x=g[C];let y=0;for(let G=1;G<x.length;G++){const E=x[G-1][0],J=x[G][0],N=x[G-1][1],F=x[G][1];if(N!==F||E!==J){const M={distance:null};A(M,[E,N],
[J,F],q);y+=M.distance}}B+=y}B=I.convertUnit(B,"meters",b);l.push(B)}return l};e.inverseGeodeticSolver=A;e.isSupported=h;e.pointFromDistance=function(c,b,l){if(!c||null==b||null==l)throw new k("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>l||360<l)throw new k("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!c.spatialReference)throw new k("point-from-distance:missing-spatial-reference",
"the input point must have a spatial reference");const {spatialReference:g}=c;if(!h(g))throw new k("geodesic-distance:not-supported","input geometry spatial reference is not supported");const H=[0,0];w(H,[c.x,c.y],l,b,g);return new a({x:H[0],y:H[1],spatialReference:g})};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/editingTools/dragEventPipeline3D":function(){define("exports ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/projection ../../../../geometry/support/plane ../../../../geometry/support/ray ../../../../geometry/support/vector ../../../../geometry/support/vectorStacks ../../../../support/elevationInfoUtils ../../support/geometryUtils/ray ../../webgl-engine/lib/Intersector ../../webgl-engine/lib/IntersectorInterfaces ../../webgl-engine/lib/verticalOffsetUtils ../../../interactive/dragEventPipeline".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z){function w(y,G){return A(y,()=>G)}function A(y,G){const E=p.create(),J=p.create();let N=!1;return F=>{const M=G(F);if("start"===F.action){var L=k.screenPointObjectToArray(F.screenStart,k.castScreenPointArray(n.sv2d.get()));L=r.fromScreen(y.state.camera,L,x);f.isSome(L)&&(N=v.intersectRay(M,L,E))}if(!N)return null;L=k.screenPointObjectToArray(F.screenEnd,k.castScreenPointArray(n.sv2d.get()));L=r.fromScreen(y.state.camera,L,x);return f.isNone(L)?null:v.intersectRay(M,
L,J)?{...F,renderStart:E,renderEnd:J,plane:M,ray:L}:null}}function c(y,G,E,J=null,N=null){let F=null;return M=>{if("start"===M.action&&(F=y.sceneIntersectionHelper.intersectElevationFromScreen(k.createScreenPointArray(M.screenStart.x,M.screenStart.y),G,E,N),f.isSome(F)&&f.isSome(J)&&!d.projectPoint(F,F,J))||f.isNone(F))return null;const L=y.sceneIntersectionHelper.intersectElevationFromScreen(k.createScreenPointArray(M.screenEnd.x,M.screenEnd.y),G,E,N);return f.isSome(L)?f.isSome(J)&&!d.projectPoint(L,
L,J)?null:{...M,mapStart:F,mapEnd:L}:null}}function b(y,G,E,J=null,N=null){G=D.getZForElevationMode(G,y,E);return c(y,E,G,J,N)}function l(y,G,E,J=null,N=null){return b(y,E,D.getGraphicEffectiveElevationInfo(G),J,N)}function g(y,G){const E=B,J=C,N=v.create();y.renderCoordsHelper.worldUpAtPosition(G,E);y=I.cross(N,E,I.subtract(J,G,y.state.camera.eye));I.cross(y,y,E);return v.fromPositionAndNormal(G,y,N)}function H(y,G){const E=p.create(),J=I.length(G);y.renderCoordsHelper.worldUpAtPosition(G,E);const N=
p.create(),F=p.create(),M=L=>{I.subtract(L,L,G);a.projectPoint(E,L,L);"global"===y.viewingMode&&I.length(L)*Math.sign(I.dot(E,L))<-J+.001&&I.subtract(L,I.scale(L,E,.001),G);I.add(L,L,G);return L};return L=>{L.renderStart=M(I.copy(N,L.renderStart));L.renderEnd=M(I.copy(F,L.renderEnd));return L}}function q(y,G){const E=y.renderCoordsHelper;return J=>{const N=E.fromRenderCoords(J.renderStart,G),F=E.fromRenderCoords(J.renderEnd,G);return f.isSome(N)&&f.isSome(F)?{...J,mapStart:N,mapEnd:F}:null}}e.SurfaceType=
void 0;(function(y){y[y.GROUND=0]="GROUND";y[y.OTHER=1]="OTHER"})(e.SurfaceType||(e.SurfaceType={}));const B=p.create(),C=p.create(),x=m.create();e.convertToMapCoordinates=q;e.hideManipulatorWhileDragging=function(y){let G=null;return E=>{switch(E.action){case "start":G=y.disableDisplay();break;case "end":case "cancel":f.isSome(G)&&(G.remove(),G=null)}return E}};e.projectToWorldUp=H;e.screenToMap3D=function(y,G=null){const E=u.newIntersector(y.state.viewingMode);E.options.selectionMode=!0;E.options.store=
t.StoreResults.MIN;E.options.hud=!1;const J=k.createScreenPointArray(),N={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},F=p.create(),M=f.unwrapOr(G,y.spatialReference),L=Q=>{y.map.ground&&1>y.map.ground.opacity?N.exclude.add(h.TERRAIN_ID):N.exclude.delete(h.TERRAIN_ID);y.sceneIntersectionHelper.intersectIntersectorScreen(k.screenPointObjectToArray(Q,J),E,N);Q=E.results.min;if(Q.getIntersectionPoint(F))Q=Q.intersector===t.IntersectorType.TERRAIN?e.SurfaceType.GROUND:e.SurfaceType.OTHER;
else if(E.results.ground.getIntersectionPoint(F))Q=e.SurfaceType.GROUND;else return null;return{location:y.renderCoordsHelper.fromRenderCoords(F,M),surfaceType:Q}};let O;return Q=>{if("start"===Q.action){var Y=L(Q.screenStart);O=f.isSome(Y)?Y.location:null}if(f.isNone(O))return null;Y=L(Q.screenEnd);return f.isSome(Y)&&f.isSome(Y.location)?{...Q,mapStart:O,mapEnd:Y.location,surfaceType:Y.surfaceType}:null}};e.screenToMapXYAtLocation=b;e.screenToMapXYForGraphic=function(y,G,E,J){y=G.toMap(y.screenStart,
{include:[E]});return f.isSome(y)?l(G,E,y,J):null};e.screenToMapXYForGraphicAtLocation=l;e.screenToRenderPlane=w;e.screenToRenderPlaneFromEvent=function(y){return A(y,G=>G.plane)};e.screenToZConstrained=function(y,G,E){let J=null;const N=new z.EventPipeline;N.next(w(y,g(y,G))).next(H(y,G)).next(q(y,E)).next(F=>{F.mapEnd.x=F.mapStart.x;F.mapEnd.y=F.mapStart.y;J=F});return F=>{J=null;N.execute(F);return J}};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(e,f,k){function I(n,D){return f.isNone(D)||!D.mode?n?"absolute-height":"on-the-ground":D.mode}function p(n,D){return I(f.isSome(n)?n.hasZ:!1,D)}function d(n){const D=v(n);return p(n.geometry,D)}function v(n){return n.layer&&"elevationInfo"in n.layer?n.layer.elevationInfo:null}function m(n,D,r,u,t,h,z=null){if(!f.isNone(h)){var w=f.isSome(z)?z.mode:"absolute-height";if("on-the-ground"===
w)return 0;({absoluteZ:h}=a(D,r,u,t,n,h));a:{z=f.isSome(z)&&f.isSome(z.offset)?z.offset:0;switch(w){case "absolute-height":n=h-z;break a;case "relative-to-ground":n=h-(f.unwrapOr(n.elevationProvider.getElevation(D,r,u,t,"ground"),0)+z);break a;case "relative-to-scene":n=h-(f.unwrapOr(n.elevationProvider.getElevation(D,r,u,t,"scene"),0)+z);break a}n=void 0}return n}}function a(n,D,r,u,t,h){const z=f.isSome(h.offset)?h.offset:0;switch(h.mode){case "absolute-height":return{absoluteZ:r+z,elevation:0};
case "on-the-ground":return r=f.unwrapOr(t.elevationProvider.getElevation(n,D,0,u,"ground"),0),{absoluteZ:r,elevation:r};case "relative-to-ground":return n=f.unwrapOr(t.elevationProvider.getElevation(n,D,r,u,"ground"),0),{absoluteZ:r+n+z,elevation:n};case "relative-to-scene":return n=f.unwrapOr(t.elevationProvider.getElevation(n,D,r,u,"scene"),0),{absoluteZ:r+n+z,elevation:n}}}e.absoluteHeightElevationInfo={mode:"absolute-height",offset:0};e.getConvertedElevation=function(n,D,r,u=null){return m(n,
D.x,D.y,D.hasZ?D.z:0,D.spatialReference,r,u)};e.getConvertedElevationFromVector=function(n,D,r,u,t=null){return m(n,D[0],D[1],2<D.length?D[2]:0,r,u,t)};e.getEffectiveElevationMode=I;e.getGeometryEffectiveElevationMode=p;e.getGraphicEffectiveElevationInfo=function(n){var D=v(n);n=p(n.geometry,D);D=f.isSome(D)&&"on-the-ground"!==n?f.unwrapOr(D.offset,0)*k.getMetersPerUnit(f.unwrapOr(D.unit,"meters")):0;return{mode:n,offset:D}};e.getGraphicEffectiveElevationMode=d;e.getZForElevationMode=function(n,D,
r){if(!f.isNone(r)&&r.mode){var u=n.hasZ?n.z:0,t=f.isSome(r.offset)?r.offset:0;switch(r.mode){case "absolute-height":return u-t;case "on-the-ground":return 0;case "relative-to-ground":return n=f.unwrapOr(D.elevationProvider.getElevation(n.x,n.y,n.z,n.spatialReference,"ground"),0)+t,u-n;case "relative-to-scene":return n=f.unwrapOr(D.elevationProvider.getElevation(n.x,n.y,n.z,n.spatialReference,"scene"),0)+t,u-n}}};e.hasGraphicFeatureExpressionInfo=function(n){if("on-the-ground"===d(n))return!1;n=v(n);
n=f.isSome(n)&&n.featureExpressionInfo?n.featureExpressionInfo.expression:null;return!(!n||"0"===n)};e.zValueInAbsoluteHeightMode=a;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/dragEventPipeline":function(){define("exports ../../geometry ../../core/handleUtils ../../core/lang ../../core/mathUtils ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../geometry/projection ../ViewingMode ../draw/support/drawUtils ../../geometry/Point".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r){function u(q,B){let C=null,x=null;return y=>{if("cancel"===y.action)d.isSome(x)&&(x.execute({action:"cancel"}),x=C=null);else{var G={action:y.action,screenStart:y.start,screenEnd:y.screenPoint};"start"===y.action&&d.isNone(C)&&(C=new H,x=new H,B(q,C,x,y.pointerType,G));d.isSome(C)&&C.execute(G);"end"===y.action&&d.isSome(C)&&(x=C=null)}}}function t(q,B){return q.events.on("drag",u(q,B))}function h(q,B){let C=null;return x=>{"start"===x.action&&(C=w(q,x.mapStart.spatialReference,
B));if(d.isNone(C))return null;const y=x.mapEnd.x-x.mapStart.x,G=x.mapEnd.y-x.mapStart.y,E=x.mapEnd.z-x.mapStart.z;C.move(y,G,E);return{...x,translationX:y,translationY:G,translationZ:E}}}function z(q,B){return d.isNone(q)?null:q.spatialReference.equals(B)?q.clone():a.project(q,B)}function w(q,B,C){const x=q.geometry;if(d.isNone(x))return null;if("mesh"===x.type)return A(q,x,B,C);const y=z(x,B),G=x.spatialReference;return d.isNone(y)?null:{move:(E,J,N)=>{E=D.move(y.clone(),E,J,N);E.spatialReference.equals(G)?
q.geometry=E:q.geometry=a.project(E,G)}}}function A(q,B,C,x){if(d.isSome(B.transform))return c(q,B,B.transform,C);if(!B.spatialReference.equals(C))return null;let y=0,G=0,E=0;return{move:(J,N,F)=>{var M=J-y;const L=N-G,O=F-E;if(M||L||O)M=new r(B.origin.x+M,B.origin.y+L,B.origin.z+O,B.origin.spatialReference),B.centerAt(M,{geographic:x===n.ViewingMode.Global}),q.notifyGeometryChanged(),y=J,G=N,E=F}}}function c(q,B,C,x){const y=C.getOriginPoint(B.spatialReference),G=z(y,x),E=B.spatialReference;return d.isNone(G)?
null:{move:(J,N,F)=>{J=D.move(G.clone(),J,N,F);J.spatialReference.equals(E)?C.origin=m.fromValues(J.x,J.y,J.z):(J=a.project(J,E),d.isSome(J)&&(C.origin=m.fromValues(J.x,J.y,J.z)));q.notifyMeshTransformChanged();q.notifyGeometryChanged()}}}function b(q,B){const C=new Map;for(const x of B)C.set(x,I.clone(q[x]));return x=>{C.forEach((y,G)=>{q[G]=y});return x}}function l(q){return d.isSome(q.geometry)&&"mesh"===q.geometry.type?g(q,q.geometry):b(q,["geometry"])}function g(q,B){const C=d.isSome(B.transform)?
B.transform.clone():null,x=B.vertexAttributes.clonePositional();return y=>{B.transform=C;B.vertexAttributes=x;q.notifyGeometryChanged();return y}}let H=function(){function q(){this.execute=()=>{}}q.prototype.next=function(B,C=new q){d.isSome(B)&&(this.execute=x=>{x=B(x);d.isSome(x)&&C.execute(x)});return C};return q}();e.EventPipeline=H;e.addMapDelta=function(){let q=0,B=0,C=0;return x=>{"start"===x.action&&(q=x.mapStart.x,B=x.mapStart.y,C=x.mapStart.z);const y=x.mapEnd.x-q,G=x.mapEnd.y-B,E=x.mapEnd.z-
C;q=x.mapEnd.x;B=x.mapEnd.y;C=x.mapEnd.z;return{...x,mapDeltaX:y,mapDeltaY:G,mapDeltaZ:E,mapDeltaSpatialReference:x.mapStart.spatialReference}}};e.addScreenDelta=function(){let q=0,B=0;return C=>{"start"===C.action&&(q=C.screenStart.x,B=C.screenStart.y);const x=C.screenEnd.x-q,y=C.screenEnd.y-B;q=C.screenEnd.x;B=C.screenEnd.y;return{...C,screenDeltaX:x,screenDeltaY:y}}};e.constrainToMapAxis=function(q,B){const C=[q.x,q.y,q.z],x=[Math.cos(B),Math.sin(B)];q=Math.sqrt(x[0]*x[0]+x[1]*x[1]);if(0===q)return null;
x[0]/=q;x[1]/=q;const y=G=>{const E=(G.x-C[0])*x[0]+(G.y-C[1])*x[1];G.x=C[0]+E*x[0];G.y=C[1]+E*x[1]};return G=>{y(G.mapStart);y(G.mapEnd);return G}};e.createDragEventPipelineCallback=u;e.createManipulatorDragEventPipeline=t;e.createManipulatorDragEventPipelineMany=function(q,B){const C=[];for(const x of q)C.push(t(x,B));return k.handlesGroup(C)};e.dragAtLocation=function(q,B){let C=null,x=0,y=0;return G=>{"start"===G.action&&(C=q.toScreen(B),0>C.x||C.x>q.width||0>C.y||C.y>q.height?C=null:(x=G.screenStart.x-
C.x,y=G.screenStart.y-C.y));if(null==C)return null;var E=p.clamp(G.screenEnd.x-x,0,q.width);const J=p.clamp(G.screenEnd.y-y,0,q.height);E=v.createScreenPoint(E,J);G.screenStart=C;G.screenEnd=E;return G}};e.dragGraphic=h;e.dragGraphicMany=function(q,B){const C=q.map(x=>d.unwrap(h(x,B))).filter(x=>d.isSome(x));return x=>{const y=x.mapEnd.x-x.mapStart.x,G=x.mapEnd.y-x.mapStart.y,E=x.mapEnd.z-x.mapStart.z;C.forEach(J=>J(x));return{...x,translationX:y,translationY:G,translationZ:E}}};e.resetGraphic=l;
e.resetGraphicMany=function(q){const B=q.map(C=>d.unwrap(l(C))).filter(C=>d.isSome(C));return C=>{B.forEach(x=>x(C));return C}};e.resetProperties=b;e.resetSymbol=function(q){return b(q,["symbol"])};e.screenToMap=function(q,B=null,C){let x=null;const y=d.isSome(B)&&!q.spatialReference.equals(B)?E=>d.isSome(E)?a.project(E,B):E:E=>E,G={exclude:[],...C};return E=>{"start"===E.action&&(x=y(q.toMap(E.screenStart,G)));if(d.isNone(x))return null;const J=y(q.toMap(E.screenEnd,G));return d.isSome(J)?{...E,
mapStart:x,mapEnd:J}:null}};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/draw/support/drawUtils":function(){define(["exports","../../../core/mathUtils","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/coordsUtils"],function(e,f,k,I,p){function d(a,n,D,r){null==r||a.hasZ||(r=void 0);if("point"===a.type)return a.x+=n,a.y+=D,a.hasZ&&null!=r&&(a.z+=r),a;if("multipoint"===a.type){var u=
a.points;for(var t=0;t<u.length;t++)u[t]=v(u[t],n,D,r);return a}if("extent"===a.type)return a.xmin+=n,a.xmax+=n,a.ymin+=D,a.ymax+=D,null!=r&&(a.zmin+=r,a.zmax+=r),a;u=p.geometryToCoordinates(a);t="polyline"===a.type?a.paths:a.rings;for(let h=0;h<u.length;h++){const z=u[h];for(let w=0;w<z.length;w++)z[w]=v(z[w],n,D,r)}"paths"in a?a.paths=t:a.rings=t;return a}function v(a,n,D,r){return m(a,a[0]+n,a[1]+D,null!=a[2]&&null!=r?a[2]+r:void 0)}function m(a,n,D,r){n=[n,D];2<a.length&&n.push(null!=r?r:a[2]);
3<a.length&&n.push(a[3]);return n}e.cloneMove=function(a,n,D,r,u){a=a.clone();var t=r.resolution;if("point"===a.type)return u?d(a,n*t,-D*t):(u=r.state.transform,r=r.state.inverseTransform,t=u[0]*a.x+u[2]*a.y+u[4],u=u[1]*a.x+u[3]*a.y+u[5],a.x=r[0]*(t+n)+r[2]*(u+D)+r[4],a.y=r[1]*(t+n)+r[3]*(u+D)+r[5]),a;if("multipoint"===a.type){if(u)d(a,n*t,-D*t);else{u=a.points;t=r.state.transform;r=r.state.inverseTransform;for(var h=0;h<u.length;h++){var z=u[h],w=t[0]*z[0]+t[2]*z[1]+t[4],A=t[1]*z[0]+t[3]*z[1]+t[5];
u[h]=m(z,r[0]*(w+n)+r[2]*(A+D)+r[4],r[1]*(w+n)+r[3]*(A+D)+r[5],void 0)}}return a}if("extent"===a.type)return u?d(a,n*t,-D*t):(u=r.state.transform,r=r.state.inverseTransform,t=u[0]*a.xmin+u[2]*a.ymin+u[4],h=u[1]*a.xmin+u[3]*a.ymin+u[5],z=u[0]*a.xmax+u[2]*a.ymax+u[4],u=u[1]*a.xmax+u[3]*a.ymax+u[5],a.xmin=r[0]*(t+n)+r[2]*(h+D)+r[4],a.ymin=r[1]*(t+n)+r[3]*(h+D)+r[5],a.xmax=r[0]*(z+n)+r[2]*(u+D)+r[4],a.ymax=r[1]*(z+n)+r[3]*(u+D)+r[5]),a;if(u)d(a,n*t,-D*t);else{u=p.geometryToCoordinates(a);t="polyline"===
a.type?a.paths:a.rings;h=r.state.transform;r=r.state.inverseTransform;for(z=0;z<u.length;z++)for(w=u[z],A=0;A<w.length;A++){const c=w[A],b=h[0]*c[0]+h[2]*c[1]+h[4],l=h[1]*c[0]+h[3]*c[1]+h[5];w[A]=m(c,r[0]*(b+n)+r[2]*(l+D)+r[4],r[1]*(b+n)+r[3]*(l+D)+r[5],void 0)}"paths"in a?a.paths=t:a.rings=t}return a};e.getRotationAngle=function(a,n,D){a=Math.atan2(n.y-D.y,n.x-D.x)-Math.atan2(a.y-D.y,a.x-D.x);return f.rad2deg(Math.atan2(Math.sin(a),Math.cos(a)))};e.getScaleRatio=function(a,n,D,r,u,t){return Math.sqrt((u-
a)*(u-a)+(t-n)*(t-n))/Math.sqrt((D-a)*(D-a)+(r-n)*(r-n))};e.move=d;e.scale=function(a,n,D,r){if("point"===a.type){const {x:l,y:g}=a;var u=r?r[0]:l,t=r?r[1]:g;a=a.clone();D=(g-t)*D+t;a.x=(l-u)*n+u;a.y=D;return a}if("multipoint"===a.type){u=p.geometryToCoordinates(a);t=k.create();const [l,g,H,q]=I.getRingsOrPathsBounds(t,[u]);u=r?r[0]:(l+H)/2;t=r?r[1]:(q+g)/2;a=a.clone();r=a.points;for(var h=0;h<r.length;h++){var z=r[h];const [B,C]=z;r[h]=m(z,(B-u)*n+u,(C-t)*D+t,void 0)}return a}if("extent"===a.type){const {xmin:l,
xmax:g,ymin:H,ymax:q}=a;u=r?r[0]:(l+g)/2;t=r?r[1]:(q+H)/2;a=a.clone();a.xmin=(l-u)*n+u;a.ymax=(q-t)*D+t;a.xmax=(g-u)*n+u;a.ymin=(H-t)*D+t;a.xmin>a.xmax&&(n=a.xmin,a.xmin=a.xmax,a.xmax=n);a.ymin>a.ymax&&(n=a.ymin,a.ymin=a.ymax,a.ymax=n);return a}u=p.geometryToCoordinates(a);t=k.create();const [w,A,c,b]=I.getRingsOrPathsBounds(t,u);t=r?r[0]:(w+c)/2;r=r?r[1]:(b+A)/2;a=a.clone();h="polyline"===a.type?a.paths:a.rings;for(z=0;z<u.length;z++){const l=u[z];for(let g=0;g<l.length;g++){const H=l[g],[q,B]=H;
h[z][g]=m(H,(q-t)*n+t,(B-r)*D+r,void 0)}}"paths"in a?a.paths=h:a.rings=h;return a};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DView":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec3f64 ../../../../../geometry/support/lineSegment ../../../analysis/interfaces ../../../analysis/DirectLineMeasurement/interfaces ../../manipulatorUtils ../../visualElements/LaserlineVisualElement".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z,w,A){const c={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5};var b;(function(l){l.Manipulators="manipulators";l.AnalysisViewDestroyed="analysis-view-destroyed";l.AnalysisView="analysis-view"})(b||(b={}));e.DirectLineMeasurement3DView=function(l){function g(q){q=l.call(this,q)||this;q.params=c;q.analysisViewData=
null;q.cursorPoint=null;q._visible=!1;q._laserLine=null;q.laserLineEnabled=!0;q._handles=new p;q._lastDraggedHandle=null;return q}f._inheritsLoose(g,l);var H=g.prototype;H.initialize=function(){this._laserLine=new A.LaserlineVisualElement({view:this.view,attached:!0});this._updateVisibility(this._visible);this._connectToAnalysisView()};H.destroy=function(){this._handles=d.destroyMaybe(this._handles);this._laserLine=d.destroyMaybe(this._laserLine)};H.createManipulators=function(){var q=()=>{const y=
w.createSphereManipulator(this.view,this.params.handleColor,this.params.handleOpacity);y.available=!1;y.radius=this.params.handleRadius;return y};const B=q(),C=q();d.isSome(this.analysis.startPoint)&&(B.location=this.analysis.startPoint,B.available=!0);d.isSome(this.analysis.endPoint)&&(C.location=this.analysis.endPoint,C.available=!0);var x=()=>{let y=this._lastDraggedHandle;B.grabbing&&!C.grabbing&&(y="start");C.grabbing&&!B.grabbing&&(y="end");B.grabbing||C.grabbing||(y=null);this._lastDraggedHandle=
y};q=B.events.on("grab-changed",x);x=C.events.on("grab-changed",x);this._handles.add([q,x],b.Manipulators);return{start:B,end:C}};H.show=function(){this.destroyed||this._visible||this._updateVisibility(!0)};H.hide=function(){!this.destroyed&&this._visible&&this._updateVisibility(!1)};H._connectToAnalysisView=function(){this._handles.remove(b.AnalysisView);this._handles.add([v.watch(()=>d.applySome(this.analysisViewData,q=>q.destroyed),q=>{q&&this._handles.remove(b.AnalysisView)},v.initial),v.watch(()=>
["measured"===this.toolState.lineState,this.analysisViewData],([q,B])=>{d.isSome(B)&&!B.destroyed&&(B.allowVisualElementsOrientationChange=!q)},v.initial),v.watch(()=>this._laserLineParams,q=>{const B=this._laserLine;B.heightManifoldTarget=q.heightManifoldTarget;B.pointDistanceLine=q.pointDistanceLine;B.lineVerticalPlaneSegment=q.lineVerticalPlaneSegment},v.initial)],b.AnalysisView)};H._updateVisibility=function(q){this.constructed&&((this._visible=q)?this._laserLine.style={innerColor:this.params.laserLineInnerColor,
innerWidth:this.params.laserLineInnerWidth,glowColor:this.params.laserLineGlowColor,glowWidth:this.params.laserLineGlowWidth,glowFalloff:this.params.laserLineGlowFalloff,globalAlpha:this.params.laserLineGlobalAlpha}:this.view.cursor=null,this._laserLine.visible=q)};f._createClass(g,[{key:"visible",get:function(){return this._visible},set:function(q){q?this.show():this.hide()}},{key:"testData",get:function(){const q=this._laserLine.testData,B=this.analysisViewData.testData;return{labels:null==B?void 0:
B.labels,stripeLength:null==B?void 0:B.stripeLength,laserLineRenderer:{heightManifoldEnabled:d.isSome(q)?q.heightManifoldEnabled:!1,heightManifoldTarget:d.isSome(q)?q.heightManifoldTarget:null,pointDistanceEnabled:d.isSome(q)?q.pointDistanceEnabled:!1,pointDistanceOrigin:d.isSome(q)?q.pointDistanceOrigin:null,pointDistanceTarget:d.isSome(q)?q.pointDistanceTarget:null,lineVerticalPlaneEnabled:d.isSome(q)?q.lineVerticalPlaneEnabled:!1}}}},{key:"_cursorPosition",get:function(){const q=u.create();d.applySome(this.cursorPoint,
B=>this.view.renderCoordsHelper.toRenderCoords(B,q));return q}},{key:"_startPosition",get:function(){const q=u.create();d.applySome(this.analysis.startPoint,B=>this.view.renderCoordsHelper.toRenderCoords(B,q));return q}},{key:"_endPosition",get:function(){const q=u.create();d.applySome(this.analysis.endPoint,B=>this.view.renderCoordsHelper.toRenderCoords(B,q));return q}},{key:"_laserLineParams",get:function(){const q=this._focusPosition,{active:B,lineState:C}=this.toolState,x=this.analysisViewData,
y=this.laserLineEnabled&&!!q&&"measured"!==C&&B;if(!y||!this.visible||d.isNone(x)||x.destroyed)return{heightManifoldTarget:null,pointDistanceLine:null,lineVerticalPlaneSegment:null};const G=x.actualVisualizedMeasurement;return{heightManifoldTarget:"euclidean"===G?q:null,pointDistanceLine:"local"!==this.view.viewingMode&&y&&this.analysis.startPoint&&"geodesic"===G?this._pointDistanceLine:null,lineVerticalPlaneSegment:y&&x.viewMode===z.ViewMode.Triangle?t.fromPoints(this._startPosition,this._endPosition):
null}}},{key:"_focusPosition",get:function(){const {lineState:q}=this.toolState;var B=this.analysisViewData;B=d.isSome(B)&&!B.destroyed&&B.measurementMode===h.MeasurementMode.Euclidean&&B.viewMode===z.ViewMode.Direct;switch(q){case "drawing":return B?this._startPosition:this.analysis.endPoint?this._endPosition:this._startPosition;case "editing":return B?"start"===this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return d.isSome(this.cursorPoint)?
this._cursorPosition:null}}},{key:"_pointDistanceLine",get:function(){return{origin:"drawing"===this.toolState.lineState||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition,target:this._focusPosition}}}]);return g}(I);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"view",void 0);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"params",void 0);k.__decorate([m.property({constructOnly:!0})],e.DirectLineMeasurement3DView.prototype,"analysis",
void 0);k.__decorate([m.property({constructOnly:!0})],e.DirectLineMeasurement3DView.prototype,"analysisViewData",void 0);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"cursorPoint",void 0);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"toolState",void 0);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"visible",null);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"testData",null);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,
"_visible",void 0);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"_laserLine",void 0);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"laserLineEnabled",void 0);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"_cursorPosition",null);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"_startPosition",null);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"_endPosition",null);k.__decorate([m.property()],
e.DirectLineMeasurement3DView.prototype,"_lastDraggedHandle",void 0);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"_laserLineParams",null);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"_focusPosition",null);k.__decorate([m.property()],e.DirectLineMeasurement3DView.prototype,"_pointDistanceLine",null);e.DirectLineMeasurement3DView=k.__decorate([r.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DView")],
e.DirectLineMeasurement3DView);Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/analysis/interfaces":function(){define(["exports"],function(e){e.MeasurementMode=void 0;var f=e.MeasurementMode||(e.MeasurementMode={});f[f.Auto=0]="Auto";f[f.Euclidean=1]="Euclidean";f[f.Geodesic=2]="Geodesic";Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/analysis/DirectLineMeasurement/interfaces":function(){define(["exports"],
function(e){e.ViewMode=void 0;(function(f){f[f.None=0]="None";f[f.Direct=1]="Direct";f[f.Triangle=2]="Triangle";f[f.ProjectedGeodesic=3]="ProjectedGeodesic"})(e.ViewMode||(e.ViewMode={}));e.VisualElementOrientation=void 0;(function(f){f[f.Auto=0]="Auto";f[f.AboveSegment=1]="AboveSegment";f[f.BelowSegment=2]="BelowSegment"})(e.VisualElementOrientation||(e.VisualElementOrientation={}));Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/manipulatorUtils":function(){define("exports ../../../core/maybe ../../../chunks/mat4 ../../../chunks/vec3 ../../../chunks/vec4f64 ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ./Manipulator3D ../layers/graphics/graphicUtils ../webgl-engine/lib/basicInterfaces ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Material ../webgl-engine/materials/ColorMaterial ../webgl-engine/materials/ShadedColorMaterial".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t){function h(A,c=r.RenderOccludedFlag.OccludeAndTransparent,b=!0){const l=p.fromValues(A[0],A[1],A[2],3<A.length?A[3]:1);A=1>A[3];return b?new t.ShadedColorMaterial({color:l,transparent:A,writeDepth:!0,cullFace:n.CullFaceOptions.Back,renderOccluded:c}):new u.ColorMaterial({color:l,transparent:A,writeDepth:!0,cullFace:n.CullFaceOptions.Back,renderOccluded:c})}function z(A,c,b,l){A=I.normalize(d.sv3d.get(),A);c=I.normalize(d.sv3d.get(),c);const g=I.cross(d.sv3d.get(),
A,c);l[0]=A[0];l[1]=A[1];l[2]=A[2];l[3]=0;l[4]=c[0];l[5]=c[1];l[6]=c[2];l[7]=0;l[8]=g[0];l[9]=g[1];l[10]=g[2];l[11]=0;l[12]=b[0];l[13]=b[1];l[14]=b[2];l[15]=1;return l}function w(A,c){const b=A.getViewForGraphic(c);return f.isSome(b)&&"computeAttachmentOrigin"in b?b.computeAttachmentOrigin(c,A.spatialReference):null}e.calculateInputRotationTransform=function(A,c,b,l){A=I.subtract(d.sv3d.get(),A,b);l=I.cross(d.sv3d.get(),l,A);b=z(A,l,b,d.sm4d.get());k.invert(b,b);c=I.transformMat4(d.sv3d.get(),c,b);
return Math.atan2(c[1],c[0])};e.calculateTranslateRotateFromBases=z;e.createManipulatorMaterial=h;e.createManipulatorOutlineMaterial=function(A,c=r.RenderOccludedFlag.OccludeAndTransparent){A=p.fromValues(A[0],A[1],A[2],4===A.length?A[3]:1);return new u.ColorMaterial({color:A,transparent:!0,writeDepth:!0,cullFace:n.CullFaceOptions.Front,renderOccluded:c})};e.createSphereManipulator=function(A,c,b){return new m.Manipulator3D({view:A,renderObjects:[{geometry:D.createSphereGeometry(1,32,32),material:h(p.fromValues(c[0],
c[1],c[2],null!=b?b:1))}]})};e.getGraphicAttachmentOrigin=w;e.placeAtGraphic=function(A,c,b){A=w(A,b);f.isSome(A)?c.elevationAlignedLocation=A:(b=b.geometry,f.isNone(b)||(b="mesh"===b.type?b.anchor:a.computeCentroid(b),f.isNone(b)||(c.location=v.hydrateGeometry(b))))};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/Manipulator3D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/compilerUtils ../../../core/Evented ../../../core/mathUtils ../../../core/maybe ../../../core/screenUtils ../../../core/accessorSupport/utils ../../../chunks/mat3 ../../../chunks/mat3f64 ../../../chunks/mat4 ../../../chunks/mat4f64 ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projection ../../../geometry/projectionEllipsoid ../../../geometry/support/aaBoundingRect ../../../geometry/support/lineSegment ../../../geometry/support/plane ../../../geometry/support/ray ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ../support/ElevationProvider ../support/geometryUtils/ray ../webgl-engine/lib/basicInterfaces ../webgl-engine/lib/Camera ../webgl-engine/lib/Object3D ../webgl-engine/lib/WebGLLayer ../../interactive/interfaces ../../../geometry/Point".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z,w,A,c,b,l,g,H,q,B,C,x,y,G,E,J,N){function F(fa){return 0!==fa[12]||0!==fa[13]||0!==fa[14]}k=function(){function fa(K){this.camera=new y.Camera;this._elevation={offset:0,override:null};this.collisionType={type:"point"};this.collisionPriority=0;this._renderObjects=[];this._available=this.autoScaleRenderObjects=!0;this._noDisplayCount=0;this._radius=10;this._worldSized=!1;this.focusMultiplier=2;this.touchMultiplier=2.5;this.worldOriented=!1;this._modelTransform=
u.create();this._worldFrame=null;this._renderLocation=z.create();this._renderLocationDirty=!0;this._location=new N({x:0,y:0,z:0});this._elevationAlignedLocation=new N;this.interactive=this._elevationAlignedLocationDirty=!0;this.selectable=!1;this.grabbable=!0;this.cursor=null;this._selected=this._hovering=this.dragging=this._grabbing=!1;this._state=J.ManipulatorStateCustomFlags.None;this._focused=!1;this.events=new p.EventEmitter;this._screenLocation={screenPointArray:m.createScreenPointArray(),renderScreenPointArray:m.createRenderScreenPointArray3(),
pixelSize:0};this._screenLocationDirty=!0;this._applyObjectTransform=null;this._engineResourcesAddedToStage=!1;this._engineResources=null;this._attached=!1;this._materialIdReferences=this._engineLayer=null;this._location.spatialReference=K.view.spatialReference;for(const P in K)this[P]=K[P];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}var aa=fa.prototype;aa.destroy=function(){this._removeResourcesFromStage();this.camera=this.view=this._engineResources=null};
aa.disableDisplay=function(){this._noDisplayCount++;1===this._noDisplayCount&&this._updateEngineObject();return{remove:a.once(()=>{this._noDisplayCount--;0===this._noDisplayCount&&this._updateEngineObject()})}};aa._updateElevationAlignedLocation=function(){this._elevationAlignedLocation.x=this.location.x;this._elevationAlignedLocation.y=this.location.y;const K=v.isSome(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=K+this._elevation.offset;this._elevationAlignedLocation.spatialReference=
this.location.spatialReference;this._screenLocationDirty=this._renderLocationDirty=!0;this._elevationAlignedLocationDirty=!1};aa.grabbableForEvent=function(){return!0};aa.updateStateEnabled=function(K,P){this.state=P?this.state|K:this.state&~K};aa._setFocused=function(K){K!==this._focused&&(this._focused=K,this.events.emit("focus-changed",{action:!0===K?"focus":"unfocus"}))};aa._ensureScreenLocation=function(){if(this._screenLocationDirty){this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation);
this._screenLocationDirty=!1;if(F(this._modelTransform)){var K=this._calculateModelTransformOffset(ea);K=h.add(K,K,this.renderLocation)}else K=this.renderLocation;this.camera.projectToRenderScreen(K,this._screenLocation.renderScreenPointArray);this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}};aa.intersectionDistance=function(K,P){if(!this.available)return null;K=m.screenPointObjectToArray(K,M);var U=this._getCollisionRadius(P);P=-1*this.collisionPriority;
switch(this.collisionType.type){case "point":if(t.squaredDistance(this.screenLocation.screenPointArray,K)<U*U)return this.screenLocation.renderScreenPointArray[2]+P;break;case "line":var S=this.collisionType.paths,R=this._getWorldToScreenObjectScale();R=this._calculateObjectTransform(R,V);U*=this.screenLocation.pixelSize;K=C.fromScreen(this.camera,K,O);if(v.isNone(K))break;for(var W of S)if(0!==W.length){S=h.transformMat4(Z,W[0],R);for(var T=1;T<W.length;T++){var ca=h.transformMat4(ba,W[T],R),da=
b.closestRayDistance2(b.fromPoints(S,ca,L),K);if(null!=da&&da<U*U)return R=h.add(H.sv3d.get(),S,ca),h.scale(R,R,.5),K=m.castRenderScreenPointArray(H.sv3d.get()),this.camera.projectToRenderScreen(R,K),K[2]+P;h.copy(S,ca)}}break;case "disc":W=this.collisionType.direction;R=null!=(S=this.collisionType.offset)?S:z.ZEROS;S=this._getWorldToScreenObjectScale();S=this._calculateObjectTransform(S,V);U*=this.screenLocation.pixelSize;K=C.fromScreen(this.camera,K,O);if(v.isNone(K))break;T=n.fromMat4(Q,S);W=h.transformMat3(ka,
W,T);R=h.transformMat4(ia,R,S);l.fromPositionAndNormal(R,W,X);W=ja;if(l.intersectRay(X,K,W)&&h.squaredDistance(W,R)<U*U)return this.screenLocation.renderScreenPointArray[2]+P;break;case "ribbon":{const {paths:la,direction:ma}=this.collisionType;W=this._getWorldToScreenObjectScale();W=this._calculateObjectTransform(W,V);U*=this.camera.computeScreenPixelSizeAt(this.renderLocation);S=C.fromScreen(this.camera,K,O);if(v.isNone(S))break;K=n.fromMat4(Q,W);K=h.transformMat3(ka,ma,K);T=this._calculateModelTransformPosition(ia);
l.fromPositionAndNormal(T,K,X);K=ja;if(!l.intersectRay(X,S,K))break;for(R of la)if(0!==R.length)for(S=h.transformMat4(Z,R[0],W),T=1;T<R.length;T++){ca=h.transformMat4(ba,R[T],W);da=b.distance2(b.fromPoints(S,ca,L),K);if(null!=da&&da<U*U)return R=h.add(H.sv3d.get(),S,ca),h.scale(R,R,.5),K=m.castRenderScreenPointArray(H.sv3d.get()),this.camera.projectToRenderScreen(R,K),K[2]+P;h.copy(S,ca)}break}default:I.neverReached(this.collisionType)}return null};aa.attach=function(K={manipulator3D:{}}){if(this.view._stage){K=
K.manipulator3D;if(v.isNone(K.engineLayerId)){var P=new E.WebGLLayer({isPickable:!1,updatePolicy:x.UpdatePolicy.SYNC});this.view._stage.add(P);K.engineLayerId=P.id;this._engineLayer=P}else null!=(P=this.view._stage)&&P.getObject&&(this._engineLayer=this.view._stage.getObject(K.engineLayerId));K.engineLayerReferences=(K.engineLayerReferences||0)+1;this._materialIdReferences=K.materialIdReferences;v.isNone(this._materialIdReferences)&&(this._materialIdReferences=new Map,K.materialIdReferences=this._materialIdReferences);
this.camera.copyFrom(this.view.state.camera);this._attached=!0;this._updateEngineObject();w.canProjectWithoutEngine(this._location.spatialReference,this.view.spatialReference)||(this.location=new N({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}};aa.detach=function(K={manipulator3D:{}}){K=K.manipulator3D;K.engineLayerReferences--;const P=0===K.engineLayerReferences;P&&(K.engineLayerId=null);this._removeResourcesFromStage(P);this._materialIdReferences=this._engineLayer=this._engineResources=
null;this._attached=!1};aa.onViewChange=function(){this.camera.copyFrom(this.view.state.camera);this._screenLocationDirty=!0;this._updateEngineObject()};aa.onElevationChange=function(K){w.projectPoint(this.location,ha,K.spatialReference);c.containsPointObject(K.extent,ha)&&(this.location=this._location)};aa._evaluateElevationAlignment=function(K=this.location){if(v.isNone(this.elevationInfo))return!1;let P=null,U=0;const S=v.unwrapOr(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case "on-the-ground":P=
v.unwrapOr(B.getElevationAtPoint(this.view.elevationProvider,K,"ground"),0);break;case "relative-to-ground":U=v.unwrapOr(B.getElevationAtPoint(this.view.elevationProvider,K,"ground"),0)+S;break;case "relative-to-scene":U=v.unwrapOr(B.getElevationAtPoint(this.view.elevationProvider,K,"scene"),0)+S;break;case "absolute-height":U=S}return U!==this._elevation.offset||P!==this._elevation.override?(this._elevation.offset=U,this._elevation.override=P,!0):!1};aa._updateEngineObject=function(){if(this._attached)if(this.available){var K=
this._getWorldToScreenObjectScale(),P=V;!0===this.autoScaleRenderObjects?(K*=this._getFocusedSize(this._radius,this.focused),this._calculateObjectTransform(K,P)):this._calculateObjectTransform(K,P);var {objectsByState:U}=this._ensureEngineResources();K=(this.focused?J.ManipulatorStateFlags.Focused:J.ManipulatorStateFlags.Unfocused)|(this.selected?J.ManipulatorStateFlags.Selected:J.ManipulatorStateFlags.Unselected);var S=0<this._noDisplayCount;for(const {stateMask:R,objects:W}of U)if(S)for(const T of W)T.setVisible(!1);
else if(U=(R&J.ManipulatorStateCustomFlags.All)===J.ManipulatorStateCustomFlags.None||(this.state&R)===(R&J.ManipulatorStateCustomFlags.All),(R&J.ManipulatorStateFlags.All)!==J.ManipulatorStateFlags.None&&(K&R)!==(R&J.ManipulatorStateFlags.All)||!U)for(const T of W)T.setVisible(!1);else for(const T of W)T.setVisible(!0),T.transformation=P}else this._removeResourcesFromStage()};aa._ensureEngineResources=function(){if(v.isNone(this._engineResources)){const K=v.unwrap(this._engineLayer),P=[],U=new Set;
this.renderObjects.forEach(({material:T})=>{U.has(T)||(P.push(T),U.add(T))});const S=(T,ca)=>{const {geometry:da,material:la,transform:ma}=ca;Array.isArray(da)?da.forEach(na=>T.addGeometry(na,la,ma)):T.addGeometry(da,la,ma)},R=new Map;this._renderObjects.forEach(T=>{const ca=new G.Object3D({castShadow:!1});S(ca,T);T=T.stateMask||0;const da=R.get(T)||[];da.push(ca);R.set(T,da)});const W=[];R.forEach((T,ca)=>W.push({stateMask:ca,objects:T}));this._engineResources={objectsByState:W,layer:K,materials:P}}this._addResourcesToStage();
return this._engineResources};aa._addResourcesToStage=function(){if(!this._engineResourcesAddedToStage&&!v.isNone(this._engineResources)){var {objectsByState:K,layer:P,materials:U}=this._engineResources;U.forEach(S=>{const R=v.unwrap(this._materialIdReferences),W=R.get(S.id)||0;0===W&&this.view._stage.add(S);R.set(S.id,W+1)});K.forEach(({objects:S})=>{P.addMany(S);this.view._stage.addMany(S)});this._engineResourcesAddedToStage=!0}};aa._removeResourcesFromStage=function(K=!1){if(this._engineResourcesAddedToStage&&
!v.isNone(this._engineResources)&&this.view._stage){var {objectsByState:P,layer:U,materials:S}=this._engineResources;P.forEach(({objects:R})=>{U.removeMany(R);this.view._stage.removeMany(R)});S.forEach(R=>{const W=v.unwrap(this._materialIdReferences),T=W.get(R.id);1===T?(this.view._stage.remove(R),W.delete(R.id)):W.set(R.id,T-1)});K&&this.view._stage.remove(U);this._engineResourcesAddedToStage=!1}};aa._getCollisionRadius=function(K){return this._getFocusedSize(this.radius,!0)*("touch"===K?this.touchMultiplier:
1)};aa._getFocusedSize=function(K,P){return K*(P?this.focusMultiplier:1)};aa._getWorldToScreenObjectScale=function(){return this._worldSized?1:this.screenLocation.pixelSize};aa._calculateModelTransformPosition=function(K){var P=this._getWorldToScreenObjectScale();P=this._calculateObjectTransform(P,Y);return h.set(K,P[12],P[13],P[14])};aa._calculateModelTransformOffset=function(K){const P=this._calculateModelTransformPosition(K);return h.subtract(K,P,this.renderLocation)};aa._calculateObjectTransform=
function(K,P){r.set(P,K,0,0,0,0,K,0,0,0,0,K,0,0,0,0,1);this._worldFrame&&r.multiply(P,P,this._worldFrame);r.multiply(P,P,this._modelTransform);P[12]+=this.renderLocation[0];P[13]+=this.renderLocation[1];P[14]+=this.renderLocation[2];P[15]=1;v.isSome(this._applyObjectTransform)&&this._applyObjectTransform(P);return P};f._createClass(fa,[{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(K){this._elevationInfo=K;this._renderLocationDirty=this._elevationAlignedLocationDirty=
!0;this._updateEngineObject()}},{key:"renderObjects",get:function(){return this._renderObjects},set:function(K){this._removeResourcesFromStage();this._engineResources=null;this._renderObjects=K.slice();this._updateEngineObject()}},{key:"available",get:function(){return this._available},set:function(K){K!==this._available&&(this._available=K,this._updateEngineObject())}},{key:"radius",get:function(){return this._radius},set:function(K){K!==this._radius&&(this._radius=K,this._updateEngineObject())}},
{key:"worldSized",get:function(){return this._worldSized},set:function(K){K!==this._worldSized&&(this._worldSized=K,this._updateEngineObject())}},{key:"modelTransform",get:function(){return this._modelTransform},set:function(K){F(K)&&(this._screenLocationDirty=!0);r.copy(this._modelTransform,K);this._updateEngineObject()}},{key:"renderLocation",get:function(){if(this._renderLocationDirty)if(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),
this.worldOriented){this._worldFrame||(this._worldFrame=u.create());a:{var K=this.view,P=this._renderLocation,U=this._worldFrame;switch(K.viewingMode){case "local":r.identity(U);break a;case "global":K=A.getReferenceEllipsoid(K.renderCoordsHelper.spatialReference),w.sphericalPCPFtoLonLatElevation(P,0,Z,0,K.radius),w.computeENUToSphericalPCPFLocalRotation(d.deg2rad(Z[0]),d.deg2rad(Z[1]),U)}}}else this._worldFrame&&(this._worldFrame=null);return this._renderLocation},set:function(K){this.view.renderCoordsHelper.fromRenderCoords(K,
this._location);this.elevationAlignedLocation=this._location}},{key:"location",get:function(){return this._location},set:function(K){q.clonePoint(K,this._location);this._elevationAlignedLocationDirty=this._screenLocationDirty=this._renderLocationDirty=!0;this._updateEngineObject();this.events.emit("location-update",{location:this._location})}},{key:"elevationAlignedLocation",get:function(){if(!this._elevationAlignedLocationDirty)return this._elevationAlignedLocation;this._evaluateElevationAlignment();
this._updateElevationAlignedLocation();return this._elevationAlignedLocation},set:function(K){q.clonePoint(K,this._location);this._evaluateElevationAlignment();this._location.z-=this._elevation.offset;this._updateElevationAlignedLocation();this._updateEngineObject();this.events.emit("location-update",{location:this._location})}},{key:"grabbing",get:function(){return this._grabbing},set:function(K){K!==this._grabbing&&(this._grabbing=K,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},
{key:"hovering",get:function(){return this._hovering},set:function(K){K!==this._hovering&&(this._hovering=K,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"selected",get:function(){return this._selected},set:function(K){K!==this._selected&&(this._selected=K,this._updateEngineObject(),this.events.emit("select-changed",{action:K?"select":"deselect"}))}},{key:"state",get:function(){return this._state},set:function(K){K!==this._state&&(this._state=K,this._updateEngineObject())}},
{key:"focused",get:function(){return this._focused}},{key:"screenLocation",get:function(){this._ensureScreenLocation();return this._screenLocation}},{key:"applyObjectTransform",get:function(){return this._applyObjectTransform},set:function(K){this._applyObjectTransform=K;this._screenLocationDirty=!0;this._updateEngineObject()}},{key:"test",get:function(){let K=!1;if(v.isSome(this._engineResources))for(const P in this._engineResources.objectsByState){const U=this._engineResources.objectsByState[P];
for(const S of U.objects)if(S.isVisible){K=!0;break}if(K)break}return{areAnyResourcesVisible:K}}}]);return fa}();const M=m.createScreenPointArray(),L=b.create(),O=g.create(),Q=D.create(),Y=u.create(),V=u.create(),X=l.create(),Z=z.create(),ba=z.create(),ja=z.create(),ka=z.create(),ia=z.create(),ea=z.create(),ha=new N({x:0,y:0,z:0,spatialReference:null});e.Manipulator3D=k;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/materials/ShadedColorMaterial":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/buffer/BufferView ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutputOptions ../lib/basicInterfaces ../lib/GLMaterial ../lib/GLMaterials ../lib/Material ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./internal/bufferWriterUtils ./internal/MaterialUtil ../shaders/ShadedColorMaterialTechnique".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z,w,A,c){let b=function(C){function x(G){G=C.call(this,G,new g)||this;G.supportsEdges=!0;G.techniqueConfig=new c.ShadedColorMaterialTechniqueConfiguration;G._vertexAttributeLocations=c.ShadedColorMaterialVertexAttrLocations;return G}f._inheritsLoose(x,C);var y=x.prototype;y.getConfiguration=function(G,E){this.techniqueConfig.output=G;this.techniqueConfig.cullFace=this.parameters.cullFace;this.techniqueConfig.hasSlicePlane=this.parameters.hasSlicePlane;this.techniqueConfig.transparent=
this.parameters.transparent;this.techniqueConfig.writeDepth=this.parameters.writeDepth;this.techniqueConfig.screenSizeEnabled=this.parameters.screenSizeEnabled;this.techniqueConfig.shadingEnabled=this.parameters.shadingEnabled;this.techniqueConfig.transparencyPassType=E.transparencyPassType;this.techniqueConfig.hasMultipassTerrain=E.multipassTerrain.enabled;this.techniqueConfig.cullAboveGround=E.multipassTerrain.cullAboveGround;return this.techniqueConfig};y.intersect=function(G,E,J,N,F,M,L){if(this.parameters.screenSizeEnabled){const O=
G.vertexAttributes.get(z.VertexAttribute.OFFSET);A.intersectTriangleGeometry(G,E,N,F,M,{applyToVertex:(Q,Y,V,X)=>{X=k.set(q,O.data[3*X],O.data[3*X+1],O.data[3*X+2]);Q=k.set(B,Q,Y,V);k.scale(X,X,this.parameters.screenSizeScale*N.camera.computeRenderPixelSizeAt(X));k.add(Q,Q,X);return[Q[0],Q[1],Q[2]]},applyToAabb:Q=>{const Y=d.center(Q,q);return d.scale(Q,this.parameters.screenSizeScale*N.camera.computeRenderPixelSizeAt(Y))}},L)}else A.intersectTriangleGeometry(G,E,N,F,M,void 0,L)};y.requiresSlot=function(G,
E){if(r.outputFromPass(E)===a.ShaderOutput.Highlight)return G===t.RenderSlot.OPAQUE_MATERIAL;E=t.RenderSlot.OPAQUE_MATERIAL;this.parameters.transparent&&(E=this.parameters.writeDepth?t.RenderSlot.TRANSPARENT_MATERIAL:t.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL);return G===E||G===t.RenderSlot.DRAPED_MATERIAL};y.createGLMaterial=function(G){return G.output===a.ShaderOutput.Color||G.output===a.ShaderOutput.Alpha||G.output===a.ShaderOutput.Highlight?new l(G):null};y.createBufferWriter=function(){return new H(this.parameters.screenSizeEnabled)};
return x}(u.Material),l=function(C){function x(){return C.apply(this,arguments)||this}f._inheritsLoose(x,C);x.prototype.beginSlot=function(y){return this.ensureTechnique(c.ShadedColorMaterialTechnique,y)};return x}(D),g=function(C){function x(){var y=C.apply(this,arguments)||this;y.color=p.fromValues(1,1,1,1);y.shadingTint=p.fromValues(0,0,0,.25);y.shadingDirection=k.normalize(I.create(),[.5,-.5,-.5]);y.screenSizeScale=14;y.transparent=!1;y.writeDepth=!0;y.hasSlicePlane=!1;y.cullFace=n.CullFaceOptions.None;
y.screenSizeEnabled=!1;y.shadingEnabled=!0;return y}f._inheritsLoose(x,C);return x}(u.MaterialParameters),H=function(){function C(y){this.screenSizeEnabled=y;y=m.newLayout().vec3f(z.VertexAttribute.POSITION).vec3f(z.VertexAttribute.NORMAL);this.screenSizeEnabled&&y.vec3f(z.VertexAttribute.OFFSET);this.vertexBufferLayout=y}var x=C.prototype;x.allocate=function(y){return this.vertexBufferLayout.createBuffer(y)};x.elementCount=function(y){return y.indices.get(z.VertexAttribute.POSITION).length};x.write=
function(y,G,E,J){w.writeDefaultAttributes(G,this.vertexBufferLayout,y.transformation,y.invTranspTransformation,E,J);if(this.screenSizeEnabled)if(G.vertexAttributes.has(z.VertexAttribute.OFFSET)){const N=G.vertexAttributes.get(z.VertexAttribute.OFFSET);G=G.indices.get(z.VertexAttribute.OFFSET);h.assert(3===N.size);if(E=E.getField(z.VertexAttribute.OFFSET,v.BufferViewVec3f))w.writePosition(G,N.data,y.invTranspTransformation,E,J);else throw Error("unable to acquire view for "+z.VertexAttribute.OFFSET);
}else throw Error(`${z.VertexAttribute.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);};return C}();const q=I.create(),B=I.create();e.ShadedColorMaterial=b;e.ShadedColorMaterialParameters=g;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderLibrary/ShaderOutputOptions ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../lib/OrderIndependentTransparency ../lib/Program ../lib/VertexAttribute ../materials/DefaultTechniqueConfiguration ../../../../chunks/ShadedColorMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z){v=function(A){function c(){return A.apply(this,arguments)||this}k._inheritsLoose(c,A);var b=c.prototype;b.initializeProgram=function(l){const g=c.shader.get().build(this.configuration);return new D.Program(l.rctx,g,w)};b._setPipelineState=function(l){const g=this.configuration,H=l===a.TransparencyPassType.NONE,q=l===a.TransparencyPassType.FrontFace;return z.makePipelineState({blending:g.output!==p.ShaderOutput.Color&&g.output!==p.ShaderOutput.Alpha||!g.transparent?
null:H?n.blendingDefault:n.oitBlending(l),culling:z.cullingParams(g.cullFace),depthTest:{func:q?h.CompareFunction.LESS:g.shadingEnabled?h.CompareFunction.LEQUAL:h.CompareFunction.LESS},depthWrite:H?g.writeDepth&&z.defaultDepthWriteParams:n.oitDepthWrite(l),colorWrite:z.defaultColorWriteParams,polygonOffset:H||q?null:n.OITPolygonOffset})};b.initializePipeline=function(){return this._setPipelineState(this.configuration.transparencyPassType)};return c}(v.ShaderTechnique);v.shader=new d.ReloadableShaderModule(t.ShadedColorMaterialShader,
()=>new Promise((A,c)=>e(["./ShadedColorMaterial.glsl"],A,c)));d=function(A){function c(){var b=A.apply(this,arguments)||this;b.output=p.ShaderOutput.Color;b.cullFace=a.CullFaceOptions.None;b.transparencyPassType=a.TransparencyPassType.NONE;b.hasSlicePlane=!1;b.transparent=!1;b.writeDepth=!0;b.screenSizeEnabled=!0;b.shadingEnabled=!0;b.hasMultipassTerrain=!1;b.cullAboveGround=!1;return b}k._inheritsLoose(c,A);return c}(u.DefaultTechniqueConfiguration);I.__decorate([m.parameter({count:p.ShaderOutput.COUNT})],
d.prototype,"output",void 0);I.__decorate([m.parameter({count:a.CullFaceOptions.COUNT})],d.prototype,"cullFace",void 0);I.__decorate([m.parameter({count:a.TransparencyPassType.COUNT})],d.prototype,"transparencyPassType",void 0);I.__decorate([m.parameter()],d.prototype,"hasSlicePlane",void 0);I.__decorate([m.parameter()],d.prototype,"transparent",void 0);I.__decorate([m.parameter()],d.prototype,"writeDepth",void 0);I.__decorate([m.parameter()],d.prototype,"screenSizeEnabled",void 0);I.__decorate([m.parameter()],
d.prototype,"shadingEnabled",void 0);I.__decorate([m.parameter()],d.prototype,"hasMultipassTerrain",void 0);I.__decorate([m.parameter()],d.prototype,"cullAboveGround",void 0);const w=new Map([[r.VertexAttribute.POSITION,0],[r.VertexAttribute.NORMAL,1],[r.VertexAttribute.OFFSET,2]]);f.ShadedColorMaterialTechnique=v;f.ShadedColorMaterialTechniqueConfiguration=d;f.ShadedColorMaterialVertexAttrLocations=w;Object.defineProperties(f,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/ShadedColorMaterial.glsl":function(){define("exports ./vec4f64 ../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutputOptions ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/Float3PassUniform ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/basicInterfaces ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z,w){function A(b){const l=new h.ShaderBuilder,g=b.hasMultipassTerrain&&(b.output===I.ShaderOutput.Color||b.output===I.ShaderOutput.Alpha);l.include(d.Transform);l.include(k.ScreenSizeScaling,b);l.include(p.SliceDraw,b);const {vertex:H,fragment:q}=l;q.include(a.ColorConversion);n.addProjViewLocalOrigin(l,b);q.uniforms.add(new r.Float4PassUniform("uColor",B=>B.color));l.attributes.add(w.VertexAttribute.POSITION,"vec3");l.varyings.add("vWorldPosition","vec3");
g&&l.varyings.add("depth","float");b.screenSizeEnabled&&l.attributes.add(w.VertexAttribute.OFFSET,"vec3");b.shadingEnabled&&(H.uniforms.add(new t.Matrix4PassUniform("viewNormal",(B,C)=>C.camera.viewInverseTransposeMatrix)),l.attributes.add(w.VertexAttribute.NORMAL,"vec3"),l.varyings.add("vViewNormal","vec3"));H.code.add(u.glsl`
    void main(void) {
      vWorldPosition = ${b.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `);b.shadingEnabled&&H.code.add(u.glsl`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`);H.code.add(u.glsl`
    ${g?"depth \x3d (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `);g&&l.include(v.multipassTerrainTest,b);q.code.add(u.glsl`
    void main() {
      discardBySlice(vWorldPosition);
      ${g?"terrainDepthTest(gl_FragCoord, depth);":""}
    `);b.shadingEnabled?(q.uniforms.add(new D.Float3PassUniform("shadingDirection",B=>B.shadingDirection)),q.uniforms.add(new r.Float4PassUniform("shadedColor",B=>{{var C=B.shadingTint;B=B.color;const x=1-C[3],y=C[3]+B[3]*x;0===y?c[3]=y:(c[0]=(C[0]*C[3]+B[0]*B[3]*x)/y,c[1]=(C[1]*C[3]+B[1]*B[3]*x)/y,c[2]=(C[2]*C[3]+B[2]*B[3]*x)/y,c[3]=B[3]);C=c}return C})),q.code.add(u.glsl`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):q.code.add(u.glsl`vec4 finalColor = uColor;`);q.code.add(u.glsl`
      if (finalColor.a < ${u.glsl.float(m.symbolAlphaCutoff)}) {
        discard;
      }
      ${b.output===I.ShaderOutput.Alpha?u.glsl`gl_FragColor = vec4(finalColor.a);`:""}

      ${b.output===I.ShaderOutput.Color?u.glsl`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${b.transparencyPassType===z.TransparencyPassType.Color?"gl_FragColor \x3d premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `);return l}const c=f.create();f=Object.freeze(Object.defineProperty({__proto__:null,build:A},Symbol.toStringTag,{value:"Module"}));e.ShadedColorMaterialShader=f;e.build=A})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl":function(){define(["exports","./util/View.glsl","../shaderModules/FloatPassUniform","../shaderModules/interfaces"],function(e,f,k,I){e.ScreenSizeScaling=function(p,d){d.screenSizeEnabled&&(p=p.vertex,f.addCameraPosition(p,d),p.uniforms.add(new k.FloatPassUniform("perScreenPixelRatio",
(v,m)=>m.camera.perScreenPixelRatio)),p.uniforms.add(new k.FloatPassUniform("screenSizeScale",v=>v.screenSizeScale)),p.code.add(I.glsl`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`))};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/visualElements/LaserlineVisualElement":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/support/lineSegment ./VisualElement ../../support/LaserLineRenderer ../../../../chunks/Laserlines.glsl".split(" "),function(e,f,k,I,p,d,v,m,a){v=function(D){function r(t){var h=
D.call(this,t.view)||this;h._angleCutoff=a.defaultAngleCutoff;h._style={};h._heightManifoldTarget=p.create();h._heightManifoldEnabled=!1;h._intersectsLine=d.create();h._intersectsLineEnabled=!1;h._intersectsLineInfinite=!1;h._lineVerticalPlaneSegment=null;h._pathVerticalPlaneBuffers=null;h._pointDistanceLine=null;h.applyProps(t);return h}f._inheritsLoose(r,D);var u=r.prototype;u.createResources=function(){this._ensureRenderer()};u.destroyResources=function(){this._disposeRenderer()};u.updateVisibility=
function(){this._syncRenderer();this._syncHeightManifold();this._syncIntersectsLine();this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance()};u._syncRenderer=function(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||k.isSome(this._pointDistanceLine)||k.isSome(this._pathVerticalPlaneBuffers))?this._ensureRenderer():this._disposeRenderer()};u._ensureRenderer=function(){k.isSome(this.renderer)||(this.renderer=new m.LaserLineRenderer(this.view.renderCoordsHelper,
void 0,{contrastControlEnabled:!0}),this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this.renderer.renderSlots,this.renderer))};u._syncStyle=function(){k.isNone(this.renderer)||(this.renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this.renderer.intersectsLineRadius=
this._style.intersectsLineRadius))};u._syncAngleCutoff=function(){k.isNone(this.renderer)||this.renderer.setParameters({angleCutoff:this._angleCutoff})};u._syncHeightManifold=function(){k.isNone(this.renderer)||(this.renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this.renderer.heightManifoldTarget=this._heightManifoldTarget))};u._syncIntersectsLine=function(){k.isNone(this.renderer)||(this.renderer.intersectsLineEnabled=this._intersectsLineEnabled&&
this.visible,this._intersectsLineEnabled&&(this.renderer.intersectsLineSegment=this._intersectsLine))};u._syncIntersectsLineInfinite=function(){k.isNone(this.renderer)||(this.renderer.intersectsLineInfinite=this._intersectsLineInfinite)};u._syncPathVerticalPlane=function(){k.isNone(this.renderer)||(this.renderer.pathVerticalPlaneEnabled=k.isSome(this._pathVerticalPlaneBuffers)&&this.visible,k.isSome(this._pathVerticalPlaneBuffers)&&(this.renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))};
u._syncLineVerticalPlane=function(){k.isNone(this.renderer)||(this.renderer.lineVerticalPlaneEnabled=k.isSome(this._lineVerticalPlaneSegment)&&this.visible,k.isSome(this._lineVerticalPlaneSegment)&&(this.renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))};u._syncPointDistance=function(){k.isNone(this.renderer)||(this.renderer.pointDistanceEnabled=k.isSome(this._pointDistanceLine)&&this.visible,k.isSome(this._pointDistanceLine)&&(this.renderer.pointDistanceOrigin=this._pointDistanceLine.origin,
this.renderer.pointDistanceTarget=this._pointDistanceLine.target))};u._disposeRenderer=function(){k.isSome(this.renderer)&&this.view._stage&&(this.view._stage.removeRenderPlugin(this.renderer),this.renderer=null)};f._createClass(r,[{key:"testData",get:function(){return this.renderer}},{key:"angleCutoff",get:function(){return this._angleCutoff},set:function(t){this._angleCutoff!==t&&(this._angleCutoff=t,this._syncAngleCutoff())}},{key:"style",get:function(){return this._style},set:function(t){this._style=
t;this._syncStyle()}},{key:"heightManifoldTarget",get:function(){return this._heightManifoldEnabled?this._heightManifoldTarget:null},set:function(t){k.isSome(t)?(I.copy(this._heightManifoldTarget,t),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1;this._syncRenderer();this._syncHeightManifold()}},{key:"intersectsWorldUpAtLocation",set:function(t){if(k.isNone(t))this.intersectsLine=null;else{var h=this.view.renderCoordsHelper.worldUpAtPosition(t,n);this.intersectsLine=d.fromValues(t,
h);this.intersectsLineInfinite=!0}}},{key:"intersectsLine",get:function(){return this._intersectsLineEnabled?this._intersectsLine:null},set:function(t){k.isSome(t)?(d.copy(t,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1;this._syncIntersectsLine();this._syncRenderer()}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(t){this._intersectsLineInfinite=t;this._syncIntersectsLineInfinite()}},{key:"lineVerticalPlaneSegment",
get:function(){return this._lineVerticalPlaneSegment},set:function(t){this._lineVerticalPlaneSegment=k.isSome(t)?d.copy(t):null;this._syncLineVerticalPlane();this._syncRenderer()}},{key:"pathVerticalPlane",get:function(){return this._pathVerticalPlaneBuffers},set:function(t){this._pathVerticalPlaneBuffers=t;this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance();this._syncRenderer()}},{key:"pointDistanceLine",get:function(){return this._pointDistanceLine},set:function(t){this._pointDistanceLine=
k.isSome(t)?{origin:p.clone(t.origin),target:p.clone(t.target)}:null;this._syncPointDistance();this._syncRenderer()}}]);return r}(v.VisualElement);const n=p.create();e.LaserlineVisualElement=v;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/visualElements/VisualElement":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/reactiveUtils"],function(e,f,k){let I=function(){function p(v){this._resourcesCreated=
this._attached=!1;this._visible=!0;this.view=v;this._handle=k.watch(()=>this.view.ready,m=>{this._resourcesCreated&&(m?this._createResources():this._destroyResources())})}var d=p.prototype;d.applyProps=function(v){let m=!1;for(const a in v)a in this?"attached"===a?m=v[a]:this[a]=v[a]:console.error("Cannot set unknown property",a);this.attached=m};d.destroy=function(){this.attached=!1;this._handle.remove()};d._createResources=function(){this.createResources();this._resourcesCreated=!0;this.visible||
this.updateVisibility(!1)};d._destroyResources=function(){this.destroyResources();this._resourcesCreated=!1};f._createClass(p,[{key:"attached",get:function(){return this._attached},set:function(v){v!==this._attached&&this.view._stage&&((this._attached=v)&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}},{key:"visible",get:function(){return this._visible},set:function(v){v!==this._visible&&(this._visible=v,this.attached&&this.updateVisibility(v))}}]);
return p}();e.VisualElement=I;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/support/LaserLineRenderer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/mathUtils ../../../core/maybe ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/vec4 ../../../chunks/vec4f64 ../../../geometry/support/clipRay ../../../geometry/support/frustum ../../../geometry/support/lineSegment ../../../geometry/support/plane ../../../geometry/support/ray ../../../chunks/sphere ./LaserlinePathData ../webgl-engine/lib/glUtil3D ../webgl-engine/lib/RenderSlot ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/shaders/LaserlinePathTechnique ../webgl-engine/shaders/LaserlinePathTechniqueConfiguration ../webgl-engine/shaders/LaserlineTechnique ../webgl-engine/shaders/LaserlineTechniqueConfiguration ../../webgl/enums".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z,w,A,c,b,l,g,H){function q(J,N,F,M){const L=B,O=C;p.transformMat4(L,N,M);p.copy(O,F);O[3]=0;v.transformMat4(O,O,M);r.fromPositionAndNormal(L,O,J)}const B=d.create(),C=m.create(),x={glowColor:[1,.5,0],glowWidth:8,glowFalloff:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75,angleCutoff:k.deg2rad(6),globalAlphaContrastBoost:2,__tagStrict:"NoParameters"};k=function(){function J(F,M={},L={contrastControlEnabled:!1}){this._renderCoordsHelper=F;this._config=L;this._technique=
null;this._heightManifoldEnabled=!1;this._heightManifoldTarget=d.create();this._pointDistanceEnabled=!1;this._pointDistanceOrigin=d.create();this._pointDistanceTarget=d.create();this._lineVerticalPlaneEnabled=!1;this._lineVerticalPlaneSegment=D.create();this._intersectsLineEnabled=!1;this._intersectsLineSegment=D.create();this._intersectsLineRadius=3;this._pathVerticalPlaneEnabled=this._intersectsLineInfinite=!1;this._pathTechnique=this._pathVerticalPlaneData=null;this.canRender=!0;this._tempNormal=
d.create();this._tempDir=d.create();this._tempUp=d.create();this._tempVec3A=d.create();this._tempVec3B=d.create();this._tempVec4=m.create();this._tempPlane=r.create();this._tempSphere=t.create();this._parameters=A.copyParameters(M,x)}var N=J.prototype;N.setParameters=function(F){A.updateParameters(this._parameters,F)&&this._requestRender()};N.initializeRenderContext=function(F){this._context=F;this._quadVAO=z.createQuadVAO(F.renderContext.rctx);this._techniqueRepository=F.shaderTechniqueRepository;
this._techniqueConfig=new g.LaserlineTechniqueConfiguration;F=new b.LaserlinePathTechniqueConfiguration;F.contrastControlEnabled=this._config.contrastControlEnabled;this._pathTechnique=this._techniqueRepository.acquire(c.LaserlinePathTechnique,F)};N.uninitializeRenderContext=function(){this._quadVAO=I.disposeMaybe(this._quadVAO);this._technique=I.releaseMaybe(this._technique);this._pathVerticalPlaneData=I.disposeMaybe(this._pathVerticalPlaneData);this._pathTechnique=I.releaseMaybe(this._pathTechnique)};
N.prepareTechnique=function(){return this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled?(this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,
this._technique=this._techniqueRepository.releaseAndAcquire(l.LaserlineTechnique,this._techniqueConfig,this._technique)):this._pathTechnique};N.render=function(F,M){(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(F,M);this.pathVerticalPlaneEnabled&&this._renderPath(F)};N._renderUnified=function(F,M){const L=F.rctx;M=L.bindTechnique(M,this._parameters,F.bindParameters);this._bindGlobalUniforms(F,M);this._bindHeightManifoldUniforms(F,
M);this._bindPointDistanceUniforms(F,M);this._bindLineVerticalPlaneUniforms(F,M);this._bindIntersectsLineUniforms(F,M);L.bindVAO(this._quadVAO);L.drawArrays(H.PrimitiveType.TRIANGLE_STRIP,0,4)};N._renderPath=function(F){if(!I.isNone(this._pathVerticalPlaneData)&&!I.isNone(this._pathTechnique)){var M=F.rctx.bindTechnique(this._pathTechnique,{...this._parameters,origin:this._pathVerticalPlaneData.origin},F.bindParameters);this._bindGlobalUniforms(F,M);this._pathVerticalPlaneData.draw(F.rctx)}};N._bindHeightManifoldUniforms=
function(F,M){if(this.heightManifoldEnabled){var L=this._tempVec3A,O=this._tempPlane;F=F.bindParameters.camera;this._renderCoordsHelper.worldUpAtPosition(this._heightManifoldTarget,L);q(O,this._heightManifoldTarget,L,F.viewMatrix);M.setUniform4fv("heightPlane",O)}};N._bindPointDistanceUniforms=function(F,M){if(this._pointDistanceEnabled){F=F.bindParameters.camera;var L=this._tempSphere;p.copy(L,this._pointDistanceOrigin);p.transformMat4(L,L,F.viewMatrix);L[3]=p.distance(this._pointDistanceOrigin,
this._pointDistanceTarget);M.setUniform4f("pointDistanceSphere",L[0],L[1],L[2],L[3])}};N._bindLineVerticalPlaneUniforms=function(F,M){if(this._lineVerticalPlaneEnabled){var L=this._renderCoordsHelper;F=F.bindParameters.camera;var O=this._tempPlane,Q=this._tempVec3A,Y=this._tempUp,V=this._tempDir,X=this._tempNormal;D.pointAt(this._lineVerticalPlaneSegment,.5,Q);L.worldUpAtPosition(Q,Y);p.normalize(V,this._lineVerticalPlaneSegment.vector);p.cross(X,Y,V);p.normalize(X,X);q(O,this._lineVerticalPlaneSegment.origin,
X,F.viewMatrix);M.setUniform4fv("lineVerticalPlane",O);O=this._tempVec3A;p.copy(O,this._lineVerticalPlaneSegment.origin);L.setAltitude(O,0);p.transformMat4(O,O,F.viewMatrix);M.setUniform3fv("lineVerticalStart",O);O=this._tempVec3B;p.add(O,this._lineVerticalPlaneSegment.origin,this._lineVerticalPlaneSegment.vector);L.setAltitude(O,0);p.transformMat4(O,O,F.viewMatrix);M.setUniform3fv("lineVerticalEnd",O)}};N._bindIntersectsLineUniforms=function(F,M){if(this._intersectsLineEnabled){var L=G,O=E;F=F.bindParameters.camera;
if(this._intersectsLineInfinite){a.fromRay(u.wrap(this._intersectsLineSegment.origin,this._intersectsLineSegment.vector),y);y.c0=-Number.MAX_VALUE;if(!n.intersectClipRay(F.frustum,y))return;a.getStart(y,L);a.getEnd(y,O)}else p.copy(L,this._intersectsLineSegment.origin),p.add(O,this._intersectsLineSegment.origin,this._intersectsLineSegment.vector);var Q=this._tempVec3A;p.transformMat4(Q,L,F.viewMatrix);M.setUniform3fv("intersectsLineStart",Q);L=this._tempVec4;p.copy(L,this._intersectsLineSegment.vector);
this._tempVec4[3]=0;v.transformMat4(this._tempVec4,this._tempVec4,F.viewMatrix);p.transformMat4(O,O,F.viewMatrix);M.setUniform3fv("intersectsLineEnd",O);p.normalize(L,L);M.setUniform3f("intersectsLineDirection",L[0],L[1],L[2]);M.setUniform1f("intersectsLineRadius",this._intersectsLineRadius)}};N._bindGlobalUniforms=function(F,M){const L=F.bindParameters.camera;this._heightManifoldEnabled?M.setUniform1f("maxPixelDistance",2*L.computeScreenPixelSizeAt(this._heightManifoldTarget)):this._pointDistanceEnabled?
M.setUniform1f("maxPixelDistance",2*L.computeScreenPixelSizeAt(this._pointDistanceTarget)):this._lineVerticalPlaneEnabled&&M.setUniform1f("maxPixelDistance",2*L.computeScreenPixelSizeAt(this._lineVerticalPlaneSegment.origin));M.bindTexture("frameColor",F.offscreenRenderingHelper.mainColorTexture)};N._requestRender=function(){this._context&&this._context.requestRender()};f._createClass(J,[{key:"renderSlots",get:function(){return[this._config.contrastControlEnabled?w.RenderSlot.LASERLINES_CONTRAST_CONTROL:
w.RenderSlot.LASERLINES]}},{key:"needsLinearDepth",get:function(){return!0}},{key:"heightManifoldEnabled",get:function(){return this._heightManifoldEnabled},set:function(F){this._heightManifoldEnabled!==F&&(this._heightManifoldEnabled=F,this._requestRender())}},{key:"heightManifoldTarget",get:function(){return this._heightManifoldTarget},set:function(F){p.copy(this._heightManifoldTarget,F);this._requestRender()}},{key:"pointDistanceEnabled",get:function(){return this._pointDistanceEnabled},set:function(F){F!==
this._pointDistanceEnabled&&(this._pointDistanceEnabled=F,this._requestRender())}},{key:"pointDistanceTarget",get:function(){return this._pointDistanceTarget},set:function(F){p.copy(this._pointDistanceTarget,F);this._requestRender()}},{key:"pointDistanceOrigin",get:function(){return this._pointDistanceOrigin},set:function(F){p.copy(this._pointDistanceOrigin,F);this._requestRender()}},{key:"lineVerticalPlaneEnabled",get:function(){return this._lineVerticalPlaneEnabled},set:function(F){F!==this._lineVerticalPlaneEnabled&&
(this._lineVerticalPlaneEnabled=F,this._requestRender())}},{key:"lineVerticalPlaneSegment",get:function(){return this._lineVerticalPlaneSegment},set:function(F){D.copy(F,this._lineVerticalPlaneSegment);this._requestRender()}},{key:"intersectsLineEnabled",get:function(){return this._intersectsLineEnabled},set:function(F){F!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=F,this._requestRender())}},{key:"intersectsLineSegment",get:function(){return this._intersectsLineSegment},set:function(F){D.copy(F,
this._intersectsLineSegment);this._requestRender()}},{key:"intersectsLineRadius",get:function(){return this._intersectsLineRadius},set:function(F){F!==this._intersectsLineRadius&&(this._intersectsLineRadius=F,this._requestRender())}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(F){F!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=F,this._requestRender())}},{key:"pathVerticalPlaneEnabled",get:function(){return this._pathVerticalPlaneEnabled},
set:function(F){F!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=F,I.isSome(this._pathVerticalPlaneData)&&this._requestRender())}},{key:"pathVerticalPlaneVertices",set:function(F){I.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new h.LaserlinePathData(this._renderCoordsHelper));this._pathVerticalPlaneData.vertices=F;this.pathVerticalPlaneEnabled&&this._requestRender()}},{key:"pathVerticalPlaneBuffers",set:function(F){I.isNone(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=
new h.LaserlinePathData(this._renderCoordsHelper));this._pathVerticalPlaneData.buffers=F;this.pathVerticalPlaneEnabled&&this._requestRender()}}]);return J}();const y=a.create(),G=d.create(),E=d.create();e.LaserLineRenderer=k;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/support/LaserlinePathData":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec3 ../../../chunks/vec3f64 ./buffer/glUtil ./buffer/InterleavedLayout ../webgl-engine/lib/VertexAttribute ../webgl-engine/shaders/LaserlinePathTechnique ../../webgl/BufferObject ../../webgl/enums ../../webgl/VertexArrayObject".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r){let u=function(){function w(c){this._renderCoordsHelper=c;this._buffers=null;this._origin=p.create();this._dirty=!1;this._count=0;this._vao=null}var A=w.prototype;A.draw=function(c){const b=this._ensureVAO(c);k.isSome(b)&&(c.bindVAO(b),c.drawArrays(D.PrimitiveType.TRIANGLES,0,this._count))};A.dispose=function(){k.isSome(this._vao)&&this._vao.dispose()};A._ensureVAO=function(c){if(k.isNone(this._buffers))return null;k.isNone(this._vao)&&(this._vao=this._createVAO(c,
this._buffers));this._ensureVertexData(this._vao,this._buffers);return this._vao};A._createVAO=function(c,b){b=this._createDataBuffer(b);this._dirty=!1;return new r.VertexArrayObject(c,a.LaserlinePathTechnique.attributeLocations,{data:d.glLayout(z)},{data:n.BufferObject.createVertex(c,D.Usage.STATIC_DRAW,b)})};A._ensureVertexData=function(c,b){this._dirty&&(b=this._createDataBuffer(b),c.vertexBuffers.data.setData(b),this._dirty=!1)};A._numberOfRenderVertices=function(c){return 6*(c.length/3-1)};A._createDataBuffer=
function(c){var b=c.reduce((C,x)=>C+this._numberOfRenderVertices(x),0);this._count=b;b=z.createBuffer(b);const l=this._origin;let g=0,H=0;for(const C of c){for(c=0;c<C.length;c+=3){var q=I.set(h,C[c+0],C[c+1],C[c+2]);0===c?H=this._renderCoordsHelper.getAltitude(q):this._renderCoordsHelper.setAltitude(q,H);var B=this._renderCoordsHelper.worldUpAtPosition(q,t);const x=g+2*c;q=I.subtract(h,q,l);if(c<C.length-3){b.up.setVec(x,B);b.up.setVec(x+3,B);b.up.setVec(x+5,B);for(let y=0;6>y;y++)b.start.setVec(x+
y,q);b.extrude.setValues(x+0,0,-1);b.extrude.setValues(x+1,1,-1);b.extrude.setValues(x+2,1,1);b.extrude.setValues(x+3,0,-1);b.extrude.setValues(x+4,1,1);b.extrude.setValues(x+5,0,1)}if(0<c)for(b.up.setVec(x-2,B),b.up.setVec(x-4,B),b.up.setVec(x-5,B),B=-6;0>B;B++)b.end.setVec(x+B,q)}g+=this._numberOfRenderVertices(C)}return b.buffer};f._createClass(w,[{key:"vertices",set:function(c){const b=new Float64Array(3*c.length);let l=0;for(const g of c)b[l++]=g[0],b[l++]=g[1],b[l++]=g[2];this.buffers=[b]}},
{key:"buffers",set:function(c){this._buffers=c;if(0<this._buffers.length){c=this._buffers[0];const b=3*Math.floor(c.length/3/2);I.set(this._origin,c[b+0],c[b+1],c[b+2])}else I.set(this._origin,0,0,0);this._dirty=!0}},{key:"origin",get:function(){return this._origin}}]);return w}();const t=p.create(),h=p.create(),z=v.newLayout().vec3f(m.VertexAttribute.START).vec3f(m.VertexAttribute.END).vec3f(m.VertexAttribute.UP).vec2f(m.VertexAttribute.EXTRUDE);e.LaserlinePathData=u;Object.defineProperties(e,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/Program ../lib/VertexAttribute ../../../../chunks/LaserlinePath.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),function(e,f,k,I,p,d,v,m,a,n){p=function(D){function r(){return D.apply(this,arguments)||this}k._inheritsLoose(r,
D);var u=r.prototype;u.initializeProgram=function(t){const h=r.shader.get().build(this.configuration);return new d.Program(t.rctx,h,r.attributeLocations)};u.initializePipeline=function(){return n.makePipelineState({blending:n.simpleBlendingParams(a.BlendFactor.ONE,a.BlendFactor.ONE_MINUS_SRC_ALPHA),colorWrite:n.defaultColorWriteParams})};return r}(p.ShaderTechnique);p.shader=new I.ReloadableShaderModule(m.LaserlinePath,()=>new Promise((D,r)=>e(["./LaserlinePath.glsl"],D,r)));p.attributeLocations=
new Map([[v.VertexAttribute.START,0],[v.VertexAttribute.END,1],[v.VertexAttribute.UP,2],[v.VertexAttribute.EXTRUDE,3]]);f.LaserlinePathTechnique=p;Object.defineProperties(f,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/LaserlinePath.glsl":function(){define("exports ./mat4 ./mat4f64 ./vec2 ./vec2f64 ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderModules/Float2PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r){function u(z){const w=new D.ShaderBuilder;w.include(d.Laserline,z);const {vertex:A,fragment:c}=w;A.uniforms.add([new n.Matrix4PassUniform("modelView",(b,l)=>f.translate(h,l.camera.viewMatrix,b.origin)),new n.Matrix4PassUniform("proj",(b,l)=>l.camera.projectionMatrix),new m.FloatPassUniform("glowWidth",(b,l)=>b.glowWidth*l.camera.pixelRatio),new v.Float2PassUniform("pixelToNDC",(b,l)=>I.set(t,2/l.camera.fullViewport[2],2/l.camera.fullViewport[3]))]);w.attributes.add(r.VertexAttribute.START,
"vec3");w.attributes.add(r.VertexAttribute.END,"vec3");w.attributes.add(r.VertexAttribute.UP,"vec3");w.attributes.add(r.VertexAttribute.EXTRUDE,"vec2");w.varyings.add("uv","vec2");w.varyings.add("vViewStart","vec3");w.varyings.add("vViewEnd","vec3");w.varyings.add("vViewPlane","vec4");A.code.add(a.glsl`void main() {
vec3 pos = mix(start, end, extrude.x);
vec4 viewPos = modelView * vec4(pos, 1);
vec4 projPos = proj * viewPos;
vec2 ndcPos = projPos.xy / projPos.w;
vec3 viewUp = (modelView * vec4(extrude.y * up, 0)).xyz;
vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);
vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
ndcPos += length(lxy) * projExtrudeDir;
vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
vec3 viewPlaneNormal = (modelView * vec4(worldPlaneNormal, 0)).xyz;
vViewStart = (modelView * vec4(start, 1)).xyz;
vViewEnd = (modelView * vec4(end, 1)).xyz;
vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));
float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
ndcPos.x += xPaddingPixels * pixelToNDC.x;
uv = ndcPos * 0.5 + 0.5;
gl_Position = vec4(ndcPos, 0, 1);
}`);c.uniforms.add(new m.FloatPassUniform("perScreenPixelRatio",(b,l)=>l.camera.perScreenPixelRatio));c.code.add(a.glsl`float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
vec3 origin = mix(start, end, 0.5);
vec3 basis = end - origin;
vec3 posAtOrigin = pos - origin;
float x = dot(normalize(basis), posAtOrigin);
float y = dot(plane.xyz, posAtOrigin);
float dx = max(abs(x) - length(basis), 0.0);
float dy = y;
float dist = length(vec2(dx, dy));
float width = fwidth(y);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}
void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);
vec4 color = laserlineProfile(distance);
float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));
gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
}`);return w}const t=p.create(),h=k.create();k=Object.freeze(Object.defineProperty({__proto__:null,build:u},Symbol.toStringTag,{value:"Module"}));e.LaserlinePath=k;e.build=u})},"esri/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl":function(){define("exports ../../../../../core/maybe ./output/ReadLinearDepth.glsl ./util/CameraSpace.glsl ../shaderModules/Float2PassUniform ../shaderModules/Float3PassUniform ../shaderModules/FloatPassUniform ../shaderModules/interfaces ../shaderModules/Texture2DPassUniform ../shaderModules/Texture2DUniform".split(" "),
function(e,f,k,I,p,d,v,m,a,n){e.Laserline=function(D,r){D.extensions.add("GL_OES_standard_derivatives");const u=D.fragment;u.include(k.ReadLinearDepth);D.include(I.CameraSpace);u.uniforms.add([new v.FloatPassUniform("globalAlpha",t=>t.globalAlpha),new d.Float3PassUniform("glowColor",t=>t.glowColor),new v.FloatPassUniform("glowWidth",(t,h)=>t.glowWidth*h.camera.pixelRatio),new v.FloatPassUniform("glowFalloff",t=>t.glowFalloff),new d.Float3PassUniform("innerColor",t=>t.innerColor),new v.FloatPassUniform("innerWidth",
(t,h)=>t.innerWidth*h.camera.pixelRatio),new a.Texture2DPassUniform("depthMap",(t,h)=>h.linearDepthTexture),new p.Float2PassUniform("nearFar",(t,h)=>h.camera.nearFar),new n.Texture2DUniform("frameColor")]);u.code.add(m.glsl`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`);u.code.add(m.glsl`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`);u.code.add(m.glsl`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`);u.code.add(m.glsl`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
float depth = linearDepthFromTexture(depthMap, uv, nearFar);
if (-depth == nearFar[0]) {
return false;
}
pos = reconstructPosition(gl_FragCoord.xy, depth);
normal = normalize(cross(dFdx(pos), dFdy(pos)));
float ddepth = fwidth(depth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);
return true;
}`);r.contrastControlEnabled?(u.uniforms.add(new v.FloatPassUniform("globalAlphaContrastBoost",t=>f.isSome(t.globalAlphaContrastBoost)?t.globalAlphaContrastBoost:1)),u.code.add(m.glsl`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`)):u.code.add(m.glsl`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechniqueConfiguration":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../core/shaderTechnique/ShaderTechniqueConfiguration"],function(e,f,k,I){let p=function(d){function v(){var m=d.apply(this,arguments)||this;m.contrastControlEnabled=!1;return m}f._inheritsLoose(v,d);return v}(I.ShaderTechniqueConfiguration);
k.__decorate([I.parameter()],p.prototype,"contrastControlEnabled",void 0);e.LaserlinePathTechniqueConfiguration=p;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/shaders/LaserlineTechnique":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/DefaultVertexAttributeLocations ../lib/Program ../../../../chunks/Laserlines.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D){I=function(r){function u(){return r.apply(this,arguments)||this}k._inheritsLoose(u,r);return u}(I.NoParameters);d=function(r){function u(){return r.apply(this,arguments)||this}k._inheritsLoose(u,r);var t=u.prototype;t.initializeProgram=function(h){const z=u.shader.get().build(this.configuration);return new m.Program(h.rctx,z,v.Default3D)};t.initializePipeline=function(){return D.makePipelineState({blending:D.simpleBlendingParams(n.BlendFactor.ONE,n.BlendFactor.ONE_MINUS_SRC_ALPHA),
colorWrite:D.defaultColorWriteParams})};return u}(d.ShaderTechnique);d.shader=new p.ReloadableShaderModule(a.LaserlinesShader,()=>new Promise((r,u)=>e(["./Laserlines.glsl"],r,u)));f.LaserlinePassParameters=I;f.LaserlineTechnique=d;Object.defineProperties(f,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/Laserlines.glsl":function(){define("exports ../core/mathUtils ../core/maybe ./vec2 ./vec2f64 ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass ../views/3d/webgl-engine/core/shaderModules/Float2PassUniform ../views/3d/webgl-engine/core/shaderModules/Float3Uniform ../views/3d/webgl-engine/core/shaderModules/Float4Uniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/FloatUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t){function h(c){const b=new t.ShaderBuilder;b.extensions.add("GL_OES_standard_derivatives");b.include(v.ScreenSpacePass);b.include(d.Laserline,c);const l=b.fragment;c.heightManifoldEnabled&&l.uniforms.add(new n.Float4Uniform("heightPlane"));c.pointDistanceEnabled&&l.uniforms.add(new n.Float4Uniform("pointDistanceSphere"));c.lineVerticalPlaneEnabled&&(l.uniforms.add(new n.Float4Uniform("lineVerticalPlane")),l.uniforms.add(new a.Float3Uniform("lineVerticalStart")),
l.uniforms.add(new a.Float3Uniform("lineVerticalEnd")));(c.heightManifoldEnabled||c.pointDistanceEnabled||c.lineVerticalPlaneEnabled)&&l.uniforms.add(new r.FloatUniform("maxPixelDistance"));(c.lineVerticalPlaneEnabled||c.heightManifoldEnabled)&&l.code.add(u.glsl`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`);c.pointDistanceEnabled&&l.code.add(u.glsl`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`);c.intersectsLineEnabled&&(l.uniforms.add(new a.Float3Uniform("intersectsLineStart")),l.uniforms.add(new a.Float3Uniform("intersectsLineEnd")),l.uniforms.add(new a.Float3Uniform("intersectsLineDirection")),l.uniforms.add(new r.FloatUniform("intersectsLineRadius")),l.uniforms.add(new D.FloatPassUniform("perScreenPixelRatio",(g,H)=>H.camera.perScreenPixelRatio)),l.code.add(u.glsl`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`));(c.lineVerticalPlaneEnabled||c.intersectsLineEnabled)&&l.code.add(u.glsl`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`);l.code.add(u.glsl`void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
vec4 color = vec4(0, 0, 0, 0);`);c.heightManifoldEnabled&&(l.uniforms.add(new m.Float2PassUniform("angleCutoff",g=>z(g))),l.code.add(u.glsl`{
float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));
vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));
color = max(color, heightManifoldColor * heightManifoldAlpha);
}`));c.pointDistanceEnabled&&(l.uniforms.add(new m.Float2PassUniform("angleCutoff",g=>z(g))),l.code.add(u.glsl`{
float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
}`));c.lineVerticalPlaneEnabled&&(l.uniforms.add(new m.Float2PassUniform("angleCutoff",g=>z(g))),l.code.add(u.glsl`{
if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}
}`));c.intersectsLineEnabled&&(l.uniforms.add(new m.Float2PassUniform("angleCutoff",g=>z(g))),l.code.add(u.glsl`{
if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}
}`));l.code.add(u.glsl`gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);
}`);return b}function z(c){c=k.isSome(c.angleCutoff)?c.angleCutoff:w;return I.set(A,Math.cos(c),Math.cos(Math.max(0,c-f.deg2rad(2))))}const w=f.deg2rad(6),A=p.create();p=Object.freeze(Object.defineProperty({__proto__:null,defaultAngleCutoff:w,build:h},Symbol.toStringTag,{value:"Module"}));e.LaserlinesShader=p;e.build=h;e.defaultAngleCutoff=w})},"esri/views/3d/webgl-engine/shaders/LaserlineTechniqueConfiguration":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6",
"../core/shaderTechnique/ShaderTechniqueConfiguration","./LaserlinePathTechniqueConfiguration"],function(e,f,k,I,p){p=function(d){function v(){var m=d.apply(this,arguments)||this;m.heightManifoldEnabled=!1;m.pointDistanceEnabled=!1;m.lineVerticalPlaneEnabled=!1;m.intersectsLineEnabled=!1;return m}f._inheritsLoose(v,d);return v}(p.LaserlinePathTechniqueConfiguration);k.__decorate([I.parameter()],p.prototype,"heightManifoldEnabled",void 0);k.__decorate([I.parameter()],p.prototype,"pointDistanceEnabled",
void 0);k.__decorate([I.parameter()],p.prototype,"lineVerticalPlaneEnabled",void 0);k.__decorate([I.parameter()],p.prototype,"intersectsLineEnabled",void 0);e.LaserlineTechniqueConfiguration=p;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/measurementTools/support/PickRequest":function(){define(["exports"],function(e){e.PickRequest=function(f,k=null){this.screenPoint=f;this.result=k};e.PickResult=function(f,k){this.scenePoint=
f;this.mapPoint=k};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/AnalysisToolBase":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./InteractiveToolBase".split(" "),function(e,f,k,I,p,d,v,m,a,n){e.AnalysisToolBase=
function(D){function r(t){return D.call(this,t)||this}f._inheritsLoose(r,D);var u=r.prototype;u.initialize=function(){this.own(I.watch(()=>this.analysisViewData.visible,t=>this.visible=t,I.syncAndInitial))};u.deactivate=function(){this.onDeactivate();this.created||this.analysis.clear()};u.resetCreated=function(){this._set("created",!1)};return r}(n.InteractiveToolBase);k.__decorate([p.property({constructOnly:!0})],e.AnalysisToolBase.prototype,"analysis",void 0);k.__decorate([p.property()],e.AnalysisToolBase.prototype,
"analysisViewData",void 0);e.AnalysisToolBase=k.__decorate([a.subclass("esri.views.interactive.AnalysisToolBase")],e.AnalysisToolBase);Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/InteractiveToolBase":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../DOMContainer ./interfaces ./ManipulatorCollection".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h){const z=p.getLogger("esri.views.interactive.InteractiveToolBase");e.InteractiveToolBase=function(w){function A(b){b=w.call(this,b)||this;b.manipulators=new h.ManipulatorCollection;b.preferManipulatorCursor=!1;b.automaticManipulatorSelection=!0;b.hasFocusedManipulators=!1;b.created=!1;b.removeIncompleteOnCancel=!0;b._editableFlags=new Map([[t.EditableFlag.MANAGER,!0],[t.EditableFlag.USER,!0]]);b._creationFinishedResolver=v.createResolver();return b}f._inheritsLoose(A,
w);var c=A.prototype;c.destroy=function(){this.manipulators.destroy();this._set("view",null)};c.onAdd=function(){this._syncVisible()};c.activate=function(){d.isNone(this.view)?z.error("Can't activate tool if view is not defined."):(u.isDOMContainer(this.view)&&this.view.focus(),this.onActivate())};c.deactivate=function(){this.onDeactivate()};c.handleInputEvent=function(b){this.onInputEvent(b)};c.handleInputEventAfter=function(b){this.onInputEventAfter(b)};c.setEditableFlag=function(b,l){this._editableFlags.set(b,
l);this.manipulators.isToolEditable=this.internallyEditable;this._updateManipulatorAttachment();b===t.EditableFlag.USER&&this.notifyChange("editable");this.onEditableChange()};c.getEditableFlag=function(b){return this._editableFlags.get(b)};c.whenCreated=function(){return this._creationFinishedResolver.promise};c.onActivate=function(){};c.onDeactivate=function(){};c.onShow=function(){};c.onHide=function(){};c.onEditableChange=function(){};c.onInputEvent=function(b){};c.onInputEventAfter=function(b){};
c.finishToolCreation=function(){this.created||this._creationFinishedResolver.resolve(this);this._set("created",!0)};c._syncVisible=function(){this.constructed&&(this.visible?this._show():(this._hide(),this.active&&(this.view.activeTool=null)))};c._show=function(){this._updateManipulatorAttachment();this.onShow()};c._hide=function(){this._updateManipulatorAttachment();this.onHide()};c._updateManipulatorAttachment=function(){this.visible?this.manipulators.attach():this.manipulators.detach()};f._createClass(A,
[{key:"active",get:function(){return null!=this.view&&this.view.activeTool===this}},{key:"visible",set:function(b){this._get("visible")!==b&&(this._set("visible",b),this._syncVisible())}},{key:"editable",get:function(){return this.getEditableFlag(t.EditableFlag.USER)},set:function(b){this.setEditableFlag(t.EditableFlag.USER,b)}},{key:"updating",get:function(){return!1}},{key:"cursor",get:function(){return null}},{key:"internallyEditable",get:function(){return this.getEditableFlag(t.EditableFlag.USER)&&
this.getEditableFlag(t.EditableFlag.MANAGER)}}]);return A}(I);k.__decorate([m.property({constructOnly:!0})],e.InteractiveToolBase.prototype,"view",void 0);k.__decorate([m.property({readOnly:!0})],e.InteractiveToolBase.prototype,"active",null);k.__decorate([m.property({value:!0})],e.InteractiveToolBase.prototype,"visible",null);k.__decorate([m.property({value:!0})],e.InteractiveToolBase.prototype,"editable",null);k.__decorate([m.property({readOnly:!0})],e.InteractiveToolBase.prototype,"manipulators",
void 0);k.__decorate([m.property({readOnly:!0})],e.InteractiveToolBase.prototype,"updating",null);k.__decorate([m.property()],e.InteractiveToolBase.prototype,"cursor",null);k.__decorate([m.property({readOnly:!0})],e.InteractiveToolBase.prototype,"preferManipulatorCursor",void 0);k.__decorate([m.property({readOnly:!0})],e.InteractiveToolBase.prototype,"automaticManipulatorSelection",void 0);k.__decorate([m.property()],e.InteractiveToolBase.prototype,"hasFocusedManipulators",void 0);k.__decorate([m.property({readOnly:!0})],
e.InteractiveToolBase.prototype,"created",void 0);k.__decorate([m.property({readOnly:!0})],e.InteractiveToolBase.prototype,"removeIncompleteOnCancel",void 0);e.InteractiveToolBase=k.__decorate([r.subclass("esri.views.interactive.InteractiveToolBase")],e.InteractiveToolBase);Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/ManipulatorCollection":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/Collection",
"../../core/maybe"],function(e,f,k,I){e.ManipulatorVisibilityPredicate=void 0;(function(d){d[d.WhenToolEditable=0]="WhenToolEditable";d[d.WhenToolNotEditable=1]="WhenToolNotEditable";d[d.Always=2]="Always"})(e.ManipulatorVisibilityPredicate||(e.ManipulatorVisibilityPredicate={}));let p=function(){function d(){this._isToolEditable=!0;this._manipulators=new k;this._nextManipulatorId=0;this._resourceContexts={manipulator3D:{}};this._attached=!1}var v=d.prototype;v.add=function(m,a=e.ManipulatorVisibilityPredicate.WhenToolEditable){return this.addMany([m],
a)[0]};v.addMany=function(m,a=e.ManipulatorVisibilityPredicate.WhenToolEditable){return m.map(n=>{const D=this._nextManipulatorId++;n={id:D,manipulator:n,visibilityPredicate:a,attached:!1};this._manipulators.add(n);this._attached&&this._updateManipulatorAttachment(n);return D})};v.remove=function(m){if("number"===typeof m){for(var a=0;a<this._manipulators.length;a++)if(this._manipulators.getItemAt(a).id===m)return m=this._manipulators.splice(a,1)[0],this._detachManipulator(m),m.id;return null}for(a=
0;a<this._manipulators.length;a++)if(this._manipulators.getItemAt(a).manipulator===m)return m=this._manipulators.splice(a,1)[0],this._detachManipulator(m),m.id;return null};v.removeAll=function(){this._manipulators.forEach(m=>{this._detachManipulator(m)});this._manipulators.removeAll()};v.attach=function(){this._manipulators.forEach(m=>{this._updateManipulatorAttachment(m)});this._attached=!0};v.detach=function(){this._manipulators.forEach(m=>{this._detachManipulator(m)});this._attached=!1};v.destroy=
function(){this._manipulators.forEach(({manipulator:m})=>{m.destroy&&m.destroy()});this._manipulators.destroy();this._resourceContexts=null};v.on=function(m,a){return this._manipulators.on(m,n=>{a(n)})};v.forEach=function(m){for(const a of this._manipulators.items)m(a)};v.some=function(m){return this._manipulators.items.some(m)};v.toArray=function(){const m=[];this.forEach(a=>m.push(a.manipulator));return m};v.intersect=function(m,a){let n=null,D=Number.MAX_VALUE;this._manipulators.forEach(({id:r,
manipulator:u,attached:t})=>{t&&u.interactive&&(t=u.intersectionDistance(m,a),I.isSome(t)&&t<D&&(D=t,n={id:r,manipulator:u}))});return n};v.findById=function(m){if(I.isNone(m))return null;for(const a of this._manipulators.items)if(m===a.id)return a.manipulator;return null};v._updateManipulatorAttachment=function(m){this._isManipulatorItemVisible(m)?this._attachManipulator(m):this._detachManipulator(m)};v._attachManipulator=function(m){m.attached||(m.manipulator.attach&&m.manipulator.attach(this._resourceContexts),
m.attached=!0)};v._detachManipulator=function(m){if(m.attached){var a=m.manipulator;a.grabbing=!1;a.dragging=!1;a.hovering=!1;a.selected=!1;a.detach&&a.detach(this._resourceContexts);m.attached=!1}};v._isManipulatorItemVisible=function(m){return m.visibilityPredicate===e.ManipulatorVisibilityPredicate.Always?!0:this._isToolEditable?m.visibilityPredicate===e.ManipulatorVisibilityPredicate.WhenToolEditable:m.visibilityPredicate===e.ManipulatorVisibilityPredicate.WhenToolNotEditable};f._createClass(d,
[{key:"isToolEditable",set:function(m){this._isToolEditable=m}},{key:"length",get:function(){return this._manipulators.length}}]);return d}();e.ManipulatorCollection=p;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/InteractiveAnalysisViewModel":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Handles ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./InteractiveToolViewModel".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u){function t(z){return p.isSome(z)&&z.state>=h.RUNNING?(z.abort(),null):z}var h;(function(z){z[z.PENDING=0]="PENDING";z[z.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY";z[z.RUNNING=2]="RUNNING"})(h||(h={}));e.InteractiveAnalysisViewModel=function(z){function w(c={}){var b=z.call(this,c)||this;b.analysisView=null;b._reconnectViewTask=null;b._analysisBaseHandles=new I;b._parentChangeFromReconnect=!1;b._startUserOperation=null;c=null==c?void 0:c.analysis;p.isSome(c)?b.analysis=
c:(b._set("analysis",b.constructAnalysis()),b._set("isAnalysisOwner",!0));return b}f._inheritsLoose(w,z);var A=w.prototype;A.normalizeCtorArgs=function(c){const {analysis:b,...l}=c;return l};A.initialize=function(){this._analysisBaseHandles.add([v.watch(()=>p.applySome(this.analysis,({parent:c})=>c),c=>{this._parentChangeFromReconnect||c===this.view||this._set("isAnalysisOwner",!1);c=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1;c&&this._scheduleViewReconnect()},v.sync),v.watch(()=>
({view:this.view,ready:p.isSome(this.view)&&this.view.ready,supported:this.supported}),({view:c},{view:b})=>{c!==b&&(this._startUserOperation=p.abortMaybe(this._startUserOperation),this._disconnectFromView(b));this._scheduleViewReconnect()},v.syncAndInitial),v.watch(()=>this.analysis.isEditable,(c,b)=>{p.isNone(this.analysisView)||(c&&!b&&p.isNone(this.tool)?this.createTool():!c&&b&&p.isSome(this.tool)&&!this.tool.active&&this.removeTool())})])};A.destroy=function(){this._analysisBaseHandles=p.destroyMaybe(this._analysisBaseHandles);
this._reconnectViewTask=p.abortMaybe(this._reconnectViewTask);this._startUserOperation=p.abortMaybe(this._startUserOperation);p.isSome(this.analysisView)&&(this.analysisView.visible=void 0);this._disconnectFromView(this.view);p.isSome(this.analysis)&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))};A.start=function(){var c=f._asyncToGenerator(function*(){var b=this;this.clear();const l={task:null,abort:null,state:h.PENDING},g=d.createTask(function(){var H=f._asyncToGenerator(function*(q){l.state=
h.WAIT_FOR_VIEW_READY;yield v.whenOnce(()=>b.ready,q);l.state=h.RUNNING;b.createTool({interactive:!0})});return function(q){return H.apply(this,arguments)}}());l.task=g;l.abort=()=>g.abort();this._startUserOperation=l;return g.promise});return function(){return c.apply(this,arguments)}}();A.clear=function(){this._startUserOperation=p.abortMaybe(this._startUserOperation);this.removeTool();this.analysis.clear()};A.onConnectToAnalysisView=function(c){};A.onDisconnectFromAnalysisView=function(){};A._scheduleViewReconnect=
function(){var c=this;this._reconnectViewTask=p.abortMaybe(this._reconnectViewTask);const b=d.createTask(function(){var l=f._asyncToGenerator(function*(g){try{yield c._reconnectView(g)}catch(H){d.throwIfAborted(g);if(d.isAbortError(H))throw H;c.logger.warn("Failed to use analysis in view model",H)}finally{b===c._reconnectViewTask&&(c._reconnectViewTask=null)}});return function(g){return l.apply(this,arguments)}}());this._reconnectViewTask=b};A._reconnectView=function(){var c=f._asyncToGenerator(function*(b){const {view:l}=
this,g=p.isSome(l)&&l.ready&&this.supported,H=this.analysis;this._startUserOperation=t(this._startUserOperation);this._disconnectFromView(l);if(g&&!p.isNone(l)&&!p.isNone(H)){if(this.isAnalysisOwner){if(p.isSome(H.parent)){this.logError("expected owned analysis to have null parent when connecting to view");return}this._parentChangeFromReconnect=!0;l.analyses.add(H)}this.analysisView=yield l.whenAnalysisView(H);d.isAborted(b)?this._startUserOperation=t(this._startUserOperation):(this.analysisView.visible=
this.visible,this.onConnectToAnalysisView(this.analysisView),this.createTool())}});return function(b){return c.apply(this,arguments)}}();A._disconnectFromView=function(c){this.removeTool();p.isSome(c)&&this.isAnalysisOwner&&(this._parentChangeFromReconnect=!0,c.analyses.remove(this.analysis),this.analysis.clear());this.analysisView=null;this.onDisconnectFromAnalysisView()};A._setExternalAnalysis=function(c){p.isSome(this.analysisView)&&!this.isAnalysisOwner&&(this.analysisView.visible=!0);this.analysisView=
null;this._set("isAnalysisOwner",!1);this._set("analysis",c);this._parentChangeFromReconnect=!1;c.isEditable||this.logger.warn(`The assigned ${c.type} analysis object will not be editable in the view. ${c.nonEditableMessage}`)};f._createClass(w,[{key:"analysis",set:function(c){c!==this._get("analysis")&&(this._startUserOperation=p.abortMaybe(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(c),this._scheduleViewReconnect())}},{key:"ready",get:function(){return p.isSome(this.analysisView)&&
!this.connectingToView}},{key:"connectingToView",get:function(){return p.isSome(this._reconnectViewTask)}},{key:"isAnalysisOwner",get:function(){return this._get("isAnalysisOwner")}},{key:"visible",set:function(c){this._set("visible",c);p.isSome(this.analysisView)&&(this.analysisView.visible=c)}},{key:"testInfo",get:function(){return{analysisView:this.analysisView}}}]);return w}(u.InteractiveToolViewModel);k.__decorate([m.property({nonNullable:!0})],e.InteractiveAnalysisViewModel.prototype,"analysis",
null);k.__decorate([m.property()],e.InteractiveAnalysisViewModel.prototype,"analysisView",void 0);k.__decorate([m.property()],e.InteractiveAnalysisViewModel.prototype,"ready",null);k.__decorate([m.property()],e.InteractiveAnalysisViewModel.prototype,"connectingToView",null);k.__decorate([m.property({readOnly:!0})],e.InteractiveAnalysisViewModel.prototype,"isAnalysisOwner",null);k.__decorate([m.property({type:Boolean,value:!0})],e.InteractiveAnalysisViewModel.prototype,"visible",null);k.__decorate([m.property()],
e.InteractiveAnalysisViewModel.prototype,"_reconnectViewTask",void 0);e.InteractiveAnalysisViewModel=k.__decorate([r.subclass("esri.widgets.support.InteractiveAnalysisViewModel")],e.InteractiveAnalysisViewModel);Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/InteractiveToolViewModel":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Handles ../../core/Logger ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u){e.InteractiveToolViewModel=function(t){function h(w){var A=t.call(this,w)||this;A.tool=null;A._baseHandles=new p;A._loggedUnsupportedErrorOnce=!1;A.logger=d.getLogger(A.declaredClass);w&&null!=w.visible&&(A.visible=w.visible);return A}f._inheritsLoose(h,t);var z=h.prototype;z.initialize=function(){this._baseHandles.add(m.watch(()=>({ready:v.isSome(this.view)&&this.view.ready,supported:this.supported}),({ready:w,supported:A})=>{!w||A||this._loggedUnsupportedErrorOnce||
(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)},m.syncAndInitial))};z.destroy=function(){this.removeTool();this.view=null;this._baseHandles=v.destroyMaybe(this._baseHandles)};z.createTool=function(w={interactive:!1}){this.removeTool();if(!v.isNone(this.view)&&this.view.ready&&this.supported){var A=this.constructTool();A.created?(this._set("tool",A),this.view.tools.add(A)):w.interactive?(this._set("tool",A),this.view.addAndActivateTool(A),m.when(()=>A.created,()=>
{A.active&&v.isSome(this.view)&&(this.view.activeTool=null)},{initial:!0,once:!0})):A.destroy()}};z.removeTool=function(){const w=this.tool;if(!v.isNone(w)){var A=v.applySome(this.view,c=>c.tools);v.isSome(A)?A.remove(w):w.destroy();this._set("tool",null)}};z.logError=function(...w){this.logger.error(...w)};f._createClass(h,[{key:"supported",get:function(){return v.isNone(this.view)||this.view.type===this.supportedViewType}},{key:"view",get:function(){return this._get("view")},set:function(w){w!==
this.view&&(this.removeTool(),this._set("view",w),this._baseHandles.remove("tools"),v.isNone(w)||this._baseHandles.add(w.tools.on("after-remove",A=>{A.item===this.tool&&this._set("tool",null)}),"tools"))}},{key:"visible",set:function(w){this._set("visible",w);v.isSome(this.tool)&&(this.tool.visible=w)}},{key:"active",get:function(){return v.isSome(this.tool)&&this.tool.active}},{key:"disabled",get:function(){return v.isNone(this.view)||!this.view.ready||!this.supported}}]);return h}(I);k.__decorate([a.property({constructOnly:!0})],
e.InteractiveToolViewModel.prototype,"tool",void 0);k.__decorate([a.property()],e.InteractiveToolViewModel.prototype,"supported",null);k.__decorate([a.property({value:null})],e.InteractiveToolViewModel.prototype,"view",null);k.__decorate([a.property({type:Boolean,value:!0})],e.InteractiveToolViewModel.prototype,"visible",null);k.__decorate([a.property()],e.InteractiveToolViewModel.prototype,"active",null);k.__decorate([a.property()],e.InteractiveToolViewModel.prototype,"disabled",null);e.InteractiveToolViewModel=
k.__decorate([u.subclass("esri.widgets.support.InteractiveToolViewModel")],e.InteractiveToolViewModel);Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/AreaMeasurement3D":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/promiseUtils ../core/unitUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./AreaMeasurement3D/AreaMeasurement3DViewModel ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/jsxFactory ./support/widgetUtils".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z){d=function(w){function A(b,l){b=w.call(this,b,l)||this;b.view=null;b.visible=null;b.iconClass="esri-icon-measure-area";b.label=void 0;b.messages=null;b.messagesUnits=null;b.viewModel=new r;b.unitOptions=null;b.unit=null;return b}e._inheritsLoose(A,w);var c=A.prototype;c.render=function(){const {supported:b,active:l,measurement:g,state:H,unit:q}=this.viewModel;var B="disabled"===H;const C="measuring"===H||"measured"===H,{messages:x,messagesUnits:y}=this;var G=
l&&"ready"===H?h.tsx("section",{key:"esri-area-measurement-3d__hint",class:"esri-area-measurement-3d__hint"},h.tsx("p",{class:"esri-area-measurement-3d__hint-text"},x.hint)):null;const E=b?null:h.tsx("section",{key:"esri-area-measurement-3d__unsupported",class:"esri-area-measurement-3d__panel--error"},h.tsx("p",null,x.unsupported));var J=(M,L,O)=>{switch(L.state){case "available":return h.tsx("div",{key:`${O}-enabled`,class:"esri-area-measurement-3d__measurement-item"},h.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},
M),h.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},L.text));case "unavailable":return h.tsx("div",{key:`${O}-disabled`,class:this.classes("esri-area-measurement-3d__measurement-item","esri-area-measurement-3d__measurement-item--disabled")},h.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},M));case "invalid":return h.tsx("div",{key:`${O}-enabled`,class:"esri-area-measurement-3d__measurement-item"},h.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},
M),h.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},x.notApplicable))}};J=C?h.tsx("section",{key:"esri-area-measurement-3d__measurement",class:"esri-area-measurement-3d__measurement"},J(x.area,g.area,"area"),J(x.perimeterLength,g.perimeterLength,"perimeter-length")):null;var N=`${this.id}__units`,F=h.tsx("label",{class:"esri-area-measurement-3d__units-label",for:N},x.unit);N=h.tsx("div",{class:"esri-area-measurement-3d__units-select-wrapper"},h.tsx("select",{class:"esri-area-measurement-3d__units-select esri-select",
id:N,onchange:this._changeUnit,bind:this,value:q},this.viewModel.unitOptions.map(M=>{var L;return h.tsx("option",{key:M,value:M},I.isMeasurementSystem(M)?y.systems[M]:null==(L=y.units[M])?void 0:L.pluralCapitalized)})));F=C?h.tsx("section",{key:"esri-area-measurement-3d__units",class:"esri-area-measurement-3d__units"},F,N):null;F=C?h.tsx("div",{key:"settings",class:"esri-area-measurement-3d__settings"},F):null;B=!b||l&&!C?null:h.tsx("div",{class:"esri-area-measurement-3d__actions"},h.tsx("button",
{disabled:B,class:this.classes("esri-area-measurement-3d__clear-button esri-button esri-button--primary",B&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement,type:"button"},x.newMeasurement));G=this.visible?h.tsx("div",{class:"esri-area-measurement-3d__container"},E,G,F,J,B):null;return h.tsx("div",{key:this,class:"esri-area-measurement-3d esri-widget esri-widget--panel",role:"presentation"},G)};c._newMeasurement=function(){k.ignoreAbortErrors(this.viewModel.start())};c._changeUnit=
function(b){b=b.target;if(b=b.options[b.selectedIndex])this.unit=b.value};e._createClass(A,[{key:"analysis",get:function(){return this.viewModel.analysis},set:function(b){this.viewModel.analysis=b}}]);return A}(D);f.__decorate([p.aliasOf("viewModel.view")],d.prototype,"view",void 0);f.__decorate([p.aliasOf("viewModel.visible")],d.prototype,"visible",void 0);f.__decorate([p.aliasOf("viewModel.active")],d.prototype,"active",void 0);f.__decorate([a.property({constructOnly:!0,nonNullable:!0})],d.prototype,
"analysis",null);f.__decorate([a.property()],d.prototype,"iconClass",void 0);f.__decorate([a.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],d.prototype,"label",void 0);f.__decorate([a.property(),t.messageBundle("esri/widgets/AreaMeasurement3D/t9n/AreaMeasurement3D")],d.prototype,"messages",void 0);f.__decorate([a.property(),t.messageBundle("esri/core/t9n/Units")],d.prototype,"messagesUnits",void 0);f.__decorate([a.property()],d.prototype,"uiStrings",void 0);f.__decorate([a.property({type:r})],
d.prototype,"viewModel",void 0);f.__decorate([p.aliasOf("viewModel.unitOptions")],d.prototype,"unitOptions",void 0);f.__decorate([p.aliasOf("viewModel.unit")],d.prototype,"unit",void 0);f.__decorate([u.accessibleHandler()],d.prototype,"_newMeasurement",null);f.__decorate([u.accessibleHandler()],d.prototype,"_changeUnit",null);return d=f.__decorate([n.subclass("esri.widgets.AreaMeasurement3D")],d)})},"esri/widgets/AreaMeasurement3D/AreaMeasurement3DViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../analysis/AreaMeasurementAnalysis ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../properties/defaultUnit ../../views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool ../support/InteractiveAnalysisViewModel".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u){v=function(t){function h(w){w=t.call(this,w)||this;w.analysis=null;w.supportedViewType="3d";w.unsupportedErrorMessage="AreaMeasurement3DViewModel is only supported in 3D views.";w._userUnitOptions=null;w._userUnit=null;return w}e._inheritsLoose(h,t);var z=h.prototype;z.initialize=function(){this.analysis.unit=this.unit};z.constructAnalysis=function(){return new k};z.constructTool=function(){return new r({view:I.unwrap(this.view),analysis:this.analysis,analysisViewData:I.unwrap(this.analysisView),
visible:this.visible})};z._findSelectableUnit=function(w,A){const {unitOptions:c}=this;return c.includes(w)?w:I.isSome(A)?this._findSelectableUnit(A):c[0]};z._filteredOrAllUnits=function(w){if(I.isNone(w))return p.measurementAreaUnits.slice();w=w.filter(A=>p.measurementAreaUnits.includes(A));return 0===w.length?p.measurementAreaUnits.slice():w};e._createClass(h,[{key:"state",get:function(){return this.disabled||!this.ready?"disabled":I.isNone(this.tool)?"ready":this.tool.state}},{key:"measurement",
get:function(){if(I.isNone(this.tool)||this.disabled||this.tool.destroyed)return null;var {analysisView:w}=this;if(I.isNone(w))return null;const A=w.analysisVisualization;var c=A.viewData,b=c.measurementData;w=w.validMeasurement;c="euclidean"===c.mode;const l=(b=0===(c?b.intersectingSegments:b.geodesicIntersectingSegments).size)?w?"available":"unavailable":"invalid";return{mode:c?"euclidean":"geodesic",area:{text:b&&w?A.areaLabel:null,state:l},perimeterLength:{text:b&&w?A.perimeterLengthLabel:null,
state:l}}}},{key:"unitOptions",get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(w){this._userUnitOptions=w;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}},{key:"unit",get:function(){return I.isSome(this._userUnit)?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},set:function(w){this._userUnit=w?this._findSelectableUnit(w,this._userUnit):null;this.analysis.unit=this._userUnit}}]);
return h}(u.InteractiveAnalysisViewModel);f.__decorate([d.property({type:k})],v.prototype,"analysis",void 0);f.__decorate([d.property({readOnly:!0})],v.prototype,"state",null);f.__decorate([d.property({readOnly:!0})],v.prototype,"measurement",null);f.__decorate([d.property()],v.prototype,"unitOptions",null);f.__decorate([d.property()],v.prototype,"unit",null);f.__decorate([d.property(D.defaultUnitPropertyMetadata)],v.prototype,"defaultUnit",void 0);f.__decorate([d.property()],v.prototype,"_userUnit",
void 0);return v=f.__decorate([n.subclass("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],v)})},"esri/analysis/AreaMeasurementAnalysis":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Analysis ../core/arrayUtils ../core/Logger ../core/maybe ../core/unitUtils ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Polygon".split(" "),function(e,f,k,I,p,d,v,m,a,n,D,r){const u=
p.getLogger("esri.analysis.AreaMeasurementAnalysis");k=function(t){function h(z){z=t.call(this,z)||this;z.type="area-measurement";z.extent=null;z.unit=null;z.nonEditableMessage="Assign a closed polygon geometry containing more than two points to the analysis to allow editing.";return z}e._inheritsLoose(h,t);h.prototype.clear=function(){this.geometry=null};e._createClass(h,[{key:"geometry",set:function(z){d.isNone(z)?(this._set("geometry",null),this._set("extent",null)):(1<z.rings.length&&u.warn("Measuring polygons with multiple rings is not supported."),
this._set("geometry",z.clone()),this._set("extent",z.extent))}},{key:"requiredPropertiesForEditing",get:function(){if(d.isSome(this.geometry)&&1===this.geometry.rings.length){const z=this.geometry.rings[0];if(2>=z.length||!I.equals(z[0],z[z.length-1]))return[null]}return[this.geometry]}}]);return h}(k);f.__decorate([m.property({type:["area-measurement"]})],k.prototype,"type",void 0);f.__decorate([m.property({value:null,type:r})],k.prototype,"geometry",null);f.__decorate([m.property({readOnly:!0})],
k.prototype,"extent",void 0);f.__decorate([m.property({type:v.measurementAreaUnits,value:null})],k.prototype,"unit",void 0);f.__decorate([m.property({readOnly:!0})],k.prototype,"requiredPropertiesForEditing",null);f.__decorate([m.property({readOnly:!0})],k.prototype,"nonEditableMessage",void 0);return k=f.__decorate([D.subclass("esri.analysis.AreaMeasurementAnalysis")],k)})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/hydratedFeatures ../../../analysis/support/measurementUtils ../../editingTools/dragEventPipeline3D ./AreaMeasurement3DView ../support/PickRequest ../../../../interactive/AnalysisToolBase ../../../../interactive/dragEventPipeline ../../../../support/screenUtils".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h,z,w,A){v=function(c){function b(g){g=c.call(this,g)||this;g._handles=new k;g.polygonState="initial";g.analysisViewData=null;return g}e._inheritsLoose(b,c);var l=b.prototype;l.initialize=function(){const {view:g,analysisViewData:H,manipulators:q,visible:B}=this;this.measurementView=new t.default({view:g,analysisViewData:H,toolState:this,manipulators:q,visible:B});this._setupManipulators();this._handles.add(p.watch(()=>this.state,C=>{"measured"===C&&this.finishToolCreation()},
p.syncAndInitial))};l.destroy=function(){this.measurementView.destroy();this._set("measurementView",null);this._handles=I.destroyMaybe(this._handles)};l.finishMeasurement=function(){const {path:g}=this.analysisViewData;3>g.numVertices?(g.clear(),this.polygonState="initial"):(g.close(),this.polygonState="measured");this.analysisViewData.cursorPoint=null};l.onShow=function(){this.measurementView.show()};l.onHide=function(){this.measurementView.hide()};l.onInputEvent=function(g){switch(g.type){case "immediate-double-click":this._handleImmediateDoubleClick(g);
break;case "immediate-click":this._handleImmediateClick(g);break;case "pointer-move":this._handlePointerMove(g);break;case "drag":this._handleDrag(g);break;case "key-down":this._handleKeyDown(g)}};l._setupManipulators=function(){const g=B=>B.events.on("grab-changed",()=>{this.analysisViewData.validMeasurement&&(this.polygonState=this.manipulators.some(C=>C.manipulator.grabbing)?"editing":"measured")}),H=(B,C)=>{this._handles.add([w.createManipulatorDragEventPipeline(C,(x,y,G)=>{const E=u.hideManipulatorWhileDragging(x),
J=I.unwrap(x.metadata);y.next(E).next(u.screenToMap3D(this.view)).next(F=>{x.location=F.mapEnd;this.analysisViewData.path.setVertexPosition(J,D.clonePoint(F.mapEnd))});const N=D.clonePoint(this.analysisViewData.path.getVertexPositionAsPoint(J));G.next(E).next(()=>{this.analysisViewData.path.setVertexPosition(J,N);x.location=N})}),g(C)],`manipulator-${B}`)},q=B=>{this._handles.remove(`manipulator-${B}`)};this.manipulators.forEach(({id:B,manipulator:C})=>{H(B,C)});this._handles.add([this.manipulators.on("after-add",
({item:{id:B,manipulator:C}})=>{H(B,C)}),this.manipulators.on("after-remove",({item:{id:B}})=>{q(B)})])};l._handleImmediateDoubleClick=function(g){r.isPrimaryPointerAction(g)&&("drawing"===this.polygonState&&this.finishMeasurement(),g.stopPropagation())};l._handleDrag=function(g){"editing"===this.polygonState&&g.stopPropagation()};l._handleImmediateClick=function(g){if(r.isPrimaryPointerAction(g)){var H=A.createScreenPointFromEvent(g);if(this.active)switch(this.polygonState){case "initial":if(this._addVertexAt(H)){this.analysisViewData.cursorPoint=
null;this.polygonState="drawing";g.stopPropagation();return}break;case "drawing":{const q=this.measurementView.vertexHandleAt(H,g.pointerType);if(I.isNone(q)){if(this._addVertexAt(H)){this.analysisViewData.cursorPoint=null;g.stopPropagation();return}}else 0===q.index&&(this.finishMeasurement(),g.stopPropagation())}}"mouse"===g.pointerType&&this._hoverAt(H)}};l._handlePointerMove=function(g){"mouse"===g.pointerType&&(g=A.createScreenPointFromEvent(g),this._hoverAt(g))};l._handleKeyDown=function(g){"Enter"===
g.key&&"drawing"===this.polygonState&&(this.finishMeasurement(),g.stopPropagation())};l._hoverAt=function(g){!this.active||"initial"!==this.polygonState&&"drawing"!==this.polygonState?this.analysisViewData.cursorPoint=null:(g=this._pick(g),I.isSome(g)&&(this.analysisViewData.cursorPoint=g.mapPoint))};l._addVertexAt=function(g){g=this._pick(g);return I.isSome(g)&&I.isSome(g.mapPoint)?(this.analysisViewData.path.add(g.mapPoint),!0):!1};l._pick=function(g){g=new h.PickRequest(g);return this.measurementView.pick(g)};
e._createClass(b,[{key:"state",get:function(){return 0===this.analysisViewData.path.numVertices?"ready":this.analysisViewData.validMeasurement&&"editing"!==this.polygonState?"measured":"measuring"}},{key:"cursor",get:function(){return"ready"===this.state||"drawing"===this.polygonState?"crosshair":null}}]);return b}(z.AnalysisToolBase);f.__decorate([d.property({readOnly:!0})],v.prototype,"state",null);f.__decorate([d.property()],v.prototype,"polygonState",void 0);f.__decorate([d.property({readOnly:!0})],
v.prototype,"cursor",null);f.__decorate([d.property()],v.prototype,"measurementView",void 0);f.__decorate([d.property({constructOnly:!0})],v.prototype,"view",void 0);f.__decorate([d.property()],v.prototype,"analysis",void 0);f.__decorate([d.property({constructOnly:!0})],v.prototype,"analysisViewData",void 0);return v=f.__decorate([n.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],v)})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DView":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Handles ../../../../../core/lang ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/screenUtils ../../../../../chunks/vec3f64 ../../manipulatorUtils ../support/PickRequest ../../visualElements/LaserlineVisualElement ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/IntersectorInterfaces ../../../../interactive/ManipulatorCollection".split(" "),
function(e,f,k,I,p,d,v,m,a,n,D,r,u,t,h){function z(b,l){return{...b,...I.clone(l)}}function w(b,l,g,H){for(;b.length<l;)b.push(g());if(H)for(;b.length>l;)g=b.pop(),H(g);else b.length=l}const A={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,
1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25};let c=function(){function b(g){this.vertexManipulators=[];this._analysisViewData=null;this._destroyed=!1;this._visible=this._isManipulatorsOwner=!0;this._listenerHandles=this._cursorManipulator=this._laserLine=null;
this._tempHandlePosition=m.create();const {analysisViewData:H,manipulators:q,toolState:B,view:C,visible:x}=g;this._analysisViewData=H;this._toolState=B;null!=q?(this._manipulators=q,this._isManipulatorsOwner=!1):this._manipulators=new h.ManipulatorCollection;this._view=C;g=this._style=z(A,g.style);this._intersector=u.newIntersector(C.state.viewingMode);this._intersector.options.store=t.StoreResults.MIN;const y=a.createSphereManipulator(C,g.handleColor,g.handleOpacity);y.available=!1;y.radius=g.handleRadius;
y.interactive=!1;this._manipulators.add(y);this._cursorManipulator=y;this._laserLine=new D.LaserlineVisualElement({view:C,attached:!0,style:{glowColor:g.laserLineGlowColor,glowWidth:g.laserLineGlowWidth,glowFalloff:g.laserLineGlowFalloff,innerColor:g.laserLineInnerColor,innerWidth:g.laserLineInnerWidth,globalAlpha:g.laserLineGlobalAlpha}});this._updateVisibility(x||!0)}var l=b.prototype;l.destroy=function(){this._listenerHandles=p.destroyMaybe(this._listenerHandles);this._manipulators=this._isManipulatorsOwner?
p.destroyMaybe(this._manipulators):null;this._laserLine=p.destroyMaybe(this._laserLine);this._destroyed=!0};l.show=function(){this._setVisibility(!0)};l.hide=function(){this._setVisibility(!1)};l._setVisibility=function(g){this._destroyed||this._visible===g||this._updateVisibility(g)};l._updateVisibility=function(g){this._visible=g;(this._laserLine.visible=g)?(this._initializeListeners(),this._updateAll()):(this._destroyListeners(),this.vertexManipulators.forEach(H=>{this._removeVertexManipulator(H.manipulator)}),
this.vertexManipulators=[],this._view.cursor=null)};l.vertexHandleAt=function(g,H){g=this._manipulators.intersect(g,H);return p.isSome(g)?g.manipulator.metadata:null};l.pick=function(g){var H=this._view.spatialReference;g=v.screenPointObjectToArray(g.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(g,this._intersector);const q=this._intersector.results.min;g=m.create();if(!q.getIntersectionPoint(g))return null;H=this._view.renderCoordsHelper.fromRenderCoords(g,H);return p.isNone(H)?
null:new n.PickResult(g,H)};l._updateAll=function(){this._visible&&(this._updateVertexManipulators(),this._updateLaserLine())};l._createVertexManipulator=function(){const g=a.createSphereManipulator(this._view,this._style.handleColor,this._style.handleOpacity);g.radius=this._style.handleRadius;return{id:this._manipulators.add(g),manipulator:g}};l._removeVertexManipulator=function(g){this._manipulators.remove(g)};l._updateVertexManipulators=function(){const {viewData:g}=this._analysisViewData,H=this._analysisViewData.path?
this._analysisViewData.path.vertices:[],q=this.vertexManipulators;w(q,H.length,()=>this._createVertexManipulator(),B=>this._removeVertexManipulator(B.manipulator));q.forEach((B,C)=>{B.manipulator.metadata=H[C];B.manipulator.renderLocation=g.positionsRenderCoords[C]});"drawing"===this._toolState.polygonState&&p.isSome(this._analysisViewData.cursorPoint)?(this._cursorManipulator.available=!0,this._cursorManipulator.location=this._analysisViewData.cursorPoint):this._cursorManipulator.available=!1};l._getFocusPoint=
function(){const {lastDraggedVertex:g}=this._analysisViewData;switch(this._toolState.polygonState){case "drawing":return p.isSome(this._analysisViewData.cursorPoint)?this._analysisViewData.cursorPoint:p.isSome(g)?this._analysisViewData.path.getVertexPositionAsPoint(g):p.unwrap(this._analysisViewData.path.lastPoint);case "editing":return p.isSome(g)?this._analysisViewData.path.getVertexPositionAsPoint(g):null;default:return this._analysisViewData.cursorPoint}};l._updateLaserLine=function(){var g=this._style.laserLineEnabled&&
"measured"!==this._toolState.polygonState&&this._toolState.active;const H=this._getFocusPoint();g&&p.isSome(H)?(g=this._tempHandlePosition,this._view.renderCoordsHelper.toRenderCoords(H,g),this._laserLine.heightManifoldTarget=g):this._laserLine.heightManifoldTarget=null};l._initializeListeners=function(){this._listenerHandles=new k;this._listenerHandles.add([d.watch(()=>this._toolState.polygonState,()=>this._updateLaserLine()),d.watch(()=>this._analysisViewData.viewData,()=>this._updateAll(),d.sync),
d.watch(()=>({lastDraggedVertex:this._analysisViewData.lastDraggedVertex,cursorPoint:this._analysisViewData.cursorPoint}),()=>this._updateLaserLine()),d.watch(()=>this._toolState.active,()=>this._updateAll())])};l._destroyListeners=function(){this._listenerHandles=p.destroyMaybe(this._listenerHandles)};f._createClass(b,[{key:"destroyed",get:function(){return this._destroyed}},{key:"visible",get:function(){return this._visible},set:function(g){g?this.show():this.hide()}},{key:"testData",get:function(){const g=
this._laserLine.testData;return{laserLineRenderer:p.isSome(g)?{heightManifoldEnabled:g.heightManifoldEnabled,heightManifoldTarget:g.heightManifoldTarget,pointDistanceEnabled:g.pointDistanceEnabled,pointDistanceOrigin:g.pointDistanceOrigin,pointDistanceTarget:g.pointDistanceTarget,lineVerticalPlaneEnabled:g.lineVerticalPlaneEnabled}:{heightManifoldEnabled:!1,heightManifoldTarget:null,pointDistanceEnabled:!1,pointDistanceOrigin:null,pointDistanceTarget:null,lineVerticalPlaneEnabled:!1}}}}]);return b}();
c._handleGeometry=r.createSphereGeometry(1,32,32);e.copyParameter=z;e.default=c;e.resizeArray=w;Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"widgets/Measurement3D/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Measurement3D/Widget.html":'\x3cdiv\x3e\r\n\t\x3cheader class\x3d"${baseClass}__header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/header\x3e\r\n\t\x3cdiv class\x3d"hidden" data-dojo-attach-point\x3d"measurementNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"${baseClass}__hint" data-dojo-attach-point\x3d"hintNode"\x3e${nls.hint}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Measurement3D/css/style.css":".esri-area-measurement-3d__container,.esri-direct-line-measurement-3d__container {padding: 0;}.esri-direct-line-measurement-3d {pointer-events: auto;}.jimu-widget-measurement .hidden {display: none !important;}.jimu-widget-measurement .esri-button {height: 32px; cursor: pointer; font-family: inherit; font-size: 14px;}.jimu-widget-measurement .measurement-button-wrapper {padding: 12px 15px;}.jimu-button-group {display: flex; flex-direction: row;}.jimu-button-group \x3e button {font-family: inherit; background: #fff; border: 1px solid #ccc; padding: 5px 10px; line-height: 20px; font-size: 1em; flex-basis: 0; flex-grow: 1; transition: background-color 125ms ease-in-out; position: relative; z-index: 1;}.jimu-button-group \x3e button:hover {background: #f0f0f0;}.jimu-button-group \x3e button.jimu-state-active {background: #24b5cc; border-color: #24b5cc; color: #fff; z-index: 2;}.jimu-button-group \x3e button.jimu-state-active:before {content: none;}.jimu-button-group \x3e button:not(:disabled) {cursor: pointer;}.jimu-button-group \x3e button + button {margin-left: -1px; border-left-width: 0;}.jimu-button-group \x3e button + button::before {content: ''; display: block; position: absolute; left: -1px; top: 4px; bottom: 4px; border-left: 1px solid #ccc;}.jimu-rtl .jimu-button-group \x3e button + button {margin-left: auto; margin-right: -1px; border-left-width: 1px; border-right-width: 0;}.jimu-rtl .jimu-button-group \x3e button + button::before {right: -1px; left: auto;}.jimu-button-group \x3e button img {vertical-align: middle; margin-right: 8px; pointer-events: none;}.jimu-rtl .jimu-button-group \x3e button img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__header {font-size: 14px; text-align: center; border-bottom: 1px solid #e7e7e7; margin-bottom: 12px;}.jimu-widget-measurement__header img {vertical-align: middle; margin-right: 8px;}.jimu-rtl .jimu-widget-measurement__header img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__hint {color: #323232; font-size: 14px;}.jimu-widget-frame.jimu-container .jimu-widget-measurement__header {margin: -14px -14px 14px; padding: 14px 14px 14px;}",
"*now":function(e){e(['dojo/i18n!*preload*widgets/Measurement3D/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/on jimu/BaseWidget ./ButtonGroup jimu/dijit/ViewStack esri/widgets/DirectLineMeasurement3D esri/widgets/AreaMeasurement3D esri/core/watchUtils".split(" "),function(e,f,k,I,p,d,v,m){return e([I],{baseClass:"jimu-widget-measurement",name:"Measurement",MEASURE_TYPES:{DISTANCE:"distance",AREA:"area",LOCATION:"location"},measureWidgets:{},selectedMeasureType:null,buttonGroup:null,CSS:{clearButton:"esri-direct-line-measurement-3d__clear-button"},postCreate:function(){this.inherited(arguments);
this.measureWidgets={};this.selectedMeasureType=null},startup:function(){this.inherited(arguments);this.initUI()},destroy:function(){if(this.measureWidgets)for(var a in this.measureWidgets)if(this.measureWidgets.hasOwnProperty(a)){var n=this.measureWidgets[a];n.destroy&&n.destroy()}this.buttonGroup&&this.buttonGroup.destroy&&(this.buttonGroup.destroy(),this.buttonGroup=null);this.selectedMeasureType=null;this.inherited(arguments)},onOpen:function(){var a=this.getWidget(this.selectedMeasureType);a&&
(a.visible=!0)},onClose:function(){var a=this.getWidget(this.selectedMeasureType);a&&(a.visible=!1)},onActive:function(){var a=this.getWidget(this.selectedMeasureType);(a=a&&a.get("viewModel.tool"))&&a.activate()},onDeActive:function(){var a=this.getWidget(this.selectedMeasureType),n=a&&a.get("viewModel.tool");"measuring"===(a&&a.get("viewModel.state"))?a.viewModel.clear():n&&n.deactivate()},_applyConfig:function(a){if(this.config&&a){var n=this.config;switch(a.measureType){case this.MEASURE_TYPES.DISTANCE:var D=
"lengthUnit";var r="defaultLengthUnit";break;case this.MEASURE_TYPES.AREA:D="areaUnit",r="defaultAreaUnit"}n.measurement&&n.measurement[D]?a.unit=n.measurement[D]:n[r]&&(a.unit=n[r])}},_createWidget:function(a){a=this._ensureWidget(a);this._applyConfig(a);return a},_ensureWidget:function(a){var n=this.getWidget(a);n||(n=document.createElement("div"),a===this.MEASURE_TYPES.DISTANCE?this.measureWidgets[a]=new v({container:n,view:this.sceneView,measureType:a,visible:!1}):a===this.MEASURE_TYPES.AREA&&
(this.measureWidgets[a]=new m({container:n,view:this.sceneView,measureType:a})),n=this.measureWidgets[a]);return n},_initWidget:function(a){var n=this.getWidget(a);n||(n=this._createWidget(a),this._addtoViewStack(n));n.visible=!0;this.viewStack.switchView(a)},_addtoViewStack:function(a){if(a){var n=document.createElement("div");n.label=a.measureType;n.appendChild(a.domNode);this.viewStack.addView(n)}},_initMeasurements:function(a){if(a){var n=[];a instanceof Array&&a.forEach(f.hitch(this,function(D){var r=
document.createElement("img");r.title=D.value;r.src=this._getMeasurementIconSource(D.value);n.push({value:D.value,label:D.label,icon:r,content:D.label})}));a=this.buttonGroup=new p({buttons:n,selected:null});a.placeAt(this.headerNode);this.own(k(a,"Change",f.hitch(this,function(D){this._toggleWidgetSection(!!D);this._handleMeasureChanged()})))}},_handleMeasureChanged:function(){var a=this.buttonGroup.getActiveButtonValue(),n=this.getWidget(this.selectedMeasureType);n&&(n.visible=!1);null!==a&&this._initWidget(a);
this.selectedMeasureType=a},_toggleWidgetSection:function(a){a?(this.measurementNode.classList.remove("hidden"),this.hintNode.classList.add("hidden")):(this.measurementNode.classList.add("hidden"),this.hintNode.classList.remove("hidden"))},_getMeasurementIconSource:function(a){switch(a){case this.MEASURE_TYPES.DISTANCE:var n=this.folderUrl+"images/Measure_Distance16.png";break;case this.MEASURE_TYPES.AREA:n=this.folderUrl+"images/Measure_Area16.png"}return n},initUI:function(){var a=this.config,n=
[];this.viewStack=new d(null,this.measurementNode);a&&(a.showArea&&n.push({label:this.nls.area,value:this.MEASURE_TYPES.AREA}),a.showDistance&&n.push({label:this.nls.distance,value:this.MEASURE_TYPES.DISTANCE}));0!==n.length&&this._initMeasurements(n)},getWidget:function(a){return a&&this.measureWidgets[a]}})});